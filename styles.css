/* stylelint-disable no-descending-specificity */

/* ==========================================================================
   DESIGN SYSTEM - Monochrome
   A comprehensive design language for consistent UI/UX
   ========================================================================== */

:root {
    color-scheme: light dark;

    /* Dynamic palette transition (set by JS) */
    --palette-transition: 0s;

    /* -------------------------------------------------------------------------
       TYPOGRAPHY SCALE
       Use these variables for ALL font sizes
       ------------------------------------------------------------------------- */
    --font-family: 'Inter', -apple-system, blinkmacsystemfont, 'Segoe UI', roboto, sans-serif;
    --font-size-scale: 100%;

    /* Typography Scale - Base 16px (1rem) */
    --text-xs: 0.75rem;

    /* 12px - Captions, badges, timestamps */
    --text-sm: 0.875rem;

    /* 14px - Secondary text, labels */
    --text-base: 1rem;

    /* 16px - Body text (default) */
    --text-md: 1.125rem;

    /* 18px - Lead paragraphs */
    --text-lg: 1.25rem;

    /* 20px - Small headings */
    --text-xl: 1.5rem;

    /* 24px - H4, card titles */
    --text-2xl: 1.875rem;

    /* 30px - H3 */
    --text-3xl: 2.25rem;

    /* 36px - H2 */
    --text-4xl: 3rem;

    /* 48px - H1 */
    --text-5xl: 3.75rem;

    /* 60px - Display text */

    /* Font Weights */
    --font-normal: 400;
    --font-medium: 500;
    --font-semibold: 600;
    --font-bold: 700;

    /* Line Heights */
    --leading-none: 1;
    --leading-tight: 1.25;
    --leading-snug: 1.375;
    --leading-normal: 1.5;
    --leading-relaxed: 1.625;

    /* -------------------------------------------------------------------------
       SPACING SCALE
       Use these variables for ALL spacing (margin, padding, gap)
       ------------------------------------------------------------------------- */
    --space-0: 0;
    --space-1: 0.25rem;

    /* 4px */
    --space-2: 0.5rem;

    /* 8px */
    --space-3: 0.75rem;

    /* 12px */
    --space-4: 1rem;

    /* 16px */
    --space-5: 1.25rem;

    /* 20px */
    --space-6: 1.5rem;

    /* 24px */
    --space-8: 2rem;

    /* 32px */
    --space-10: 2.5rem;

    /* 40px */
    --space-12: 3rem;

    /* 48px */
    --space-16: 4rem;

    /* 64px */
    --space-20: 5rem;

    /* 80px */
    --space-24: 6rem;

    /* 96px */

    /* Legacy spacing aliases (deprecated, use --space-* instead) */
    --spacing-xs: var(--space-1);
    --spacing-sm: var(--space-2);
    --spacing-md: var(--space-4);
    --spacing-lg: var(--space-6);
    --spacing-xl: var(--space-8);
    --spacing-2xl: var(--space-12);
    --spacing-3xl: var(--space-16);

    /* -------------------------------------------------------------------------
       BORDER RADIUS SCALE
       Use these variables for ALL border-radius values
       ------------------------------------------------------------------------- */
    --radius-none: 0;
    --radius-xs: 2px;

    /* Small badges, tags */
    --radius-sm: 4px;

    /* Inputs, small buttons */
    --radius-md: 8px;

    /* Cards, panels */
    --radius-lg: 12px;

    /* Large cards, modals */
    --radius-xl: 16px;

    /* Hero elements */
    --radius-2xl: 24px;

    /* Extra large elements */
    --radius-full: 9999px;

    /* Circles, pills, avatars */

    /* Legacy radius aliases (deprecated, use --radius-md for default) */
    --radius: var(--radius-md);

    /* -------------------------------------------------------------------------
       LAYOUT DIMENSIONS
       ------------------------------------------------------------------------- */
    --player-bar-height-desktop: 90px;
    --player-bar-height-mobile: 130px;
    --sidebar-width: 240px;
    --sidebar-collapsed-width: 70px;

    /* -------------------------------------------------------------------------
       TRANSITIONS & ANIMATIONS
       ------------------------------------------------------------------------- */
    --duration-instant: 0ms;
    --duration-fast: 150ms;
    --duration-normal: 300ms;
    --duration-slow: 500ms;
    --ease-linear: linear;
    --ease-in: cubic-bezier(0.4, 0, 1, 1);
    --ease-out: cubic-bezier(0, 0, 0.2, 1);
    --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
    --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
    --ease-elastic: cubic-bezier(0.68, -0.55, 0.265, 1.55);
    --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);

    /* Legacy transition aliases */
    --transition-fast: var(--duration-fast) var(--ease-in-out);
    --transition-normal: var(--duration-normal) var(--ease-in-out);
    --transition-slow: var(--duration-slow) var(--ease-in-out);
    --transition: var(--transition-normal);

    /* -------------------------------------------------------------------------
       SHADOWS
       ------------------------------------------------------------------------- */
    --shadow-none: none;
    --shadow-xs: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-sm: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
    --shadow-inner: inset 0 2px 4px 0 rgb(0 0 0 / 0.05);
    --shadow-glow: 0 0 20px rgb(var(--highlight-rgb) / 0.5);

    /* -------------------------------------------------------------------------
       Z-INDEX SCALE
       ------------------------------------------------------------------------- */
    --z-hide: -1;
    --z-base: 0;
    --z-docked: 10;
    --z-dropdown: 1000;
    --z-sticky: 1100;
    --z-banner: 1200;
    --z-overlay: 1300;
    --z-modal: 1400;
    --z-popover: 1500;
    --z-tooltip: 1600;
    --z-toast: 1700;

    /* -------------------------------------------------------------------------
       COMPONENT TOKENS
       ------------------------------------------------------------------------- */

    /* Buttons */
    --btn-height-sm: 32px;
    --btn-height-md: 40px;
    --btn-height-lg: 48px;
    --btn-padding-sm: var(--space-2) var(--space-3);
    --btn-padding-md: var(--space-3) var(--space-4);
    --btn-padding-lg: var(--space-4) var(--space-6);

    /* Inputs */
    --input-height: 40px;
    --input-padding: var(--space-3) var(--space-4);

    /* Cards */
    --card-padding: var(--space-4);
    --card-gap: var(--space-4);
    --card-radius: var(--radius-lg);

    /* Modals */
    --modal-padding: var(--space-6);
    --modal-radius: var(--radius-xl);
    --modal-max-width-sm: 400px;
    --modal-max-width-md: 500px;
    --modal-max-width-lg: 600px;
    --modal-max-width-xl: 800px;

    /* Covers */
    --cover-blur-radius: 50px;
    --cover-filter: blur(var(--ultra-cover-blur-radius, var(--cover-blur-radius, 50px))) brightness(0.4);
    --cover-radius: var(--radius-md);

    /* -------------------------------------------------------------------------
       RESPONSIVE CALCULATION VARIABLES
       Algorithmic UI calculations based on viewport
       ------------------------------------------------------------------------- */
    --viewport-width: 100vw;
    --viewport-height: 100vh;
    --container-padding: clamp(0.75rem, 2vw, 2rem);

    /* Fluid typography scale using clamp() */
    --text-base-fluid: clamp(0.875rem, 0.8rem + 0.25vw, 1rem);
    --text-lg-fluid: clamp(1rem, 0.9rem + 0.35vw, 1.25rem);
    --text-xl-fluid: clamp(1.25rem, 1rem + 0.75vw, 1.5rem);
    --text-2xl-fluid: clamp(1.5rem, 1.25rem + 1vw, 1.875rem);
    --text-3xl-fluid: clamp(1.75rem, 1.5rem + 1.25vw, 2.25rem);
    --text-4xl-fluid: clamp(2rem, 1.5rem + 2vw, 3rem);

    /* Fluid spacing */
    --space-fluid-sm: clamp(0.5rem, 0.25rem + 1vw, 1rem);
    --space-fluid-md: clamp(1rem, 0.5rem + 2vw, 2rem);
    --space-fluid-lg: clamp(1.5rem, 0.75rem + 3vw, 3rem);

    /* Dynamic layout dimensions */
    --sidebar-width-fluid: clamp(180px, 15vw, 240px);
    --sidebar-collapsed-width-fluid: clamp(60px, 5vw, 70px);
    --player-bar-height-fluid: clamp(80px, 10vh, 90px);
    --player-bar-height-mobile-fluid: clamp(120px, 15vh, 140px);

    /* Card dimensions */
    --card-min-width: clamp(140px, 15vw, 200px);
    --card-max-width: clamp(180px, 20vw, 250px);
    --card-gap-fluid: clamp(0.75rem, 1.5vw, 1.5rem);

    /* Touch target sizes for accessibility */
    --touch-target-min: 44px;

    /* WCAG minimum */
    --touch-target-comfortable: 48px;

    /* Animation multiplier (controlled by JS for performance modes) */
    --animation-multiplier: 1;

    /* Background blur intensity - reduced for less extreme glassomorphism */
    --background-blur: 12px;
    --surface-blur: var(--background-blur);
    --dynamic-gradient-duration: 15s;
    --motion-wave-amplitude: 4px;
    --motion-wave-duration: 6s;

    /* -------------------------------------------------------------------------
       SEMANTIC COLORS (will be overridden by themes)
       ------------------------------------------------------------------------- */
    --color-danger: #ef4444;
    --color-danger-hover: #dc2626;
    --color-success: #10b981;
    --color-success-hover: #059669;
    --color-warning: #f59e0b;
    --color-warning-hover: #d97706;
    --color-info: #3b82f6;
    --color-info-hover: #2563eb;
}

/* Palette-driven colour transitions ---------------------------------------- */
.btn-primary,
.progress-fill,
.seek-thumb,
.volume-fill,
.quality-hires,
.fullscreen-controls .progress-fill,
.fullscreen-buttons button.active,
.card:hover,
.nav-item.active a,
#fs-play-pause-btn {
    transition-property: background-color, color, border-color, box-shadow;
    transition-duration: var(--palette-transition);
    transition-timing-function: ease;
}

:root[data-theme='monochrome'] {
    color-scheme: dark;

    --background: #0a0a0a;
    --foreground: #f5f5f5;
    --card: #141414;
    --card-foreground: #f5f5f5;
    --primary: #f5f5f5;
    --primary-foreground: #0a0a0a;
    --secondary: #1f1f1f;
    --secondary-foreground: #e0e0e0;
    --muted: #1f1f1f;
    --muted-foreground: #a0a0a0;
    --border: #2a2a2a;
    --input: #1f1f1f;
    --ring: #f5f5f5;
    --highlight: #f5f5f5;
    --highlight-rgb: 245, 245, 245;
    --active-highlight: var(--highlight);
    --explicit-badge: #f5f5f5;
}

:root[data-theme='dark'] {
    color-scheme: dark;

    --background: #0a0a0a;
    --foreground: #ededed;
    --card: #1a1a1a;
    --card-foreground: #ededed;
    --primary: #3b82f6;
    --primary-foreground: #fff;
    --secondary: #2a2a2a;
    --secondary-foreground: #ededed;
    --muted: #2a2a2a;
    --muted-foreground: #a0a0a0;
    --border: #2a2a2a;
    --input: #2a2a2a;
    --ring: #3b82f6;
    --highlight: #3b82f6;
    --highlight-rgb: 59, 130, 246;
    --active-highlight: #3b82f6;
    --explicit-badge: #750a0a;
}

:root[data-theme='ocean'] {
    color-scheme: dark;

    --background: #0c1821;
    --foreground: #e0f4ff;
    --card: #1b2838;
    --card-foreground: #e0f4ff;
    --primary: #06b6d4;
    --primary-foreground: #0c1821;
    --secondary: #1e3a52;
    --secondary-foreground: #e0f4ff;
    --muted: #1e3a52;
    --muted-foreground: #94c5e0;
    --border: #1e3a52;
    --input: #1e3a52;
    --ring: #06b6d4;
    --highlight: #06b6d4;
    --highlight-rgb: 6, 182, 212;
    --active-highlight: #06b6d4;
    --explicit-badge: #f43f5e;
}

:root[data-theme='purple'] {
    color-scheme: dark;

    --background: #0f0514;
    --foreground: #f3e8ff;
    --card: #1e0a2e;
    --card-foreground: #f3e8ff;
    --primary: #a855f7;
    --primary-foreground: #fff;
    --secondary: #2d1545;
    --secondary-foreground: #f3e8ff;
    --muted: #2d1545;
    --muted-foreground: #c4b5fd;
    --border: #2d1545;
    --input: #2d1545;
    --ring: #a855f7;
    --highlight: #a855f7;
    --highlight-rgb: 168, 85, 247;
    --active-highlight: #a855f7;
    --explicit-badge: #ec4899;
}

:root[data-theme='forest'] {
    color-scheme: dark;

    --background: #0a1409;
    --foreground: #e8f5e9;
    --card: #1a2e1a;
    --card-foreground: #e8f5e9;
    --primary: #22c55e;
    --primary-foreground: #0a1409;
    --secondary: #2d4a2d;
    --secondary-foreground: #e8f5e9;
    --muted: #2d4a2d;
    --muted-foreground: #86efac;
    --border: #2d4a2d;
    --input: #2d4a2d;
    --ring: #22c55e;
    --highlight: #22c55e;
    --highlight-rgb: 34, 197, 94;
    --active-highlight: #22c55e;
    --explicit-badge: #f59e0b;
}

:root[data-theme='mocha'] {
    color-scheme: dark;

    --background: #1e1e2e;
    --foreground: #cdd6f4;
    --card: #313244;
    --card-foreground: #9399b2;
    --primary: #89b4fa;
    --primary-foreground: #313244;
    --secondary: #45475a;
    --secondary-foreground: #9399b2;
    --muted: #313244;
    --muted-foreground: #a6adc8;
    --border: #313244;
    --input: #45475a;
    --ring: #89b4fa;
    --highlight: #89b4fa;
    --highlight-rgb: 180, 190, 254;
    --active-highlight: #b4befe;
    --explicit-badge: #f9e2af;
}

:root[data-theme='machiatto'] {
    color-scheme: dark;

    --background: #24273a;
    --foreground: #cad3f5;
    --card: #363a4f;
    --card-foreground: #939ab7;
    --primary: #8aadf4;
    --primary-foreground: #363a4f;
    --secondary: #494d64;
    --secondary-foreground: #6e738d;
    --muted: #363a4f;
    --muted-foreground: #a5adcb;
    --border: #363a4f;
    --input: #494d64;
    --ring: #8aadf4;
    --highlight: #8aadf4;
    --highlight-rgb: 183, 189, 248;
    --active-highlight: #b7bdf8;
    --explicit-badge: #eed49f;
}

:root[data-theme='frappe'] {
    color-scheme: dark;

    --background: #303446;
    --foreground: #c6d0f5;
    --card: #414559;
    --card-foreground: #949cbb;
    --primary: #8caaee;
    --primary-foreground: #313244;
    --secondary: #51576d;
    --secondary-foreground: #a5adce;
    --muted: #414559;
    --muted-foreground: #a5adce;
    --border: #414559;
    --input: #45475a;
    --ring: #8caaee;
    --highlight: #8caaee;
    --highlight-rgb: 186, 187, 241;
    --active-highlight: #babbf1;
    --explicit-badge: #e5c890;
}

:root[data-theme='latte'] {
    color-scheme: light;

    --background: #eff1f5;
    --foreground: #4c4f69;
    --card: #ccd0da;
    --card-foreground: #7c7f93;
    --primary: #1e66f5;
    --primary-foreground: #ccd0da;
    --secondary: #bcc0cc;
    --secondary-foreground: #9ca0b0;
    --muted: #ccd0da;
    --muted-foreground: #6c6f85;
    --border: #ccd0da;
    --input: #bcc0cc;
    --ring: #fdfdfd;
    --highlight: #1e66f5;
    --highlight-rgb: 114, 135, 253;
    --active-highlight: #7287fd;
    --explicit-badge: #df8e1d;
}

:root[data-theme='white'] {
    color-scheme: light;

    --background: #f5f5f5;
    --foreground: #1a1a1a;
    --card: #e8e8e8;
    --card-foreground: #1a1a1a;
    --primary: #1a1a1a;
    --primary-foreground: #f5f5f5;
    --secondary: #ddd;
    --secondary-foreground: #2a2a2a;
    --muted: #e0e0e0;
    --muted-foreground: #555;
    --border: #ccc;
    --input: #e0e0e0;
    --ring: #1a1a1a;
    --highlight: #1a1a1a;
    --highlight-rgb: 26, 26, 26;
    --active-highlight: var(--highlight);
    --explicit-badge: #1a1a1a;
    --cover-filter: blur(var(--ultra-cover-blur-radius, var(--cover-blur-radius, 50px))) brightness(1.6) opacity(0.35);
}

:root[data-theme='dynamic'] {
    color-scheme: dark;

    --background: #0a0a0a;
    --foreground: #f5f5f5;
    --card: rgb(20, 20, 20, 0.8);
    --card-foreground: #f5f5f5;
    --primary: #f5f5f5;
    --primary-foreground: #0a0a0a;
    --secondary: rgb(30, 30, 30, 0.8);
    --secondary-foreground: #e0e0e0;
    --muted: rgb(30, 30, 30, 0.8);
    --muted-foreground: #a0a0a0;
    --border: rgb(50, 50, 50, 0.6);
    --input: rgb(30, 30, 30, 0.8);
    --ring: #f5f5f5;
    --highlight: #f5f5f5;
    --highlight-rgb: 245, 245, 245;
    --active-highlight: var(--highlight);
    --explicit-badge: #f5f5f5;
}

/* Dynamic theme animated gradient background */
[data-theme='dynamic'] .app-container {
    position: relative;
}

[data-theme='dynamic'] .app-container::before {
    content: '';
    position: fixed;
    inset: 0;
    z-index: -1;
    background: var(--dynamic-gradient, linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #0a0a0a 100%));
    background-size: 400% 400%;
    animation: dynamic-gradient-shift var(--dynamic-gradient-duration, 15s) ease infinite;
    transition: background var(--duration-slow) var(--ease-in-out);
    filter: brightness(var(--dynamic-brightness, 0.4));
}

@keyframes dynamic-gradient-shift {
    0% {
        background-position: 0% 50%;
    }

    25% {
        background-position: 100% 0%;
    }

    50% {
        background-position: 100% 50%;
    }

    75% {
        background-position: 0% 100%;
    }

    100% {
        background-position: 0% 50%;
    }
}

:root.animations-ultra[data-theme='dynamic'] .app-container::before {
    inset: -12%;
    background-size: 130% 130%;
    animation: dynamic-gradient-pan var(--dynamic-gradient-duration, 18s) linear infinite;
    will-change: transform;
    transform: translate3d(0, 0, 0);
}

@keyframes dynamic-gradient-pan {
    0% {
        transform: translate3d(-4%, -4%, 0) scale(1.03);
    }

    50% {
        transform: translate3d(4%, 4%, 0) scale(1.07);
    }

    100% {
        transform: translate3d(-4%, -4%, 0) scale(1.03);
    }
}

*,
*::before,
*::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--font-family, 'Inter', sans-serif) !important;
}

html {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    height: 100%;
    overflow: hidden;
    font-size: var(--font-size-scale, 100%);
}

body {
    background-color: var(--background);
    color: var(--foreground);
    font-family: var(--font-family, 'Inter', sans-serif) !important;
    overflow: hidden;
    transition:
        background-color 0.3s ease,
        color 0.3s ease;
    height: 100%;
    position: fixed;
    width: 100%;
}

img {
    max-width: 100%;
    display: block;
    background-color: var(--muted);
    border: none;
}

a {
    color: inherit;
    text-decoration: none;
}

.text-link {
    color: var(--primary);
    text-decoration: underline;
    cursor: pointer;
}

.text-link:hover {
    color: var(--highlight);
}

kbd {
    background-color: var(--secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    padding: var(--space-1) var(--space-2);
    font-size: var(--text-sm);
    font-family: inherit;
    box-shadow: var(--shadow-sm);
}

/* ==========================================================================
   UTILITY CLASSES
   Consistent utility classes for common patterns
   ========================================================================== */

/* Typography utilities */
.text-xs {
    font-size: var(--text-xs);
}

.text-sm {
    font-size: var(--text-sm);
}

.text-base {
    font-size: var(--text-base);
}

.text-md {
    font-size: var(--text-md);
}

.text-lg {
    font-size: var(--text-lg);
}

.text-xl {
    font-size: var(--text-xl);
}

.text-2xl {
    font-size: var(--text-2xl);
}

.text-3xl {
    font-size: var(--text-3xl);
}

.text-4xl {
    font-size: var(--text-4xl);
}

.font-normal {
    font-weight: var(--font-normal);
}

.font-medium {
    font-weight: var(--font-medium);
}

.font-semibold {
    font-weight: var(--font-semibold);
}

.font-bold {
    font-weight: var(--font-bold);
}

.leading-none {
    line-height: var(--leading-none);
}

.leading-tight {
    line-height: var(--leading-tight);
}

.leading-snug {
    line-height: var(--leading-snug);
}

.leading-normal {
    line-height: var(--leading-normal);
}

.leading-relaxed {
    line-height: var(--leading-relaxed);
}

/* Spacing utilities */
.m-0 {
    margin: var(--space-0);
}

.m-1 {
    margin: var(--space-1);
}

.m-2 {
    margin: var(--space-2);
}

.m-3 {
    margin: var(--space-3);
}

.m-4 {
    margin: var(--space-4);
}

.m-6 {
    margin: var(--space-6);
}

.m-8 {
    margin: var(--space-8);
}

.mt-0 {
    margin-top: var(--space-0);
}

.mt-1 {
    margin-top: var(--space-1);
}

.mt-2 {
    margin-top: var(--space-2);
}

.mt-3 {
    margin-top: var(--space-3);
}

.mt-4 {
    margin-top: var(--space-4);
}

.mt-6 {
    margin-top: var(--space-6);
}

.mb-0 {
    margin-bottom: var(--space-0);
}

.mb-1 {
    margin-bottom: var(--space-1);
}

.mb-2 {
    margin-bottom: var(--space-2);
}

.mb-3 {
    margin-bottom: var(--space-3);
}

.mb-4 {
    margin-bottom: var(--space-4);
}

.mb-6 {
    margin-bottom: var(--space-6);
}

.ml-0 {
    margin-left: var(--space-0);
}

.ml-2 {
    margin-left: var(--space-2);
}

.ml-4 {
    margin-left: var(--space-4);
}

.mr-0 {
    margin-right: var(--space-0);
}

.mr-2 {
    margin-right: var(--space-2);
}

.mr-4 {
    margin-right: var(--space-4);
}

.mx-0 {
    margin-left: var(--space-0);
    margin-right: var(--space-0);
}

.mx-2 {
    margin-left: var(--space-2);
    margin-right: var(--space-2);
}

.mx-4 {
    margin-left: var(--space-4);
    margin-right: var(--space-4);
}

.my-0 {
    margin-top: var(--space-0);
    margin-bottom: var(--space-0);
}

.my-2 {
    margin-top: var(--space-2);
    margin-bottom: var(--space-2);
}

.my-4 {
    margin-top: var(--space-4);
    margin-bottom: var(--space-4);
}

.p-0 {
    padding: var(--space-0);
}

.p-1 {
    padding: var(--space-1);
}

.p-2 {
    padding: var(--space-2);
}

.p-3 {
    padding: var(--space-3);
}

.p-4 {
    padding: var(--space-4);
}

.p-6 {
    padding: var(--space-6);
}

.px-0 {
    padding-left: var(--space-0);
    padding-right: var(--space-0);
}

.px-2 {
    padding-left: var(--space-2);
    padding-right: var(--space-2);
}

.px-3 {
    padding-left: var(--space-3);
    padding-right: var(--space-3);
}

.px-4 {
    padding-left: var(--space-4);
    padding-right: var(--space-4);
}

.py-0 {
    padding-top: var(--space-0);
    padding-bottom: var(--space-0);
}

.py-1 {
    padding-top: var(--space-1);
    padding-bottom: var(--space-1);
}

.py-2 {
    padding-top: var(--space-2);
    padding-bottom: var(--space-2);
}

.py-3 {
    padding-top: var(--space-3);
    padding-bottom: var(--space-3);
}

.gap-0 {
    gap: var(--space-0);
}

.gap-1 {
    gap: var(--space-1);
}

.gap-2 {
    gap: var(--space-2);
}

.gap-3 {
    gap: var(--space-3);
}

.gap-4 {
    gap: var(--space-4);
}

.gap-6 {
    gap: var(--space-6);
}

/* Radius utilities */
.rounded-none {
    border-radius: var(--radius-none);
}

.rounded-xs {
    border-radius: var(--radius-xs);
}

.rounded-sm {
    border-radius: var(--radius-sm);
}

.rounded-md {
    border-radius: var(--radius-md);
}

.rounded-lg {
    border-radius: var(--radius-lg);
}

.rounded-xl {
    border-radius: var(--radius-xl);
}

.rounded-full {
    border-radius: var(--radius-full);
}

/* Shadow utilities */
.shadow-none {
    box-shadow: var(--shadow-none);
}

.shadow-xs {
    box-shadow: var(--shadow-xs);
}

.shadow-sm {
    box-shadow: var(--shadow-sm);
}

.shadow-md {
    box-shadow: var(--shadow-md);
}

.shadow-lg {
    box-shadow: var(--shadow-lg);
}

.shadow-xl {
    box-shadow: var(--shadow-xl);
}

/* Display utilities */
.block {
    display: block;
}

.inline-block {
    display: inline-block;
}

.inline {
    display: inline;
}

.flex {
    display: flex;
}

.inline-flex {
    display: inline-flex;
}

.grid {
    display: grid;
}

.hidden {
    display: none;
}

/* Flex utilities */
.flex-row {
    flex-direction: row;
}

.flex-col {
    flex-direction: column;
}

.flex-wrap {
    flex-wrap: wrap;
}

.flex-nowrap {
    flex-wrap: nowrap;
}

.items-start {
    align-items: flex-start;
}

.items-center {
    align-items: center;
}

.items-end {
    align-items: flex-end;
}

.justify-start {
    justify-content: flex-start;
}

.justify-center {
    justify-content: center;
}

.justify-end {
    justify-content: flex-end;
}

.justify-between {
    justify-content: space-between;
}

.flex-1 {
    flex: 1 1 0%;
}

.flex-auto {
    flex: 1 1 auto;
}

.flex-none {
    flex: none;
}

/* Text utilities */
.text-left {
    text-align: left;
}

.text-center {
    text-align: center;
}

.text-right {
    text-align: right;
}

.truncate {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.line-clamp-3 {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* Color utilities */
.text-muted {
    color: var(--muted-foreground);
}

.text-highlight {
    color: var(--highlight);
}

/* Cursor utilities */
.cursor-pointer {
    cursor: pointer;
}

.cursor-default {
    cursor: default;
}

/* Transition utilities */
.transition-fast {
    transition: all var(--duration-fast) var(--ease-in-out);
}

.transition-normal {
    transition: all var(--duration-normal) var(--ease-in-out);
}

.transition-slow {
    transition: all var(--duration-slow) var(--ease-in-out);
}

/* ==========================================================================
   APP LAYOUT
   ========================================================================== */

.app-container {
    display: grid;
    height: 100vh;
    height: 100dvh;
    grid-template:
        'sidebar main' 1fr
        'player player' auto / 228px 1fr;
}

.sidebar {
    grid-area: sidebar;
    background: linear-gradient(165deg,
            color-mix(in srgb, var(--card) 78%, transparent) 0%,
            color-mix(in srgb, var(--background) 92%, transparent) 100%);
    backdrop-filter: blur(12px);
    border-right: 1px solid color-mix(in srgb, var(--border) 88%, transparent);
    box-shadow:
        inset -1px 0 0 color-mix(in srgb, var(--foreground) 6%, transparent),
        10px 0 30px rgb(0, 0, 0, 0.24);
    padding: 1.1rem 0.85rem 1rem;
    display: flex;
    flex-direction: column;
    gap: 0.85rem;
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 100;
    min-height: 0;
    width: 100%;
    overflow: hidden;
}

.sidebar.sidebar-account-open {
    overflow: visible;
}

.sidebar-content {
    display: flex;
    flex-direction: column;
    height: 100%;
    min-height: 0;
    gap: 0.75rem;
}

.sidebar-nav.main {
    flex: 1 1 auto;
    min-height: 0;
    overflow-y: auto;
    padding-right: 0.125rem;
    scrollbar-width: thin;
}

.sidebar-bottom-container {
    margin-top: auto;
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
}

.sidebar-nav-bottom {
    margin-top: auto;
    padding-top: 0.85rem;
    flex: 0 0 auto;
    border-top: 1px solid color-mix(in srgb, var(--border) 82%, transparent);
    background: transparent;
    position: relative;
}

.sidebar-nav-bottom::before {
    content: '';
    display: block;
    height: 0.5rem;
    margin-top: -0.5rem;
}

.sidebar-nav.bottom {
    margin: 0;
    padding: 0;
}

.sidebar-nav.bottom .nav-item a {
    padding: 0.55rem 0.72rem;
    gap: 0.6rem;
    font-size: 0.8rem;
    font-weight: 500;
}

.sidebar-nav.bottom .nav-item a svg {
    width: 17px;
    height: 17px;
}

.main-content {
    grid-area: main;
    overflow-y: auto;
    padding: var(--spacing-xl);
    scroll-behavior: smooth;
    position: relative;

    /* Context for background */
    padding-bottom: 160px !important;
}

#page-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60vh;
    min-height: 400px;
    z-index: 0;
    background-size: cover;
    background-position: center 20%;
    background-repeat: no-repeat;
    opacity: 0;
    transition: opacity 0.5s ease-in-out;

    /* Fade out at the bottom */
    mask-image: linear-gradient(to bottom, rgb(0, 0, 0, 1) 0%, rgb(0, 0, 0, 0.8) 40%, rgb(0, 0, 0, 0) 100%);

    /* Blur effect */
    filter: var(--cover-filter);
    pointer-events: none;
}

#page-background.active {
    opacity: 1;
}

/* Light mode adjustments */
:root[data-theme='white'] #page-background {
    mask-image: linear-gradient(to bottom, rgb(0, 0, 0, 1) 0%, rgb(0, 0, 0, 0) 100%);
}

.now-playing-bar {
    grid-area: player;
    padding: var(--spacing-sm) var(--spacing-md);
    display: grid;
    grid-template-columns: 1fr 0.9fr 1fr;
    align-items: center;
    gap: var(--spacing-sm);
    z-index: 2100;

    /* Floating bar overrides */
    width: calc(96% - 212px) !important;
    left: calc(212px + 2%);
    bottom: 15px !important;
    border-radius: var(--radius);

    /* Standardized radius */
    position: fixed !important;
    background-color: color-mix(in srgb, var(--card) 85%, transparent);
    backdrop-filter: blur(var(--surface-blur, var(--background-blur, 20px)));
    border: 1px solid var(--border);
    box-shadow: var(--shadow-2xl);

    /* Standardized shadow */
    transition: all var(--transition-normal) var(--ease-out-back);
    height: var(--player-bar-height-desktop);
    animation: slide-up var(--transition-slow) var(--ease-out-back);
}

:root[data-theme='white'] .now-playing-bar {
    background-color: color-mix(in srgb, var(--card) 80%, transparent);
    border-color: rgb(0, 0, 0, 0.1);
}

.sidebar-logo {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    font-size: 1.25rem;
    font-weight: 700;
    margin-bottom: 0.55rem;
    padding: 0 0.5rem;
    letter-spacing: -0.02em;
}

.sidebar-logo-link {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--foreground);
    text-decoration: none;
    min-width: 0;
}

.sidebar-logo .app-logo {
    width: 20px;
    height: 20px;
    flex-shrink: 0;
    color: var(--primary);
}

.sidebar-logo span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    min-width: 0;
    font-size: 1rem;
    letter-spacing: -0.01em;
}

#sidebar-toggle {
    width: 30px;
    height: 30px;
    border-radius: var(--radius-full);
    padding: 0;
    flex-shrink: 0;
    color: var(--muted-foreground);
    background: color-mix(in srgb, var(--card) 60%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
}

#sidebar-toggle:hover {
    color: var(--foreground);
    background: color-mix(in srgb, var(--secondary) 80%, transparent);
}

.sidebar-nav ul {
    list-style: none;
}

.sidebar-nav .nav-item {
    position: relative;
    margin-bottom: 2px;
}

.sidebar-nav .nav-item a {
    display: flex;
    align-items: center;
    gap: 0.82rem;
    padding: 0.6rem 0.78rem;
    border-radius: 0.88rem;
    color: var(--muted-foreground);
    font-weight: 550;
    line-height: 1.2;
    transition:
        color var(--transition-fast),
        transform var(--transition-fast),
        background-color var(--transition-fast),
        border-color var(--transition-fast),
        box-shadow var(--transition-fast);
    cursor: pointer;
    position: relative;
    border: 1px solid transparent;
    text-shadow: 0 0 0 transparent;
}

.search-bar svg.search-icon {
    width: 20px;
    height: 20px;
}

.sidebar-nav .nav-item a:hover {
    color: var(--foreground);
    background-color: color-mix(in srgb, var(--secondary) 72%, transparent);
    border-color: color-mix(in srgb, var(--border) 70%, transparent);
    transform: translateX(2px);
}

.sidebar-nav .nav-item a.active {
    background: linear-gradient(135deg,
            color-mix(in srgb, var(--primary) 18%, transparent) 0%,
            color-mix(in srgb, var(--primary) 9%, transparent) 100%);
    color: var(--primary);
    border-color: color-mix(in srgb, var(--primary) 35%, var(--border));
    box-shadow:
        0 0 0 1px color-mix(in srgb, var(--primary) 15%, transparent),
        inset 0 0 0 0.5px color-mix(in srgb, var(--foreground) 5%, transparent);
}

.sidebar-nav .nav-item a.active::before {
    display: none;
}

.sidebar-nav .nav-item a svg {
    width: 19px;
    height: 19px;
    flex-shrink: 0;
    opacity: 0.9;
}

.sidebar-account-item {
    margin-top: 0.5rem;
    border-top: 1px solid color-mix(in srgb, var(--border) 78%, transparent);
    padding-top: 0.55rem;
}

.header-account-control {
    position: relative;
    width: 100%;
}

.nav-btn-account {
    width: 100%;
    display: flex;
    align-items: center;
    gap: 0.68rem;
    padding: 0.56rem 0.66rem;
    border-radius: 0.9rem;
    border: 1px solid color-mix(in srgb, var(--border) 88%, transparent);
    background: linear-gradient(145deg,
            color-mix(in srgb, var(--card) 92%, transparent) 0%,
            color-mix(in srgb, var(--background) 96%, transparent) 100%);
    color: var(--foreground);
    text-align: left;
    cursor: pointer;
    transition:
        transform var(--transition-fast),
        border-color var(--transition-fast),
        background-color var(--transition-fast),
        box-shadow var(--transition-fast);
}

.nav-btn-account:hover {
    transform: translateY(-1px);
    border-color: color-mix(in srgb, var(--primary) 34%, var(--border));
    background: linear-gradient(145deg,
            color-mix(in srgb, var(--secondary) 74%, transparent) 0%,
            color-mix(in srgb, var(--card) 96%, transparent) 100%);
    box-shadow:
        0 8px 18px rgb(0, 0, 0, 0.16),
        inset 0 0 0 1px color-mix(in srgb, var(--foreground) 6%, transparent);
}

.nav-btn-account:focus-visible {
    outline: none;
    box-shadow:
        0 0 0 2px color-mix(in srgb, var(--primary) 35%, transparent),
        0 0 0 4px color-mix(in srgb, var(--primary) 18%, transparent);
}

.nav-account-avatar {
    position: relative;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    overflow: hidden;
    border: 1px solid color-mix(in srgb, var(--border) 88%, transparent);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: color-mix(in srgb, var(--secondary) 72%, transparent);
    flex-shrink: 0;
    color: var(--muted-foreground);
}

#header-account-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: none;
}

.nav-account-status-dot {
    position: absolute;
    right: 0;
    bottom: 0;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    border: 1px solid var(--card);
    background: color-mix(in srgb, var(--muted-foreground) 70%, transparent);
}

.nav-btn-account.is-authenticated .nav-account-status-dot {
    background: #22c55e;
}

.nav-account-meta {
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 0.05rem;
    flex: 1;
}

#sidebar-account-name {
    font-size: 0.87rem;
    font-weight: 620;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#sidebar-account-subtitle {
    font-size: 0.72rem;
    color: color-mix(in srgb, var(--muted-foreground) 90%, transparent);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.nav-account-chevron {
    width: 14px;
    height: 14px;
    color: var(--muted-foreground);
    transition: transform var(--transition-fast);
    flex-shrink: 0;
}

.nav-btn-account.is-open .nav-account-chevron {
    transform: rotate(180deg);
}

.pinned-items-header {
    font-size: 0.75rem;
    text-transform: uppercase;
    color: var(--muted-foreground);
    padding: 0 0.75rem;
    margin-bottom: 0.5rem;
    font-weight: 600;
    letter-spacing: 0.05em;
}

#pinned-items-nav {
    margin-top: auto;
    min-height: 0;
    flex: 1 1 auto;
    margin-bottom: 0;
    padding-bottom: 0;
    overflow: visible;
}

#pinned-items-list .nav-item a {
    gap: 0.75rem;
    padding: 0.5rem 0.75rem;
    font-size: 0.9rem;
}

#pinned-items-list .nav-item a .pinned-item-cover {
    width: 24px;
    height: 24px;
    border-radius: var(--radius-sm);
    flex-shrink: 0;
    object-fit: cover;
}

#pinned-items-list .nav-item a .pinned-item-cover.artist {
    border-radius: var(--radius-full);
}

#pinned-items-list .nav-item a .pinned-item-name {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    flex: 1;
}

.pinned-item-collage {
    width: 24px;
    height: 24px;
    border-radius: var(--radius-sm);
    flex-shrink: 0;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    overflow: hidden;
}

.pinned-item-collage img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    background-color: var(--muted);
}

#sidebar-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgb(4, 4, 8, 0.56);
    z-index: 2150;
    backdrop-filter: blur(4px);
}

.main-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--spacing-sm);
    position: sticky;
    top: 0.5rem;
    margin-bottom: var(--spacing-lg);
    padding: 0.55rem;
    background: color-mix(in srgb, var(--card) 75%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
    border-radius: 1.05rem;
    backdrop-filter: blur(8px);
    box-shadow: 0 10px 28px rgb(0, 0, 0, 0.26);
    z-index: 1000;
}

.navigation-controls {
    display: flex;
    gap: 0.5rem;
    align-items: center;
    flex: 0 0 auto;
    padding-right: 0.25rem;
    padding-left: 0.15rem;
    border-right: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
}

.nav-btn {
    width: 34px;
    height: 34px;
    border-radius: var(--radius-full);
    background-color: color-mix(in srgb, var(--card) 82%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
    color: var(--foreground);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition:
        transform var(--transition-fast),
        background-color var(--transition-fast),
        box-shadow var(--transition-fast);
    box-shadow: 0 4px 14px rgb(0, 0, 0, 0.18);
}

.nav-btn:hover {
    background-color: color-mix(in srgb, var(--secondary) 82%, transparent);
    transform: translateY(-1px);
    box-shadow: 0 8px 18px rgb(0, 0, 0, 0.2);
}

.nav-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
}

.hamburger-menu {
    display: none;
    background: color-mix(in srgb, var(--card) 82%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
    color: var(--foreground);
    cursor: pointer;
    width: 34px;
    height: 34px;
    padding: 0;
    border-radius: var(--radius-full);
    align-items: center;
    justify-content: center;
    transition:
        background-color var(--transition),
        transform var(--transition-fast);
}

.hamburger-menu:hover {
    background-color: color-mix(in srgb, var(--secondary) 82%, transparent);
    transform: translateY(-1px);
}

.search-bar {
    flex: 1 1 auto;
    width: auto;
    min-width: 0;
    max-width: none;
}

.search-bar input {
    font-size: 1rem;
    transition:
        box-shadow var(--transition-fast),
        border-color var(--transition-fast),
        background-color var(--transition-fast);
}

/* Shared search bar styles */
.search-bar,
.track-list-search-container {
    position: relative;
    display: flex;
    align-items: center;
}

.search-bar svg.search-icon,
.track-list-search-container svg.search-icon {
    position: absolute;
    left: 0.75rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted-foreground);
    pointer-events: none;
}

.search-bar input,
.track-list-search-input {
    width: 100%;
    padding: 0.75rem 2.5rem;
    background-color: color-mix(in srgb, var(--input) 78%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 88%, transparent);
    border-radius: 0.88rem;
    color: var(--foreground);
    transition:
        box-shadow var(--transition-fast),
        border-color var(--transition-fast);
}

.search-bar input:focus,
.track-list-search-input:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb) / 0.2);
}

.search-clear-btn {
    position: absolute;
    right: 0.25rem;
    top: 50%;
    transform: translateY(-50%);
    font-size: 1.5rem;
    line-height: 1;
    z-index: 1;
}

/* Main header search: navigation controls next to search bar, clear button outside input. */
#search-form {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    width: 100%;
}

.search-nav-controls {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    flex-shrink: 0;
}

.search-nav-controls .nav-btn {
    width: 32px;
    height: 32px;
}

.search-nav-controls .hamburger-menu {
    display: none;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    padding: 0;
    background: color-mix(in srgb, var(--card) 82%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
    border-radius: var(--radius-full);
    color: var(--foreground);
    cursor: pointer;
    transition: all var(--transition-fast);
}

.search-nav-controls .hamburger-menu:hover {
    background-color: color-mix(in srgb, var(--secondary) 82%, transparent);
    transform: translateY(-1px);
}

.search-input-wrapper {
    position: relative;
    flex: 1;
    min-width: 0;
}

.search-input-wrapper input {
    width: 100%;
    padding-right: 2rem;
}

.search-input-wrapper .search-clear-btn {
    position: absolute;
    right: 0.5rem;
    top: 50%;
    transform: translateY(-50%);
}

body.has-page-background .search-bar input {
    background-color: var(--background);
}

body.has-page-background .track-item:hover {
    background-color: var(--track-hover-bg, var(--secondary));
    transform: scale(1.005);
}

.search-history {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--card);
    border: 1px solid var(--border);
    border-top: none;
    border-radius: 0 0 var(--radius) var(--radius);
    max-height: 300px;
    overflow-y: auto;
    z-index: 9999;
    box-shadow: var(--shadow-xl);
    margin-top: -1px;
    animation: slide-up var(--transition-fast) var(--ease-out-back);
    transform-origin: top;
}

.search-history-item {
    padding: 0.75rem 1rem;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    cursor: pointer;
    transition: background var(--transition);
}

.search-history-item:hover {
    background: var(--secondary);
}

.search-history-item .history-icon {
    color: var(--muted-foreground);
    opacity: 0.5;
    flex-shrink: 0;
}

.search-history-item .query-text {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-history-item .delete-history-btn {
    padding: 4px;
    color: var(--muted-foreground);
    opacity: 0.5;
    transition: opacity var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.search-history-item .delete-history-btn:hover {
    opacity: 1;
    color: #ef4444;
}

.search-history-clear-all {
    padding: 0.75rem 1rem;
    text-align: center;
    font-size: 0.85rem;
    color: var(--primary);
    cursor: pointer;
    border-top: 1px solid var(--border);
    transition: background var(--transition);
}

.search-history-clear-all:hover {
    background: var(--secondary);
}

input[type='search']::-webkit-search-cancel-button {
    appearance: none;
    display: none;
}

.page {
    display: none;
    position: relative;
    z-index: 1;
}

.page.active {
    display: block;
    animation: fade-in-slide-up var(--transition-normal) var(--ease-out-back);
}

@keyframes fade-in {
    from {
        opacity: 0;
    }

    to {
        opacity: 1;
    }
}

@keyframes fade-in-slide-up {
    from {
        opacity: 0;
        transform: translate3d(0, 10px, 0);
    }

    to {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }
}

@keyframes scale-in {
    from {
        opacity: 0;
        transform: scale3d(0.95, 0.95, 1);
    }

    to {
        opacity: 1;
        transform: scale3d(1, 1, 1);
    }
}

@keyframes pop-in {
    0% {
        opacity: 0;
        transform: scale3d(0.9, 0.9, 1);
    }

    70% {
        transform: scale3d(1.02, 1.02, 1);
    }

    100% {
        opacity: 1;
        transform: scale3d(1, 1, 1);
    }
}

@keyframes slide-in {
    from {
        opacity: 0;
        transform: translate3d(20px, 0, 0);
    }

    to {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }
}

@keyframes slide-out {
    from {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }

    to {
        opacity: 0;
        transform: translate3d(20px, 0, 0);
    }
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

@keyframes pulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.5;
    }
}

/* =========================================
   LOAD ANIMATIONS - Text and UI Elements
   ========================================= */

/* Text reveal animation - characters slide up and fade in */
@keyframes text-reveal {
    0% {
        opacity: 0;
        transform: translate3d(0, 100%, 0);
        filter: blur(4px);
    }

    100% {
        opacity: 1;
        transform: translate3d(0, 0, 0);
        filter: blur(0);
    }
}

/* Staggered text animation for headings */
@keyframes heading-reveal {
    0% {
        opacity: 0;
        transform: translate3d(-20px, 0, 0);
        letter-spacing: 0.2em;
    }

    100% {
        opacity: 1;
        transform: translate3d(0, 0, 0);
        letter-spacing: normal;
    }
}

/* Card grid stagger animation */
@keyframes card-enter {
    0% {
        opacity: 0;
        transform: translate3d(0, 30px, 0) scale3d(0.95, 0.95, 1);
    }

    100% {
        opacity: 1;
        transform: translate3d(0, 0, 0) scale3d(1, 1, 1);
    }
}

/* Shimmer loading effect */
@keyframes shimmer {
    0% {
        background-position: -200% 0;
    }

    100% {
        background-position: 200% 0;
    }
}

/* Glow pulse for featured content */
@keyframes glow-pulse {

    0%,
    100% {
        box-shadow: 0 0 20px rgb(var(--accent-rgb, 255, 255, 255), 0.3);
    }

    50% {
        box-shadow: 0 0 40px rgb(var(--accent-rgb, 255, 255, 255), 0.5);
    }
}

/* Float animation for hero elements */
@keyframes float {

    0%,
    100% {
        transform: translate3d(0, 0, 0);
    }

    50% {
        transform: translate3d(0, -10px, 0);
    }
}

/* Gradient shift for backgrounds */
@keyframes gradient-shift {
    0% {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }

    100% {
        background-position: 0% 50%;
    }
}

/* Text typewriter effect */
@keyframes typewriter {
    from {
        width: 0;
    }

    to {
        width: 100%;
    }
}

@keyframes blink-caret {

    0%,
    100% {
        border-color: transparent;
    }

    50% {
        border-color: var(--primary);
    }
}

/* Animation utility classes */
.animate-text-reveal {
    animation: text-reveal 0.6s var(--ease-out-back) forwards;
}

.animate-heading-reveal {
    animation: heading-reveal 0.8s var(--ease-out-back) forwards;
}

.animate-card-enter {
    animation: card-enter 0.5s var(--ease-out-back) forwards;
}

.animate-shimmer {
    background: linear-gradient(90deg, var(--card) 0%, var(--card-hover) 50%, var(--card) 100%);
    background-size: 200% 100%;
    animation: shimmer 1.5s infinite;
}

.animate-glow-pulse {
    animation: glow-pulse 2s ease-in-out infinite;
}

.animate-float {
    animation: float 3s ease-in-out infinite;
}

.animate-gradient {
    background-size: 200% 200%;
    animation: gradient-shift 8s ease infinite;
}

/* Staggered animation delays for lists */
.stagger-1 {
    animation-delay: 0.05s;
}

.stagger-2 {
    animation-delay: 0.1s;
}

.stagger-3 {
    animation-delay: 0.15s;
}

.stagger-4 {
    animation-delay: 0.2s;
}

.stagger-5 {
    animation-delay: 0.25s;
}

.stagger-6 {
    animation-delay: 0.3s;
}

.stagger-7 {
    animation-delay: 0.35s;
}

.stagger-8 {
    animation-delay: 0.4s;
}

.stagger-9 {
    animation-delay: 0.45s;
}

.stagger-10 {
    animation-delay: 0.5s;
}

/* Initial state for animated elements */
.animate-on-load {
    opacity: 0;
}

.animate-on-load.animated {
    opacity: 1;
}

/* =========================================
   CAROUSEL COMPONENT - YouTube Music Style
   ========================================= */

.carousel-container {
    position: relative;
    width: 100%;
    overflow: hidden;
    padding: var(--space-fluid-sm) 0;
}

.carousel-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding: 0 var(--container-padding);
}

.carousel-title {
    font-size: var(--text-xl-fluid);
    font-weight: 600;
    color: var(--text-primary);
}

.carousel-nav {
    display: flex;
    gap: 0.5rem;
}

.carousel-nav-btn {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 1px solid var(--border-color);
    background: var(--card);
    color: var(--text-primary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all var(--transition-fast);
}

.carousel-nav-btn:hover {
    background: var(--card-hover);
    transform: scale(1.05);
}

.carousel-nav-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    transform: none;
}

.carousel-track {
    display: flex;
    gap: var(--card-gap-fluid);
    padding: 0 var(--container-padding);
    overflow-x: auto;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    scroll-snap-type: x mandatory;
}

.carousel-track::-webkit-scrollbar {
    display: none;
}

.carousel-item {
    flex-shrink: 0;
    scroll-snap-align: start;
    animation: card-enter 0.5s var(--ease-out-back) forwards;
    opacity: 0;
}

/* Large carousel cards for featured content */
.carousel-item-large {
    width: clamp(280px, 40vw, 400px);
}

.carousel-item-large .card-image {
    aspect-ratio: 16/9;
    border-radius: var(--radius-lg);
    overflow: hidden;
}

/* Artist carousel with circular images */
.carousel-item-artist {
    width: clamp(140px, 15vw, 180px);
    text-align: center;
}

.carousel-item-artist .card-image {
    aspect-ratio: 1;
    border-radius: 50%;
    overflow: hidden;
    margin-bottom: 0.75rem;
}

.carousel-item-artist .card-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform var(--transition-normal);
}

.carousel-item-artist:hover .card-image img {
    transform: scale(1.1);
}

/* Album carousel */
.carousel-item-album {
    width: var(--card-min-width);
    max-width: var(--card-max-width);
}

.carousel-item-album .card-image {
    aspect-ratio: 1;
    border-radius: var(--radius-md);
    overflow: hidden;
    margin-bottom: 0.5rem;
}

/* Carousel progress indicator */
.carousel-progress {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
}

.carousel-progress-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--border-color);
    transition: all var(--transition-fast);
}

.carousel-progress-dot.active {
    width: 24px;
    border-radius: 3px;
    background: var(--primary);
}

/* Carousel fade edges */
.carousel-container::before,
.carousel-container::after {
    content: '';
    position: absolute;
    top: 0;
    bottom: 0;
    width: 60px;
    pointer-events: none;
    z-index: 10;
}

.carousel-container::before {
    left: 0;
    background: linear-gradient(to right, var(--background), transparent);
}

.carousel-container::after {
    right: 0;
    background: linear-gradient(to left, var(--background), transparent);
}

/* Hide fade edges on mobile */
@media (max-width: 768px) {

    .carousel-container::before,
    .carousel-container::after {
        display: none;
    }
}

/* =========================================
   CAROUSEL MODE - Toggle between Grid/Carousel
   When carousel-mode class is on root, show carousels
   ========================================= */

/* Default: Show card grids as regular grids */
.card-grid {
    display: grid;
}

/* When carousel mode is enabled, make card grids horizontal scrollable */
html.carousel-mode .card-grid,
.carousel-mode .card-grid {
    display: flex !important;
    flex-wrap: nowrap !important;
    overflow-x: auto !important;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    scroll-snap-type: x mandatory;
    gap: var(--card-gap-fluid);
    padding-bottom: var(--space-2);
    margin: 0 calc(-1 * var(--container-padding));
    padding-left: var(--container-padding);
    padding-right: var(--container-padding);
    -webkit-overflow-scrolling: touch;
}

html.carousel-mode .card-grid::-webkit-scrollbar,
.carousel-mode .card-grid::-webkit-scrollbar {
    display: none;
}

/* Make cards not shrink in carousel mode */
html.carousel-mode .card-grid>.card,
.carousel-mode .card-grid>.card {
    flex-shrink: 0;
    scroll-snap-align: start;
    width: var(--card-min-width);
    min-width: var(--card-min-width);
    max-width: var(--card-max-width);
}

/* Also handle any direct children that might not have .card class */
html.carousel-mode .card-grid>*,
.carousel-mode .card-grid>* {
    flex-shrink: 0;
    scroll-snap-align: start;
}

/* Hide carousel wrappers (we use card-grid directly) */
.carousel-wrapper {
    display: none;
}

/* Non-carousel mode: hide carousel containers */
:not(.carousel-mode) .carousel-container {
    display: none;
}

/* Carousel loading indicators */
.carousel-loading-indicator {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 60px;
    height: 100%;
    z-index: 20;
    pointer-events: none;
}

.carousel-loading-indicator.left {
    left: 0;
    background: linear-gradient(to right, var(--background), transparent);
}

.carousel-loading-indicator.right {
    right: 0;
    background: linear-gradient(to left, var(--background), transparent);
}

.carousel-loading-indicator .loading-spinner {
    width: 24px;
    height: 24px;
    border: 2px solid var(--border-color);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

/* Carousel track drag styling */
.carousel-track.dragging {
    cursor: grabbing !important;
}

.carousel-track * {
    pointer-events: none;

    /* Prevent selecting text while dragging */
}

.carousel-track:not(.dragging) * {
    pointer-events: auto;
}

@keyframes heart-beat {
    0% {
        transform: scale(1);
    }

    25% {
        transform: scale(1.2);
    }

    50% {
        transform: scale(0.95);
    }

    100% {
        transform: scale(1);
    }
}

@keyframes skeleton-loading {
    0% {
        background-position: 200% 0;
    }

    100% {
        background-position: -200% 0;
    }
}

/* ==========================================================================
   HARDWARE ACCELERATION
   Force GPU layer creation for animated elements
   ========================================================================== */

/* Elements that should always be GPU-accelerated */
.card,
.card-image-wrapper,
.modal,
.modal-content,
.sidebar,
.now-playing-bar,
.track-item,
.btn-icon,
.page,
.slide-panel,
.dropdown-menu,
.toast {
    transform: translateZ(0);
    backface-visibility: hidden;
    perspective: 1000px;
}

/* Will-change hints for interactive elements (used sparingly) */
/* Only apply will-change during active animations */
.modal.active {
    will-change: opacity, transform;
}

/* Remove will-change after animation completes */
.animation-complete {
    will-change: auto;
}

/* ==========================================================================
   REDUCED MOTION SUPPORT
   Respect user preferences for reduced motion
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {

    *,
    *::before,
    *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }

    .card:hover {
        transform: none;
    }

    .card:hover .card-image {
        transform: none;
    }

    .sidebar {
        transition: none;
    }

    /* Keep essential state changes but remove motion */
    .page.active {
        animation: none;
    }

    /* Show elements that would animate in */
    .modal.active .modal-content {
        transform: none;
        opacity: 1;
    }
}

/* Enhanced motion for users who prefer it */
@media (prefers-reduced-motion: no-preference) {
    .card:hover {
        transform: translateY(-6px) scale(1.01);
    }
}

/* Animation intensity classes (controlled by JS) */
.animations-none *,
.animations-none *::before,
.animations-none *::after {
    animation-duration: 0ms !important;
    transition-duration: 0ms !important;
}

.animations-reduced *,
.animations-reduced *::before,
.animations-reduced *::after {
    animation-duration: calc(var(--duration-normal) * 0.5) !important;
    transition-duration: calc(var(--duration-normal) * 0.5) !important;
}

.animations-enhanced .card:hover {
    transform: translateY(-10px) scale(1.02);
}

.animations-ultra .card,
.animations-ultra .now-playing-bar .cover,
.animations-ultra #vinyl-disc-container.rotating-disc {
    transform: translateZ(0);
    backface-visibility: hidden;
}

.animations-ultra .card:hover {
    transform: translate3d(0, -12px, 0) scale3d(1.025, 1.025, 1);
}

.animations-ultra .now-playing-bar .cover:not(.rotating, :hover) {
    animation: ultra-butter-wave var(--motion-wave-duration, 6s) cubic-bezier(0.22, 1, 0.36, 1) infinite;
}

.thermal-adaptive.animations-ultra .now-playing-bar .cover:not(.rotating, :hover) {
    animation-duration: calc(var(--motion-wave-duration, 6s) * 1.2);
}

@keyframes ultra-butter-wave {

    0%,
    100% {
        transform: translate3d(0, 0, 0) rotate(0deg);
    }

    25% {
        transform: translate3d(0, calc(var(--motion-wave-amplitude, 4px) * -1), 0) rotate(-0.35deg);
    }

    50% {
        transform: translate3d(0, 0, 0) rotate(0deg);
    }

    75% {
        transform: translate3d(0, var(--motion-wave-amplitude, 4px), 0) rotate(0.35deg);
    }
}

.animate-spin {
    animation: spin 1s linear infinite;
}

.content-section {
    margin-bottom: var(--spacing-2xl);
}

.section-title {
    font-size: clamp(1.5rem, 4vw, 2.25rem);
    font-weight: 700;
    margin-bottom: var(--spacing-lg);
}

.search-tabs {
    display: flex;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--border);
}

.search-tab {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    border-bottom: 2px solid transparent;

    /* Keep layout stable */
    border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    transition:
        color var(--transition-fast),
        background-color var(--transition-fast),
        transform var(--transition-fast);
    position: relative;

    /* For Pseudo-elements if needed later */
}

.search-tab:hover {
    color: var(--foreground);
    background-color: rgb(var(--highlight-rgb), 0.05);

    /* Subtle highlight */
}

.search-tab:active {
    transform: translateY(1px);
}

.search-tab.active {
    color: var(--foreground);
    border-bottom-color: var(--highlight);
}

.search-tab-content {
    display: none;
}

.search-tab-content.active {
    display: block;
    animation: fade-in-slide-up 0.4s var(--ease-out-back);

    /* Use standardized animation */
}

/* Settings Tabs */
.settings-tabs {
    display: flex;
    gap: var(--spacing-xs);
    margin-bottom: var(--spacing-lg);
    border-bottom: 1px solid var(--border);
    flex-wrap: wrap;
}

.settings-tab {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    padding: var(--spacing-sm) var(--spacing-lg);
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    border-bottom: 2px solid transparent;
    border-radius: var(--radius-sm) var(--radius-sm) 0 0;
    transition:
        color var(--transition-fast),
        background-color var(--transition-fast),
        transform var(--transition-fast);
    position: relative;
}

.settings-tab:hover {
    color: var(--foreground);
    background-color: rgb(var(--highlight-rgb), 0.05);
}

.settings-tab:active {
    transform: translateY(1px);
}

.settings-tab.active {
    color: var(--foreground);
    border-bottom-color: var(--highlight);
}

.settings-tab-content {
    display: none;
}

.settings-tab-content.active {
    display: block;
    animation: fade-in-slide-up 0.4s var(--ease-out-back);
}

/* ==========================================================================
   CONTAINER QUERIES
   Enable component-level responsiveness
   ========================================================================== */

/* Enable container queries on parent elements */
.main-content,
.page,
.card-grid,
.track-list,
.content-section {
    container-type: inline-size;
    container-name: content;
}

/* Container-based card sizing */
@container content (min-width: 600px) {
    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(var(--card-min-width), 1fr));
    }
}

@container content (max-width: 400px) {
    .card {
        padding: var(--space-2);
    }

    .card-title {
        font-size: var(--text-sm);
    }

    .card-subtitle {
        font-size: var(--text-xs);
    }
}

/* Container-based track list */
@container content (max-width: 500px) {
    .track-item {
        gap: var(--space-2);
    }

    .track-item-actions {
        display: none;
    }

    .track-item-duration {
        font-size: var(--text-xs);
    }
}

/* Container-based detail header */
@container content (max-width: 600px) {
    .detail-header {
        flex-direction: column;
        align-items: flex-start;
    }

    .detail-header .cover-container {
        margin-bottom: var(--space-4);
    }
}

/* World-Class Card Grid - Large square cards */
.card-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    gap: var(--spacing-lg);
}

/* World-Class Square Card Layout */
.card {
    display: block;
    background-color: transparent;
    padding: 0;
    border-radius: var(--radius-xl);
    transition:
        transform var(--transition-normal),
        box-shadow var(--transition-normal);
    position: relative;
    border: none;
    cursor: pointer;
    overflow: hidden;
}

.card:hover {
    transform: translateY(-8px);
    box-shadow: 0 20px 40px -12px rgb(0, 0, 0, 0.4);
}

.card:hover .card-image {
    transform: scale(1.08);
}

.card-content {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 1.5rem;
    background: linear-gradient(to top, rgb(0, 0, 0, 0.9) 0%, rgb(0, 0, 0, 0.5) 50%, transparent 100%);
    z-index: 5;
}

.card-actions {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    gap: 8px;
    z-index: 10;
}

/* World-Class Card Image - Large square */
.card-image-wrapper {
    position: relative;
    border-radius: var(--radius-xl);
    overflow: hidden;
    box-shadow: var(--shadow-xl);
    transition: box-shadow var(--transition-normal);
    aspect-ratio: 1;
    width: 100%;
}

.card:hover .card-image-wrapper {
    box-shadow: var(--shadow-xl);
}

.card-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--radius);
    transition: transform var(--transition-slow);
}

.card:hover .card-image {
    transform: scale(1.05);

    /* Subtle zoom */
}

.card-like-btn {
    position: absolute;
    right: 2%;
    top: 2%;
}

/* World-Class Card Action Buttons - Top right positioning */
.card-actions {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    gap: 8px;
    z-index: 10;
}

.card-action-btn,
.card-menu-btn,
.edit-playlist-btn {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    border: none;
    background: rgb(0, 0, 0, 0.5);
    backdrop-filter: blur(8px);
    color: white;
    opacity: 0;
    transform: scale(0.9);
}

.card:hover .card-action-btn,
.card:hover .card-menu-btn,
.card:hover .edit-playlist-btn {
    opacity: 1;
    transform: scale(1);
}

.card-action-btn:hover,
.card-menu-btn:hover,
.edit-playlist-btn:hover {
    background: rgb(0, 0, 0, 0.8);
    transform: scale(1.1);
}

/* Play Button - World-class styling */
.card-play-btn {
    width: 48px;
    height: 48px;
    background: var(--primary) !important;
    color: var(--primary-foreground) !important;
    box-shadow: 0 4px 16px rgb(0, 0, 0, 0.4);
    opacity: 0;
    transform: scale(0.9);
}

.card:hover .card-play-btn {
    opacity: 1;
    transform: scale(1);
}

.card-play-btn:hover {
    background: var(--primary) !important;
    filter: brightness(1.15);
    transform: scale(1.1);
    box-shadow: 0 6px 20px rgb(0, 0, 0, 0.5);
}

.card-play-btn svg {
    width: 20px;
    height: 20px;
    margin-left: 2px;
}

/* Card Like Button */
.card-like-btn {
    position: absolute;
    top: 12px;
    left: 12px;
    width: 36px;
    height: 36px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all var(--transition-fast);
    border: none;
    background: rgb(0, 0, 0, 0.5);
    backdrop-filter: blur(8px);
    color: white;
    opacity: 0;
    z-index: 10;
}

.card:hover .card-like-btn {
    opacity: 1;
}

.card-like-btn:hover {
    background: rgb(0, 0, 0, 0.8);
    transform: scale(1.1);
}

.card-like-btn.active {
    color: #ef4444 !important;
    opacity: 1;
}

/* Delete button - hide by default in edit modal */
.delete-playlist-btn {
    display: none;
}

.card-collage {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    overflow: hidden;
    padding: 0;
}

.card-collage img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
    margin: 0;
}

.card-collage.items-3 img:first-child {
    grid-row: span 2;
    height: 100%;
}

.card-collage.items-2 {
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr;
}

.card.artist .card-image {
    border-radius: var(--radius-full);
}

.card-image-wrapper .explicit-badge {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
}

/* World-Class Card Text Overlay */
.card-title {
    font-size: 1.1rem;
    font-weight: 700;
    color: white;
    margin: 0 0 0.25rem 0;
    line-height: 1.3;
    letter-spacing: -0.01em;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    text-shadow: 0 2px 4px rgb(0, 0, 0, 0.5);
}

.card-subtitle {
    font-size: 0.9rem;
    color: rgb(255, 255, 255, 0.8);
    margin: 0;
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    text-shadow: 0 1px 2px rgb(0, 0, 0, 0.5);
}

.heart-icon {
    transition:
        transform 0.2s ease,
        color 0.2s ease;
}

.like-btn:hover .heart-icon {
    color: #ef4444;
}

.heart-icon.filled {
    color: #ef4444;
    fill: #ef4444;
    stroke: #ef4444;
    animation: heart-beat 0.4s var(--ease-elastic);
}

.track-item:hover .like-btn {
    opacity: 1;
}

.like-btn.active .heart-icon {
    color: #ef4444;
    fill: #ef4444;
}

.explicit-badge {
    background-color: var(--secondary);
    color: var(--muted-foreground);
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.15rem 0.3rem;
    border-radius: var(--radius-xs);
    margin-left: 0.5rem;
    vertical-align: middle;
    line-height: 1;
}

.quality-hires {
    border: 1px solid var(--secondary);
    color: var(--muted-foreground);
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.15rem 0.3rem;
    border-radius: var(--radius-xs);
    margin-left: 0.5rem;
    vertical-align: middle;
    line-height: 1;
}

.quality-lossless {
    border: 1px solid var(--secondary);
    color: var(--muted-foreground);
    background-color: rgb(var(--highlight-rgb), 0.1);
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.15rem 0.3rem;
    border-radius: var(--radius-xs);
    margin-left: 0.5rem;
    vertical-align: middle;
    line-height: 1;
}

.quality-warning {
    border: 1px solid #ef4444;
    color: #ef4444;
    background-color: rgba(239, 68, 68, 0.1);
    font-size: 0.6rem;
    font-weight: 700;
    padding: 0.15rem 0.3rem;
    border-radius: var(--radius-xs);
    margin-left: 0.5rem;
    vertical-align: middle;
    line-height: 1;
}

/*  Search Suggestions Dropdown  */
.search-suggestions-list {
    position: absolute;
    top: calc(100% + 4px);
    left: 0;
    right: 0;
    background: var(--background-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    list-style: none;
    margin: 0;
    padding: 0.25rem 0;
    z-index: 3000;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.35);
    backdrop-filter: blur(8px);
    max-height: 260px;
    overflow-y: auto;
}

.suggestion-item {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.85rem;
    cursor: pointer;
    font-size: 0.875rem;
    color: var(--foreground);
    transition: background 0.15s;
}

.suggestion-item:hover {
    background: var(--background-tertiary, rgba(255, 255, 255, 0.06));
}

.suggestion-icon {
    font-size: 0.75rem;
    opacity: 0.55;
}

.suggestion-sub {
    font-size: 0.75rem;
    opacity: 0.5;
    min-width: 3rem;
}

/*  Voice Search Button  */
.voice-search-btn {
    opacity: 0.6;
    transition: opacity 0.15s, color 0.15s;
    flex-shrink: 0;
}

.voice-search-btn:hover {
    opacity: 1;
}

.voice-search-btn.listening {
    color: #ef4444;
    opacity: 1;
    animation: voice-pulse 1s ease-in-out infinite;
}

@keyframes voice-pulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.2);
    }
}

.track-list {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

#home-recommended-songs,
#artist-detail-tracks,
#playlist-detail-recommended {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(480px, 1fr));
    gap: 2px var(--spacing-xl);
}

#playlist-detail-recommended .track-item {
    grid-template-columns: 40px 1fr 32px 64px;
}

@media (max-width: 1100px) {

    #home-recommended-songs,
    #artist-detail-tracks,
    #playlist-detail-recommended {
        grid-template-columns: 1fr;
    }
}

.album-content-layout {
    display: block;
}

.album-content-layout::after {
    content: '';
    display: table;
    clear: both;
}

@media (min-width: 1200px) {
    #album-detail-tracklist {
        float: left;
        width: 55%;
        margin-right: var(--spacing-2xl);
        margin-bottom: var(--spacing-2xl);
    }

    .album-content-layout .content-section {
        /* Default flow to allow wrapping around the float */
        margin-top: 0 !important;
        margin-bottom: var(--spacing-2xl);
    }

    /* Switch to inline-block layout for flow behavior */
    .album-content-layout .content-section .card-grid {
        display: block;
        gap: 0;
    }

    .album-content-layout .content-section .card-grid .card {
        display: inline-block;
        vertical-align: top;
        width: 155px;

        /* Fixed width to ensure consistent flow */
        margin: 0 var(--spacing-md) var(--spacing-md) 0;
        white-space: normal;

        /* Reset in case inherited */
    }

    .album-content-layout .content-section .card-grid .card.compact {
        display: inline-flex;
        vertical-align: top;
        width: 220px;
        margin-right: var(--spacing-sm);
    }

    .album-content-layout .section-title {
        font-size: 1.4rem;
        margin-bottom: var(--spacing-md);
        clear: none;

        /* Allow sitting next to float */
    }
}

.track-list-header {
    display: grid;
    grid-template-columns: 40px 1fr 80px 48px;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm);
    color: var(--muted-foreground);
    font-size: 0.9rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: var(--spacing-xs);
}

.track-list-header .duration-header {
    justify-self: flex-end;
}

.is-editable .track-list-header .duration-header {
    padding-right: 1.5rem;
}

/* Track Item Standardization */
.track-item {
    display: grid;
    grid-template-columns: 40px 1fr 60px 40px;
    gap: var(--spacing-md);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-sm);
    align-items: center;
    transition:
        background-color var(--transition-fast),
        transform var(--transition-fast);
    cursor: pointer;
    border: 1px solid transparent;
}

.track-item:hover {
    background-color: var(--secondary);
    transform: scale(1.005);
}

/* Add active state for click feedback */
.track-item:active {
    transform: scale(0.99);
}

.track-item.playing {
    background-color: rgb(var(--highlight-rgb), 0.15);
    border-left: 3px solid var(--highlight);
    padding-left: calc(var(--spacing-sm) - 3px);
}

.track-item.playing .track-item-details .title {
    color: var(--highlight);
}

.track-item.unavailable {
    opacity: 0.5;
    cursor: not-allowed;
    filter: grayscale(1);
}

.track-item.unavailable .title,
.track-item.unavailable .artist,
.track-item.unavailable .track-item-duration {
    color: var(--muted-foreground);
}

.track-item.dragging {
    opacity: 0.5;
    z-index: 2000;
    pointer-events: auto;
}

.track-number {
    color: var(--muted-foreground);
    text-align: center;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    justify-content: center;
}

.track-item-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    min-width: 0;
}

.track-item-cover {
    width: 40px;
    height: 40px;
    background-color: var(--muted);
    border-radius: var(--radius-sm);
    object-fit: cover;
    flex-shrink: 0;
}

.track-item-details {
    min-width: 0;
}

.track-item-details .title {
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: flex;
    align-items: center;
}

.track-item-details .artist {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.track-item-duration {
    color: var(--muted-foreground);
    justify-self: flex-end;
    font-variant-numeric: tabular-nums;
}

.track-item-actions {
    justify-self: flex-end;
    display: flex;
    align-items: center;
    min-width: 40px;
    justify-content: flex-end;
}

.track-menu-btn {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    z-index: 10;
}

.track-item:hover .track-menu-btn {
    opacity: 1;
    padding: 0.5rem;
    margin: 0;
}

.track-menu-btn:hover {
    background-color: rgb(var(--highlight-rgb), 0.2);
    color: var(--foreground);
}

.track-action-btn.active {
    opacity: 1;
}

.track-action-btn {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;

    /* Prevent buttons from squishing */
}

.track-action-btn:hover {
    background-color: rgb(var(--highlight-rgb), 0.2);
    color: var(--foreground);
}

/* Editable Playlist Track Items (with remove button) */
.is-editable .track-list-header,
.is-editable .track-item {
    grid-template-columns: 40px 1fr 80px 90px;
}

.detail-header {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xl);
    margin-bottom: var(--spacing-lg);
    padding-bottom: var(--spacing-md);
}

.detail-header-image {
    width: 200px;
    height: 200px;
    flex-shrink: 0;
    background-color: var(--muted);
    border-radius: var(--radius);
    object-fit: cover;
    box-shadow: var(--shadow-lg);
    transition: opacity 0.3s ease-in-out;
}

.detail-header-cover-container {
    position: relative;
    flex-shrink: 0;
}

.detail-header-collage {
    width: 200px;
    height: 200px;
    flex-shrink: 0;
    background-color: var(--muted);
    border-radius: var(--radius);
    box-shadow: var(--shadow-lg);
    overflow: hidden;
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
}

.detail-header-collage img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 0;
    margin: 0;
    background-color: var(--muted);
}

.detail-header-image.loading {
    opacity: 0.3;
}

.detail-header-image.artist {
    border-radius: var(--radius-full);
}

.detail-header-info .type {
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.detail-header-info .title {
    font-size: 4rem;
    font-weight: 800;
    line-height: 1.1;
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
    overflow-wrap: break-word;
}

.detail-header-info .title.long-title {
    font-size: 2.5rem;
}

.detail-header-info .title.very-long-title {
    font-size: 1.75rem;
}

.artist-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-left: 1rem;
}

.artist-tag {
    background-color: var(--secondary);
    color: var(--muted-foreground);
    padding: 0.15rem 0.6rem;
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 500;
    text-transform: capitalize;
}

.detail-header-info .meta {
    color: var(--muted-foreground);
    margin-top: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.detail-header-info .meta a {
    color: var(--foreground);
    text-decoration: none;
    transition: color var(--transition);
}

.detail-header-info .meta a:hover {
    color: var(--highlight);
}

/* Artist Biography Styles */
.artist-bio {
    color: var(--muted-foreground);
    margin-top: 1rem;
    font-size: 0.95rem;
    line-height: 1.5;
    max-width: 600px;
    display: block;
    overflow: hidden;
    transition: color var(--transition);
}

.artist-bio:hover {
    color: var(--foreground);
}

.bio-link {
    color: var(--highlight) !important;
    text-decoration: underline !important;
    cursor: pointer !important;
    font-weight: 500 !important;
    pointer-events: auto !important;
}

.bio-link:hover {
    color: var(--primary) !important;
    text-decoration: none !important;
}

.bio-read-more {
    display: block;
    color: var(--highlight);
    text-decoration: underline;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.95rem;
    margin-top: 0.5rem;
}

.bio-read-more:hover {
    color: var(--primary);
}

/* Playlist Description Read More */
.description-read-more {
    display: inline;
    color: var(--highlight);
    text-decoration: underline;
    cursor: pointer;
    font-weight: 600;
    font-size: 0.9rem;
    margin-left: 0.25rem;
}

.description-read-more:hover {
    color: var(--primary);
}

#playlist-detail-description {
    position: relative;
    max-width: 600px;
    line-height: 1.5;
}

#playlist-detail-description.truncated {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

#playlist-detail-description.expanded {
    display: block;
    -webkit-line-clamp: unset;
}

/* Mobile Playlist Menu */
.playlist-mobile-menu {
    display: none;
    position: relative;
}

.playlist-mobile-menu-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: color-mix(in srgb, var(--card) 82%, transparent);
    border: 1px solid color-mix(in srgb, var(--border) 85%, transparent);
    color: var(--foreground);
    cursor: pointer;
    border-radius: var(--radius-full);
    transition:
        background-color var(--transition),
        transform var(--transition-fast);
}

.playlist-mobile-menu-btn:hover {
    background-color: color-mix(in srgb, var(--secondary) 82%, transparent);
    transform: translateY(-1px);
}

.playlist-mobile-menu-dropdown {
    position: absolute;
    top: calc(100% + 0.5rem);
    right: 0;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    padding: 0.5rem;
    min-width: 180px;
    box-shadow: var(--shadow-lg);
    z-index: 100;
    display: none;
}

.playlist-mobile-menu-dropdown.active {
    display: block;
}

.playlist-mobile-menu-dropdown button {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    width: 100%;
    padding: 0.75rem 1rem;
    background: transparent;
    border: none;
    color: var(--foreground);
    font-size: 0.9rem;
    cursor: pointer;
    border-radius: var(--radius-md);
    transition: background-color var(--transition-fast);
}

.playlist-mobile-menu-dropdown button:hover {
    background: var(--secondary);
}

.bio-source {
    display: block;
    margin-top: 1.5rem;
    font-size: 0.9rem;
    opacity: 0.6;
    font-style: italic;
    border-top: 1px solid var(--border);
    padding-top: 1rem;
}

.detail-header-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 1.5rem;
    flex-wrap: wrap;
    align-items: center;
}

.detail-header-actions .btn-primary,
.detail-header-actions .btn-secondary {
    width: 40px;
    height: 40px;
    padding: 0;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
}

.detail-header-actions .btn-primary span,
.detail-header-actions .btn-secondary span {
    display: none;
}

/* ==========================================================================
   MODERN ALBUM HERO - Same layout as Playlist Hero
   ========================================================================== */

.album-hero {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 2rem 1rem;
    gap: 1.5rem;
}

.album-hero-cover {
    width: 100%;
    max-width: 320px;
    aspect-ratio: 1/1;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-xl);
    position: relative;
}

.album-hero-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
}

.album-hero-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    max-width: 800px;
}

.album-hero-label {
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--muted-foreground);
    font-weight: 600;
}

.album-hero-title {
    font-size: clamp(1.75rem, 4vw, 3rem);
    font-weight: 800;
    line-height: 1.1;
    margin: 0;
    color: var(--foreground);
}

.album-hero-meta {
    font-size: 1rem;
    color: var(--muted-foreground);
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
}

.album-hero-description {
    font-size: 0.95rem;
    line-height: 1.6;
    color: var(--muted-foreground);
    max-width: 600px;
    margin-top: 0.5rem;
}

.album-hero-actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
}

.album-hero-actions .btn-group {
    display: inline-flex;
}

/* Desktop layout - side by side */
@media (min-width: 769px) {
    .album-hero {
        flex-direction: row;
        text-align: left;
        align-items: flex-end;
        padding: 2.5rem;
        gap: 2.5rem;
    }

    .album-hero-cover {
        flex-shrink: 0;
        width: 232px;
        max-width: none;
    }

    .album-hero-content {
        align-items: flex-start;
        flex: 1;
    }

    .album-hero-actions {
        justify-content: flex-start;
    }
}

/* Mobile optimizations */
@media (max-width: 768px) {
    .album-hero {
        padding: 1.5rem 1rem;
    }

    .album-hero-cover {
        max-width: 280px;
    }

    .album-hero-actions {
        gap: 0.35rem;
    }

    .album-hero-actions .btn-group-item {
        padding: 0.5rem 0.75rem;
        min-width: 40px;
        min-height: 36px;
    }

    .album-hero-actions .btn-group-item svg {
        width: 16px;
        height: 16px;
    }
}

/* ==========================================================================
   MODERN PLAYLIST HERO - Redesigned for immersive experience
   ========================================================================== */

.playlist-hero {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 2rem 1rem;
    gap: 1.5rem;
    background: linear-gradient(180deg, color-mix(in srgb, var(--card) 50%, transparent) 0%, transparent 100%);
    border-radius: var(--radius-xl);
    margin-bottom: 1.5rem;
}

.playlist-hero-cover {
    position: relative;
    width: 100%;
    max-width: 320px;
    aspect-ratio: 1;
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-2xl);
}

.playlist-hero-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--radius-lg);
}

.playlist-hero-collage {
    display: grid;
    grid-template-columns: 1fr 1fr;
    grid-template-rows: 1fr 1fr;
    width: 100%;
    height: 100%;
    gap: 4px;
    border-radius: var(--radius-lg);
    overflow: hidden;
}

.playlist-hero-collage img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.playlist-hero-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.75rem;
    max-width: 600px;
}

.playlist-hero-label {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--muted-foreground);
    opacity: 0.8;
}

.playlist-hero-title {
    font-size: clamp(2rem, 8vw, 3.5rem);
    font-weight: 800;
    line-height: 1.1;
    color: var(--foreground);
    margin: 0;
    overflow-wrap: break-word;
    word-break: break-word;
}

.playlist-hero-title.long-title {
    font-size: clamp(1.5rem, 6vw, 2.5rem);
}

.playlist-hero-title.very-long-title {
    font-size: clamp(1.25rem, 5vw, 2rem);
}

.playlist-hero-meta {
    font-size: 1rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

.playlist-hero-description {
    font-size: 1rem;
    line-height: 1.6;
    color: var(--muted-foreground);
    max-width: 500px;
    margin-top: 0.5rem;
}

.playlist-hero-description.truncated {
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.playlist-hero-actions {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
}

/* Button Groups - Gmail Style */
.btn-group {
    display: inline-flex;
    border-radius: var(--radius-lg);
    overflow: hidden;
    background: color-mix(in srgb, var(--card) 60%, transparent);
    border: 1px solid var(--border);
    box-shadow: var(--shadow-sm);
}

.btn-group-primary {
    background: var(--primary);
    border-color: transparent;
}

.btn-group-secondary {
    background: color-mix(in srgb, var(--card) 50%, transparent);
    border-color: color-mix(in srgb, var(--border) 50%, transparent);
}

.btn-group-item {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.625rem 1rem;
    background: transparent;
    color: var(--foreground);
    border: none;
    border-right: 1px solid color-mix(in srgb, var(--border) 30%, transparent);
    font-weight: 600;
    font-size: 0.9rem;
    cursor: pointer;
    transition: all var(--transition-fast);
    min-width: 44px;
    min-height: 40px;
}

.btn-group-item:last-child {
    border-right: none;
}

.btn-group-primary .btn-group-item {
    color: var(--primary-foreground);
    border-right-color: color-mix(in srgb, var(--primary-foreground) 20%, transparent);
}

.btn-group-primary .btn-group-item:hover {
    background: color-mix(in srgb, var(--primary-foreground) 15%, transparent);
}

.btn-group-secondary .btn-group-item:hover {
    background: color-mix(in srgb, var(--foreground) 8%, transparent);
}

.btn-group-item svg {
    width: 18px;
    height: 18px;
}

.btn-group-item-play {
    background: color-mix(in srgb, var(--primary-foreground) 10%, transparent);
}

.btn-group-item-play:hover {
    background: color-mix(in srgb, var(--primary-foreground) 20%, transparent) !important;
}

/* Like button active state */
.btn-group-item.like-btn.active {
    color: #ef4444;
}

.btn-group-item.like-btn.active svg {
    fill: #ef4444;
    stroke: #ef4444;
}

/* Desktop layout - side by side */
@media (min-width: 769px) {
    .playlist-hero {
        flex-direction: row;
        text-align: left;
        align-items: flex-end;
        padding: 2.5rem;
        gap: 2.5rem;
    }

    .playlist-hero-cover {
        flex-shrink: 0;
        width: 232px;
        max-width: none;
    }

    .playlist-hero-content {
        align-items: flex-start;
        flex: 1;
    }

    .playlist-hero-actions {
        justify-content: flex-start;
    }
}

/* Mobile optimizations */
@media (max-width: 768px) {
    .playlist-hero {
        padding: 1.5rem 1rem;
    }

    .playlist-hero-cover {
        max-width: 280px;
    }

    .playlist-hero-actions {
        gap: 0.5rem;
    }

    .btn-group-item {
        padding: 0.5rem 0.75rem;
        min-width: 40px;
        min-height: 36px;
    }

    .btn-group-item svg {
        width: 16px;
        height: 16px;
    }
}

.btn-primary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;

    /* Adjusted for consistency */
    background-color: var(--primary);
    color: var(--primary-foreground);
    border: none;
    border-radius: var(--radius-full);
    font-weight: 600;
    font-size: 0.95rem;
    cursor: pointer;
    transition:
        transform var(--transition-fast),
        box-shadow var(--transition-fast),
        filter var(--transition-fast);
    box-shadow: var(--shadow-sm);
    -webkit-tap-highlight-color: transparent;
    position: relative;
    overflow: hidden;
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: var(--shadow-glow);
    filter: brightness(1.1);

    /* Brighter instead of darker */
}

.btn-primary:active {
    transform: scale(0.96) translateY(0);
}

.btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
}

.btn-primary svg {
    flex-shrink: 0;
    transition: transform var(--transition-fast);
}

.btn-primary:hover svg {
    transform: scale(1.1);
}

.btn-secondary {
    padding: 0.5rem 1rem;
    background-color: var(--secondary);
    color: var(--foreground);
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    font-weight: 500;
    transition: all var(--transition);
}

.btn-secondary:hover {
    background-color: var(--muted);
    filter: brightness(1.1);
}

.btn-secondary:active {
    transform: scale(0.98);
}

.btn-secondary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-link {
    display: inline-flex;
    align-items: center;
    gap: var(--space-2);
    padding: var(--space-2) var(--space-3);
    background: transparent;
    color: var(--muted-foreground);
    border: none;
    border-radius: var(--radius-sm);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    cursor: pointer;
    transition:
        color var(--duration-fast) var(--ease-in-out),
        background-color var(--duration-fast) var(--ease-in-out);
}

.btn-link:hover {
    color: var(--highlight);
    background-color: color-mix(in srgb, var(--highlight) 10%, transparent);
}

.btn-link:active {
    transform: scale(0.97);
}

.input {
    width: 100%;
    padding: var(--space-3) var(--space-4);
    background-color: var(--secondary);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    font-size: var(--text-base);
    font-family: inherit;
    outline: none;
    transition:
        border-color var(--duration-fast) var(--ease-in-out),
        box-shadow var(--duration-fast) var(--ease-in-out);
}

.input:focus {
    border-color: var(--highlight);
    box-shadow: 0 0 0 2px rgb(var(--highlight-rgb) / 0.2);
}

.input::placeholder {
    color: var(--muted-foreground);
}

.input:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

select.input {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right var(--space-3) center;
    background-repeat: no-repeat;
    background-size: 1.25rem;
    padding-right: var(--space-10);
}

.label {
    display: block;
    font-size: var(--text-sm);
    font-weight: var(--font-semibold);
    color: var(--foreground);
    margin-bottom: var(--space-2);
}

.btn-secondary.danger {
    background: #ef4444;
    color: #fff;
}

.btn-secondary.danger:hover {
    background: #dc2626;
}

.modal-actions .btn-secondary {
    padding: 0.875rem 1.75rem;
    border-radius: var(--radius-full);
    font-weight: 600;
    font-size: 0.95rem;
}

.settings-list {
    max-width: 800px;
}

.settings-group {
    border-bottom: 1px solid var(--border);
    padding: var(--spacing-lg) 0;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.settings-group .setting-item {
    border-bottom: none;
    padding: 0;
}

.sidebar-settings-section {
    display: flex;
    flex-direction: column;
    gap: 0;
}

.sidebar-settings-section-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--muted-foreground);
    margin-bottom: 0;
}

.sidebar-settings-section .sidebar-settings-section-label+.setting-item {
    margin-top: var(--spacing-sm);
}

.sidebar-settings-section .setting-item+.setting-item {
    margin-top: var(--spacing-md);
}

.setting-item {
    display: flex;
    justify-content: space-between;
    padding: var(--spacing-lg) 0;
    border-bottom: 1px solid var(--border);
    gap: var(--spacing-lg);
}

.setting-item.sidebar-setting-item {
    align-items: center;
    gap: var(--spacing-md);
    cursor: grab;
}

.setting-item.sidebar-setting-item::before {
    content: '';
    width: 14px;
    height: 16px;
    border-radius: var(--radius-sm);
    flex-shrink: 0;
    display: inline-block;
    background-image: radial-gradient(currentcolor 1.2px, transparent 1.3px);
    background-size: 6px 6px;
    background-position: center;
    background-repeat: repeat;
    color: var(--muted-foreground);
}

.setting-item.sidebar-setting-item .info {
    flex: 1;
    min-width: 0;
}

.setting-item.sidebar-setting-item .toggle-switch {
    flex-shrink: 0;
}

.setting-item.sidebar-setting-item.dragging {
    opacity: 0.6;
    cursor: grabbing;
}

.setting-item .info {
    display: flex;
    flex-direction: column;
}

.setting-item .label {
    font-weight: 500;
}

.setting-item .description {
    font-size: 0.9rem;
    color: var(--muted-foreground);
}

.setting-item select,
.setting-item input[type='number'] {
    background-color: var(--input);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.5rem;
    appearance: auto;

    /* Force native dropdown for Tesla/Mobile */
}

.setting-item input[type='number'] {
    width: 100px;
}

.template-input {
    width: 100%;
    max-width: 400px;
    padding: 0.5rem;
    background-color: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
}

.template-input:focus {
    outline: none;
    border-color: var(--ring);
}

.font-settings-container {
    flex-direction: column;
    align-items: flex-start;
    gap: 1rem;
}

.font-settings-container .info {
    width: 100%;
}

.font-input-group {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    width: 100%;
    max-width: 500px;
}

.font-type-select {
    width: 100%;
    padding: 0.5rem;
    background-color: var(--input);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.9rem;
}

.font-section {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.font-section select {
    width: 100%;
    padding: 0.5rem;
    background-color: var(--input);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.9rem;
}

.font-input {
    width: 100%;
    padding: 0.5rem;
    background-color: var(--input);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.9rem;
}

.font-name-input {
    margin-top: 0.25rem;
}

.font-file-input {
    padding: 0.5rem;
    background-color: var(--input);
    color: var(--foreground);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.9rem;
    cursor: pointer;
}

.font-file-input::file-selector-button {
    background-color: var(--secondary);
    color: var(--secondary-foreground);
    border: none;
    border-radius: var(--radius-sm);
    padding: 0.4rem 0.8rem;
    margin-right: 0.75rem;
    cursor: pointer;
    font-size: 0.85rem;
    transition: background-color var(--transition-fast);
}

.font-file-input::file-selector-button:hover {
    background-color: var(--secondary-hover);
}

.uploaded-fonts-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.uploaded-font-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem 0.75rem;
    background-color: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    font-size: 0.9rem;
}

.uploaded-font-item .font-name {
    flex: 1;
    color: var(--foreground);
}

.uploaded-font-item .font-actions {
    display: flex;
    gap: 0.5rem;
}

/* Font Size Control */
.font-size-control {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.font-size-slider {
    appearance: none;
    width: 150px;
    height: 6px;
    background: var(--border);
    border-radius: var(--radius-full);
    outline: none;
}

.font-size-slider::-webkit-slider-thumb {
    appearance: none;
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: var(--radius-full);
    cursor: pointer;
    transition: background-color var(--transition-fast);
}

.font-size-slider::-webkit-slider-thumb:hover {
    background: var(--highlight);
}

.font-size-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: var(--primary);
    border-radius: var(--radius-full);
    cursor: pointer;
    border: none;
    transition: background-color var(--transition-fast);
}

.font-size-slider::-moz-range-thumb:hover {
    background: var(--highlight);
}

.font-size-number-input {
    width: 60px;
    padding: 0.4rem 0.5rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    text-align: center;
    transition: border-color var(--transition-fast);
}

.font-size-number-input:hover {
    border-color: var(--primary);
}

.font-size-number-input:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

/* Hide number input arrows */
.font-size-number-input::-webkit-outer-spin-button,
.font-size-number-input::-webkit-inner-spin-button {
    appearance: none;
    margin: 0;
}

.font-size-number-input[type='number'] {
    appearance: textfield;
}

.font-size-unit {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    margin-left: -0.25rem;
}

#font-size-reset {
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
}

.uploaded-font-item .btn-icon {
    padding: 0.25rem 0.5rem;
    background-color: var(--secondary);
    color: var(--secondary-foreground);
    border: none;
    border-radius: var(--radius-sm);
    font-size: 0.75rem;
    cursor: pointer;
    transition: background-color var(--transition-fast);
}

.uploaded-font-item .btn-icon:hover {
    background-color: var(--secondary-hover);
}

.uploaded-font-item .btn-delete {
    background-color: var(--destructive);
    color: var(--destructive-foreground);
}

.uploaded-font-item .btn-delete:hover {
    background-color: var(--destructive-hover);
}

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 40px;
    height: 24px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.slider {
    position: absolute;
    cursor: pointer;
    inset: 0;
    background-color: var(--secondary);
    transition: background-color var(--transition-normal);
    border-radius: var(--radius-2xl);
    box-shadow: inset 0 2px 4px rgb(0, 0, 0, 0.1);

    /* Inner shadow for depth */
}

.slider::before {
    position: absolute;
    content: '';
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: var(--foreground);
    transition: transform var(--transition-spring, 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275));

    /* Spring animation */
    border-radius: var(--radius-full);
    box-shadow: 0 2px 4px rgb(0, 0, 0, 0.2);
}

input:checked+.slider {
    background-color: var(--primary);
}

input:checked+.slider::before {
    transform: translateX(16px);
    background-color: var(--primary-foreground);
    box-shadow: -2px 2px 4px rgb(0, 0, 0, 0.1);
}

.toggle-switch:hover .slider::before {
    transform: scale(1.1);

    /* Hover scale effect */
}

.toggle-switch:hover input:checked+.slider::before {
    transform: translateX(16px) scale(1.1);
}

.toggle-switch input:disabled+.slider {
    opacity: 0.5;
    cursor: not-allowed;
}

.toggle-switch input:disabled+.slider::before {
    box-shadow: none;
    transform: translateX(0);
}

.toggle-switch input:disabled:checked+.slider::before {
    transform: translateX(16px);
}

.toggle-switch:hover input:disabled+.slider::before {
    transform: translateX(0);
}

.toggle-switch:hover input:disabled:checked+.slider::before {
    transform: translateX(16px);
}

.track-info {
    display: flex;
    align-items: center;
    gap: 1rem;
    min-width: 0;
}

.track-info .cover {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-sm);
    background-color: var(--muted);
    object-fit: cover;
    flex-shrink: 0;
}

.track-info .details {
    min-width: 0;
}

.track-info .details .title {
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    transition: color var(--transition);
}

.track-info .details .title:hover {
    color: var(--highlight);
}

.track-info .details .album {
    font-size: 0.8rem;
    color: var(--muted-foreground);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    transition: color var(--transition);
}

.track-info .details .album:hover {
    color: var(--highlight);
}

.track-info .details .artist {
    font-size: 0.8rem;
    color: var(--muted-foreground);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    cursor: pointer;
    transition:
        color var(--transition-fast),
        transform var(--transition-fast);
    display: block;
    max-width: 100%;
}

.track-info .details .artist:hover {
    color: var(--highlight);
    transform: translateX(2px);
}

.player-controls {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm);
}

.player-controls.waveform-loaded {
    gap: 0.1rem;
    margin-bottom: 0.3rem;
}

.player-controls .buttons {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
}

.player-controls .buttons button {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    transition:
        transform var(--transition-fast),
        color var(--transition-fast),
        background-color var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border-radius: var(--radius-full);
    position: relative;
    -webkit-tap-highlight-color: transparent;
}

.player-controls .buttons button:hover {
    transform: scale(1.1);

    /* Pop effect */
}

.player-controls .buttons button:active {
    transform: scale(0.9);
    color: var(--foreground);
    background-color: var(--secondary);
}

@media (hover: hover) {
    .player-controls .buttons button:hover {
        color: var(--foreground);
        background-color: var(--secondary);
    }
}

.player-controls .buttons button.active {
    color: var(--active-highlight);
}

.player-controls .buttons button#repeat-btn.repeat-one::after {
    content: '1';
    position: absolute;
    font-size: 0.5rem;
    font-weight: bold;
}

.player-controls .buttons .play-pause-btn {
    background-color: var(--primary);
    color: var(--primary-foreground);
    width: 36px;
    height: 36px;
}

@media (hover: hover) {
    .player-controls .buttons .play-pause-btn:hover {
        transform: scale(1.05);
        background-color: var(--primary);
        color: var(--primary-foreground);
    }
}

.player-controls .buttons .play-pause-btn:active {
    transform: scale(0.95);
    background-color: var(--primary);
    color: var(--primary-foreground);
}

.player-controls .progress-container {
    width: 100%;
    max-width: 500px;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.8rem;
    color: var(--muted-foreground);
    order: -1;
}

.player-controls .progress-container span {
    min-width: 40px;
    font-variant-numeric: tabular-nums;
    flex-shrink: 0;
}

#current-time {
    text-align: right;
}

.progress-bar,
.volume-bar {
    position: relative;
    cursor: pointer;
    user-select: none;
    touch-action: none;
}

.progress-bar {
    flex-grow: 1;
    height: 6px;
    background-color: var(--secondary);
    border-radius: var(--radius-xs);
}

.progress-bar:hover {
    height: 8px;
}

.progress-bar .progress-fill {
    width: 0;
    height: 100%;
    background-color: var(--muted-foreground);
    border-radius: var(--radius-xs);
    transition: background-color 0.2s ease;
    position: relative;
    pointer-events: none;
}

.progress-bar:hover .progress-fill {
    background-color: var(--highlight);
}

.progress-bar:hover .progress-fill::after,
.progress-bar:active .progress-fill::after {
    content: '';
    position: absolute;
    right: -6px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    background-color: var(--highlight);
    border-radius: var(--radius-full);
    box-shadow: 0 2px 4px rgb(0, 0, 0, 0.3);
}

.progress-bar.has-waveform.waveform-loaded {
    height: 28px;
}

.progress-bar.has-waveform.waveform-loaded .progress-fill {
    background-color: var(--primary);
}

.progress-bar.has-waveform.waveform-loaded .progress-fill::after {
    display: none;
}

#waveform-canvas {
    display: none;
}

.volume-controls {
    display: flex;
    justify-content: center !important;
    align-items: flex-end !important;
    gap: 0.5rem !important;
    flex-direction: column !important;
    overflow: hidden;
}

.volume-controls button {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    transition: all var(--transition);
    padding: 0.25rem;
    width: 28px;
    height: 28px;
    border-radius: var(--radius);
    display: flex;
    align-items: center;
    justify-content: center;
}

@media (hover: hover) {
    .volume-controls button:hover {
        color: var(--foreground);
        background-color: var(--secondary);
    }
}

.volume-controls button:active {
    color: var(--foreground);
    background-color: var(--secondary);
}

.volume-controls .volume-bar {
    width: 100px;
    height: 4px;
    background-color: var(--secondary);
    border-radius: var(--radius-xs);
}

.volume-controls .volume-bar:hover {
    height: 6px;
}

.volume-controls .volume-bar .volume-fill {
    width: var(--volume-level, 70%);
    height: 100%;
    background-color: var(--muted-foreground);
    border-radius: var(--radius-xs);
    transition: background-color 0.2s ease;
    position: relative;
    pointer-events: none;
}

.volume-controls .volume-bar:hover .volume-fill {
    background-color: var(--highlight);
}

.volume-controls .volume-bar:hover .volume-fill::after,
.volume-controls .volume-bar:active .volume-fill::after {
    content: '';
    position: absolute;
    right: -6px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    background-color: var(--highlight);
    border-radius: var(--radius-full);
    box-shadow: 0 2px 4px rgb(0, 0, 0, 0.3);
}

/* Sleep Timer Button */
#sleep-timer-btn {
    position: relative;
    font-size: 0.8rem;
    font-weight: bold;
    transition: all var(--transition);
}

#sleep-timer-btn:hover {
    color: var(--highlight);
}

#sleep-timer-btn.active {
    color: var(--primary);
    text-shadow: 0 0 8px rgb(var(--highlight-rgb), 0.5);
}

#sleep-timer-btn svg {
    width: 20px;
    height: 20px;
}

#sleep-timer-btn span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    pointer-events: none;
}

#context-menu,
#sort-menu {
    display: none;
    position: fixed;
    background-color: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.5rem;
    box-shadow: var(--shadow-lg);
    z-index: 3000;
    min-width: 160px;
    transform-origin: top left;
    animation: scale-in var(--transition-fast) var(--ease-out-back);
}

#context-menu ul,
#sort-menu ul {
    list-style: none;
}

#context-menu li,
#sort-menu li {
    padding: 0.5rem 0.75rem;
    margin-right: 8px;
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition:
        background-color var(--transition-fast),
        transform var(--transition-fast);

    /* Add transform */
    font-size: 0.9rem;
    display: flex;

    /* Ensure spacing if icons are added */
    align-items: center;
}

#sort-menu li.sort-active {
    font-weight: bold;
}

#context-menu li:hover,
#sort-menu li:hover {
    background-color: var(--secondary);
    transform: translateX(4px);

    /* Slide interaction */
    color: var(--foreground);
}

#context-menu li.separator {
    height: 1px;
    background-color: var(--border);
    margin: 0.5rem 0;
    padding: 0;
    cursor: default;
    pointer-events: none;
}

#context-menu li.separator:hover {
    background-color: var(--border);
    transform: none;
}

.blocked-items-list {
    list-style: none;
    max-height: 300px;
    overflow-y: auto;
}

.blocked-items-list li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0.75rem;
    background: var(--accent);
    border-radius: var(--radius-sm);
    margin-bottom: 0.25rem;
}

.blocked-items-list li:hover {
    background: var(--secondary);
}

.blocked-items-list .item-info {
    flex: 1;
    min-width: 0;
}

.blocked-items-list .item-name {
    font-weight: 500;
    font-size: 0.9rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.blocked-items-list .item-meta {
    font-size: 0.75rem;
    color: var(--muted-foreground);
}

.blocked-items-list .unblock-btn {
    background: transparent;
    border: none;
    color: var(--primary);
    cursor: pointer;
    padding: 0.25rem 0.5rem;
    font-size: 0.8rem;
    border-radius: var(--radius-sm);
}

.blocked-items-list .unblock-btn:hover {
    background: var(--secondary);
}

/* Blocked content styling */
.track-item.blocked {
    opacity: 0.4;
    pointer-events: none;
    filter: grayscale(100%);
}

.track-item.blocked .track-item-info {
    text-decoration: line-through;
}

.track-item.blocked .track-menu-btn {
    pointer-events: auto;
    opacity: 1;
}

.card.blocked {
    opacity: 0.4;
    pointer-events: none;
    filter: grayscale(100%);
}

.card.blocked .card-menu-btn {
    pointer-events: auto;
    opacity: 1;
}

.card.blocked .card-title,
.card.blocked .card-subtitle {
    text-decoration: line-through;
}

.queue-track-item.blocked {
    opacity: 0.4;
    filter: grayscale(100%);
}

.queue-track-item.blocked .track-item-details {
    text-decoration: line-through;
}

#queue-modal-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background-color: rgb(0, 0, 0, 0.7);
    backdrop-filter: blur(2px);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    animation: fade-in 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

#fullscreen-cover-overlay {
    position: fixed;
    inset: 0;
    z-index: 2000;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background-color: var(--background);

    /* Use a CSS variable for the image so we can set it in JS */
    --bg-image: none;

    padding-bottom: 0;

    /* Animated entrance */
    animation: fs-slide-up 0.42s cubic-bezier(0.22, 0.61, 0.36, 1) both;
}

@keyframes fs-slide-up {
    from {
        transform: translateY(4vh);
        opacity: 0;
    }

    to {
        transform: translateY(0);
        opacity: 1;
    }
}

/* Animated gradient mesh  the key visual upgrade */
#fullscreen-cover-overlay::before {
    content: '';
    position: absolute;
    inset: -30px;
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    /* Deep blur for that pro immersive look */
    filter: blur(80px) saturate(1.6) brightness(0.45);
    transform: scale(1.12);
    z-index: -2;
    background-image: var(--bg-image);
    transition: background-image 0.6s ease;
}

/* Gradient mesh overlay for colour gradients */
#fullscreen-cover-overlay::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: -1;
    background:
        radial-gradient(ellipse 80% 60% at 15% 110%, rgba(var(--palette-rgb, 99, 102, 241), 0.28) 0%, transparent 60%),
        radial-gradient(ellipse 60% 50% at 85% -10%, rgba(var(--palette-rgb, 99, 102, 241), 0.18) 0%, transparent 55%),
        linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 0%, rgba(0, 0, 0, 0.55) 100%);
    pointer-events: none;
}

#visualizer-canvas {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    z-index: 0;
    pointer-events: none;
}

.fullscreen-cover-content {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
    position: relative;
    padding: 1rem;
}

#close-fullscreen-cover-btn {
    position: absolute;
    top: 1rem;
    right: 1rem;
    background-color: var(--background);
    border: none;
    color: var(--foreground);
    font-size: 2rem;
    width: 48px;
    height: 48px;
    border-radius: var(--radius-full);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        opacity 0.2s,
        right 0.3s ease;
    z-index: 10;
    opacity: 0.5;
}

#close-fullscreen-cover-btn:hover {
    opacity: 0.8;
}

#fullscreen-cover-image {
    max-width: 55vw;
    max-height: 45vh;
    border-radius: var(--radius);
    box-shadow: 0 20px 50px rgb(0, 0, 0, 0.5);
    object-fit: contain;
    margin-bottom: 1rem;
    z-index: 1;
    transition: border-radius 0.3s ease;
}

/* Vinyl disc container - default state (no disc) */
#vinyl-disc-container {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1;
    margin-bottom: var(--space-4);
    transition: all var(--duration-normal) var(--ease-in-out);
}

#vinyl-disc-container.disc-scrub-enabled {
    touch-action: none;
    cursor: grab;
    user-select: none;
}

#vinyl-disc-container.disc-scrub-enabled.disc-scrubbing {
    cursor: grabbing;
    transition: none;
}

#vinyl-disc-container.disc-scrub-enabled #fullscreen-cover-image {
    user-select: none;
    -webkit-user-drag: none;
}

#vinyl-disc-container.disc-scrubbing,
#vinyl-disc-container.disc-scrubbing::before {
    animation-play-state: paused !important;
}

/* Fullscreen rotating disc effect - vinyl record */
#vinyl-disc-container.rotating-disc {
    width: var(--vinyl-disc-size, min(48vh, 48vw));
    height: var(--vinyl-disc-size, min(48vh, 48vw));
    border-radius: var(--radius-full);
    background:
        radial-gradient(circle at center,
            transparent 0 53%,
            rgb(255, 255, 255, 0.035) 60%,
            rgb(0, 0, 0, 0.18) 78%,
            rgb(0, 0, 0, 0.52) 100%),
        repeating-radial-gradient(circle at center,
            rgb(7, 7, 7, 0.95) 0,
            rgb(7, 7, 7, 0.95) 1px,
            rgb(17, 17, 17, 0.95) 2px,
            rgb(9, 9, 9, 0.95) 3px),
        linear-gradient(180deg, #111 0%, #060606 100%);
    box-shadow:
        0 24px 60px rgb(0, 0, 0, 0.74),
        inset 0 0 0 1px rgb(255, 255, 255, 0.1),
        inset 0 0 18px rgb(0, 0, 0, 0.86);
    animation: rotate-disc-fullscreen 4s linear infinite;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Light reflections (anisotropic highlights) on the vinyl */
#vinyl-disc-container.rotating-disc::before {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: var(--radius-full);
    background:
        conic-gradient(from 12deg at 50% 50%,
            rgb(255, 255, 255, 0) 0deg,
            rgb(255, 255, 255, 0.06) 18deg,
            rgb(255, 255, 255, 0.3) 33deg,
            rgb(255, 255, 255, 0.08) 45deg,
            rgb(255, 255, 255, 0) 62deg,
            rgb(255, 255, 255, 0) 185deg,
            rgb(255, 255, 255, 0.08) 204deg,
            rgb(255, 255, 255, 0.24) 216deg,
            rgb(255, 255, 255, 0.05) 232deg,
            rgb(255, 255, 255, 0) 250deg,
            rgb(255, 255, 255, 0) 360deg),
        radial-gradient(circle at center, transparent 0 57%, rgb(0, 0, 0, 0.24) 80%, transparent 100%);
    mix-blend-mode: screen;
    pointer-events: none;
    z-index: 2;
    animation: rotate-disc-fullscreen 4s linear infinite reverse;
}

#vinyl-disc-container.rotating-disc.paused::before {
    animation-play-state: paused;
}

/* The spindle hole in the very center */
#vinyl-disc-container.rotating-disc::after {
    content: '';
    position: absolute;
    width: 1.15%;
    height: 1.15%;
    border-radius: var(--radius-full);
    background: radial-gradient(circle,
            rgb(255, 255, 255, 0.88) 0%,
            rgb(200, 200, 200, 0.62) 56%,
            rgb(120, 120, 120, 0.44) 100%);
    box-shadow:
        0 0 0 1px rgb(255, 255, 255, 0.25),
        0 0 4px rgb(0, 0, 0, 0.45);
    z-index: 3;
    pointer-events: none;
}

/* Album art inside vinyl disc - becomes the label */
#vinyl-disc-container.rotating-disc #fullscreen-cover-image {
    width: 34%;
    height: 34%;
    max-width: none;
    max-height: none;
    border-radius: var(--radius-full);
    box-shadow:
        0 0 0 5px rgb(15, 15, 15, 0.95),
        0 0 0 6px rgb(220, 220, 220, 0.14),
        0 0 20px rgb(0, 0, 0, 0.9),
        inset 0 0 15px rgb(0, 0, 0, 0.4);
    object-fit: cover;
    z-index: 1;
    margin-bottom: 0;
    position: absolute;
}

#vinyl-disc-container.rotating-disc.paused {
    animation-play-state: paused;
}

@keyframes rotate-disc-fullscreen {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

.fullscreen-track-info {
    text-align: center;
    z-index: 1;
    max-width: 90%;
    background-color: color-mix(in srgb, var(--card) 40%, transparent);
    backdrop-filter: blur(8px);
    padding: 0.75rem 1.5rem;
    border-radius: var(--radius);
    border: 1px solid var(--border);
    box-shadow: 0 8px 32px rgb(0, 0, 0, 0.4);
}

#fullscreen-track-title {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 0.5rem;
    color: var(--foreground);
    overflow-wrap: break-word;
}

#fullscreen-track-artist {
    font-size: 1.25rem;
    color: color-mix(in srgb, var(--foreground), transparent 40%);
    font-weight: 500;
    transition:
        color 0.2s,
        text-decoration 0.2s;
}

#fullscreen-track-artist:hover {
    color: var(--primary);
    text-decoration: underline;
    cursor: pointer;
}

#fullscreen-next-track {
    margin-top: 1rem;
    font-size: 0.9rem;
    color: color-mix(in srgb, var(--foreground), transparent 40%);
    display: flex;
    flex-direction: column;
    gap: 0.2rem;
    opacity: 0;

    /* Initially hidden for animation */
}

#fullscreen-next-track.animate-in {
    animation: fade-in 0.5s ease 0.2s forwards;

    /* Added forwards to keep opacity 1 */
}

#fullscreen-next-track .label {
    text-transform: uppercase;
    letter-spacing: 0.05em;
    font-size: 0.75rem;
    opacity: 0.8;
}

#fullscreen-next-track .value {
    font-weight: 500;
    color: var(--foreground);
}

.fullscreen-controls {
    width: 100%;
    max-width: 600px;
    margin-top: 1rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    z-index: 10;
}

.fullscreen-progress-container {
    display: flex;
    align-items: center;
    gap: 1rem;
    width: 100%;
    color: var(--foreground);
    font-size: 0.9rem;
    font-variant-numeric: tabular-nums;
}

.fullscreen-progress-container .progress-bar {
    flex: 1;
    height: 6px;
    background: rgb(255, 255, 255, 0.2);
    border-radius: var(--radius-xs);
    cursor: pointer;
    position: relative;
    transition: height 0.2s ease;
}

.fullscreen-progress-container .progress-bar:hover {
    height: 8px;
}

.fullscreen-progress-container .progress-fill {
    height: 100%;
    background: var(--foreground);
    border-radius: var(--radius-xs);
    width: 0%;
    transition: width 0.1s ease;
    position: relative;
    pointer-events: none;
}

.fullscreen-progress-container .progress-bar:hover .progress-fill {
    background: var(--highlight);
}

.fullscreen-progress-container .progress-bar:hover .progress-fill::after,
.fullscreen-progress-container .progress-bar:active .progress-fill::after {
    content: '';
    position: absolute;
    right: -6px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    background-color: var(--highlight);
    border-radius: var(--radius-full);
    box-shadow: 0 2px 4px rgb(0, 0, 0, 0.3);
}

.fullscreen-buttons {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 2rem;
}

.fullscreen-buttons button {
    background: transparent;
    border: none;
    color: var(--foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        transform var(--transition-fast),
        background-color var(--transition-fast);
}

.fullscreen-buttons button:hover {
    background: rgb(255, 255, 255, 0.1);
    transform: scale(1.15) rotate(0deg);

    /* Slight rotation on some icons could be cool, but sticking to scale */
}

.fullscreen-buttons button:active {
    transform: scale(0.95);
}

.fullscreen-buttons #fs-play-pause-btn {
    width: 64px;
    height: 64px;
    background: var(--foreground);
    color: var(--background);
    border-radius: var(--radius-full);
}

.fullscreen-buttons #fs-play-pause-btn:hover {
    transform: scale(1.05);
    background: var(--foreground);
}

.fullscreen-buttons button.active {
    color: var(--primary);
}

.fullscreen-volume-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    margin-top: 1rem;
}

.fs-volume-btn {
    background: transparent;
    border: none;
    color: var(--foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius-full);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
    width: 40px;
    height: 40px;
}

.fs-volume-btn:hover {
    background: rgb(255, 255, 255, 0.1);
    transform: scale(1.1);
}

.fs-volume-btn.muted {
    color: var(--muted-foreground);
}

.fs-volume-bar {
    width: 150px;
    height: 6px;
    background-color: rgb(255, 255, 255, 0.2);
    border-radius: var(--radius-xs);
    cursor: pointer;
    position: relative;
    transition: height 0.2s ease;
}

.fs-volume-bar:hover {
    height: 8px;
}

.fs-volume-fill {
    height: 100%;
    background-color: var(--foreground);
    border-radius: var(--radius-xs);
    width: var(--fs-volume-level, 70%);
    transition: width 0.1s ease;
    position: relative;
    pointer-events: none;
}

.fs-volume-bar:hover .fs-volume-fill {
    background-color: var(--highlight);
}

.fs-volume-bar:hover .fs-volume-fill::after,
.fs-volume-bar:active .fs-volume-fill::after {
    content: '';
    position: absolute;
    right: -6px;
    top: 50%;
    transform: translateY(-50%);
    width: 12px;
    height: 12px;
    background-color: var(--highlight);
    border-radius: var(--radius-full);
    box-shadow: 0 2px 4px rgb(0, 0, 0, 0.3);
}

@media (max-width: 768px) {
    .fullscreen-volume-container {
        gap: 0.75rem;
    }

    .fs-volume-bar {
        width: 120px;
    }
}

.fullscreen-actions {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 0.75rem;
}

#queue-modal {
    background-color: var(--card);
    width: 90%;
    max-width: 500px;
    max-height: 80vh;
    border-radius: var(--radius);
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow-xl);
    animation: scale-in 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

#queue-modal-header {
    padding: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid var(--border);
}

#queue-modal-header h3 {
    margin: 0;
}

#queue-modal-header #close-queue-btn {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    font-size: 1.5rem;
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    transition: all var(--transition);
}

#queue-modal-header #clear-queue-btn {
    background-color: transparent;
}

#queue-modal-header #clear-queue-btn:hover,
#queue-modal-header #close-queue-btn:hover {
    background-color: var(--secondary);
    color: var(--foreground);
}

#queue-list {
    overflow-y: auto;
    padding: 0.5rem;
}

.queue-track-item {
    display: grid;
    grid-template-columns: 32px 1fr auto auto auto;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm);
    border-radius: var(--radius);
    cursor: grab;
    transition: all var(--transition);
    margin-bottom: 2px;
}

.queue-track-item .queue-like-btn {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.2;
}

.queue-track-item:hover .queue-like-btn {
    opacity: 1;
}

.queue-track-item .queue-like-btn:hover {
    background-color: rgb(var(--highlight-rgb), 0.2);
    color: var(--foreground);
}

.queue-track-item .queue-like-btn.active {
    color: #ef4444;
}

.queue-track-item .queue-like-btn.active svg {
    fill: #ef4444;
    color: #ef4444;
}

.queue-track-item:active {
    cursor: grabbing;
}

.queue-track-item:hover {
    background-color: var(--secondary);
}

.queue-track-item.playing {
    background-color: rgb(var(--highlight-rgb), 0.15);
    border-left: 3px solid var(--highlight);
    padding-left: calc(var(--spacing-sm) - 3px);
}

.queue-track-item .drag-handle {
    color: var(--muted-foreground);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: grab;
}

.queue-track-item .queue-remove-btn {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    color: var(--foreground);
    justify-content: center;
    flex-shrink: 0;
    opacity: 0.2;
}

.queue-track-item:hover .queue-remove-btn {
    opacity: 1;
}

.queue-track-item .queue-remove-btn:hover {
    background-color: var(--background);
    color: var(--foreground);
}

.queue-track-item .queue-remove-btn svg {
    width: 20px;
    height: 20px;
}

.placeholder-text {
    padding: 2rem 1rem;
    color: var(--muted-foreground);
}

.placeholder-text.loading {
    animation: pulse 1.5s infinite ease-in-out;
}

.skeleton {
    background: linear-gradient(90deg, var(--secondary) 0%, var(--muted) 50%, var(--secondary) 100%);
    background-size: 200% 100%;
    animation: skeleton-loading 2s infinite ease-in-out;

    /* Slower, smoother pulse */
    border-radius: var(--radius);
}

.skeleton-track {
    display: grid;
    grid-template-columns: 40px 1fr 60px 40px;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm) var(--spacing-md);
}

.skeleton-track-number {
    width: 24px;
    height: 20px;
    margin: 0 auto;
}

.skeleton-track-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    min-width: 0;
}

.skeleton-track-cover {
    width: 40px;
    height: 40px;
    flex-shrink: 0;
    border-radius: var(--radius-sm);
}

.skeleton-track-details {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}

.skeleton-track-title {
    height: 16px;
    width: 60%;
    max-width: 200px;
}

.skeleton-track-artist {
    height: 14px;
    width: 40%;
    max-width: 150px;
}

.skeleton-track-duration {
    width: 40px;
    height: 14px;
}

.skeleton-track-actions {
    width: 24px;
    height: 24px;
    justify-self: flex-end;
}

.skeleton-card {
    background-color: var(--card);
    border-radius: var(--radius);
    padding: var(--spacing-md);
}

.skeleton-card-image {
    width: 100%;
    aspect-ratio: 1/1;
    margin-bottom: var(--spacing-md);
    border-radius: calc(var(--radius) - 4px);
}

.skeleton-card.artist .skeleton-card-image {
    border-radius: var(--radius-full);
}

.skeleton-card-title {
    height: 18px;
    width: 80%;
    margin-bottom: var(--spacing-xs);
}

.skeleton-card-subtitle {
    height: 14px;
    width: 60%;
}

.skeleton-container {
    width: 100%;
}

/* Skeleton grids for recommended sections */
#home-recommended-albums .skeleton-container,
#home-recommended-artists .skeleton-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(165px, 1fr));
    gap: var(--spacing-md);
}

#home-recommended-songs .skeleton-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(480px, 1fr));
    gap: 2px var(--spacing-xl);
}

@media (max-width: 1100px) {
    #home-recommended-songs .skeleton-container {
        grid-template-columns: 1fr;
    }
}

#api-instance-list {
    list-style: none;
    margin-bottom: 1rem;
}

#api-instance-list li {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    background-color: var(--secondary);
    border-radius: var(--radius);
    margin-bottom: 0.5rem;
}

#api-instance-list li .instance-url {
    flex-grow: 1;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    font-size: 0.9rem;
}

#api-instance-list li .controls {
    display: flex;
    gap: 0.5rem;
}

#api-instance-list li button {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    padding: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-sm);
    transition:
        transform var(--transition-fast),
        color var(--transition-fast),
        background-color var(--transition-fast);
}

#api-instance-list li button:hover {
    color: var(--foreground);
    background-color: var(--muted);
    transform: scale(1.15);
}

#api-instance-list li button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}

.theme-picker {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.theme-option {
    padding: 1rem;
    border: 2px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
    transition: all var(--transition);
    text-align: center;
    font-weight: 500;
}

.theme-option:hover {
    border-color: var(--highlight);
    background-color: var(--secondary);
}

.theme-option.active {
    border-color: var(--primary);
    background-color: var(--primary);
    color: var(--primary-foreground);
}

.custom-theme-editor {
    margin-top: 1rem;
    padding: 1rem;
    background-color: var(--secondary);
    border-radius: var(--radius);
    display: none;
}

.custom-theme-editor.show {
    display: block;
}

.theme-color-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 1rem;
    margin-top: 1rem;
}

.theme-color-input {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.theme-color-input label {
    font-size: 0.9rem;
    color: var(--muted-foreground);
}

.theme-color-input input[type='color'] {
    width: 100%;
    height: 40px;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    cursor: pointer;
}

.theme-actions {
    display: flex;
    gap: 1rem;
    margin-top: 1rem;
}

.about-content {
    padding: 1rem 0;
}

.about-description {
    color: var(--foreground);
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.about-features,
.about-tech {
    margin-bottom: 1.5rem;
}

.about-features h4,
.about-tech h4 {
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: var(--foreground);
}

.about-features ul {
    list-style: none;
    padding: 0;
}

.about-features li {
    padding: 0.5rem 0 0.5rem 1.5rem;
    position: relative;
    color: var(--foreground);
    line-height: 1.5;
}

.about-features li::before {
    content: '';
    position: absolute;
    left: 0;
    color: var(--highlight);
    font-weight: bold;
    transition: transform var(--transition-spring);
}

.about-features li:hover::before {
    transform: scale(1.3) rotate(15deg);
}

.about-features li:hover {
    color: var(--highlight);
    transform: translateX(4px);
    transition:
        transform var(--transition-fast),
        color var(--transition-fast);
}

.about-tech p {
    color: var(--muted-foreground);
    font-size: 0.9rem;
}

.about-links {
    display: flex;
    gap: 1rem;
    margin: 1.5rem 0;
    flex-wrap: wrap;
}

.github-link {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.25rem;
    background-color: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-weight: 500;
    transition: all var(--transition);
}

.github-link:hover {
    background-color: var(--secondary);
    border-color: var(--highlight);
    transform: translateY(-2px);
}

.github-link svg {
    flex-shrink: 0;
}

.about-footer {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--border);
}

.about-footer p {
    margin: 0.5rem 0;
    font-size: 0.9rem;
}

.about-footer .version {
    color: var(--foreground);
    font-weight: 600;
}

.about-footer .license {
    color: var(--muted-foreground);
}

.about-footer .disclaimer {
    color: var(--muted-foreground);
    font-size: 0.8rem;
    font-style: italic;
    margin-top: 1rem;
    padding: 0.75rem;
    background-color: var(--secondary);
    border-radius: var(--radius);
    border-left: 3px solid var(--muted-foreground);
}

#download-notifications {
    position: fixed;
    bottom: 120px;
    right: 20px;
    z-index: 9999;
    max-width: 350px;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.download-task {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1rem;
    box-shadow: var(--shadow-lg);
    animation: slide-in 0.3s ease;
    min-width: 300px;
}

.download-cancel:hover {
    background: var(--secondary) !important;
    color: var(--foreground) !important;
}

#lastfm-controls {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.desktop-only {
    display: flex;
}

#cast-btn {
    position: relative;
}

#cast-btn.available {
    color: var(--highlight);
}

#cast-btn.available::before {
    content: '';
    position: absolute;
    top: 6px;
    right: 6px;
    width: 6px;
    height: 6px;
    background-color: var(--highlight);
    border-radius: var(--radius-full);
    animation: pulse 2s infinite;
}

#cast-btn.connected {
    color: #10b981;
}

#cast-btn.connected::after {
    content: '';
    position: absolute;
    top: 6px;
    right: 6px;
    width: 8px;
    height: 8px;
    background-color: #10b981;
    border-radius: var(--radius-full);
}

#download-current-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.template-guide {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
    font-size: 0.9rem;
}

.template-guide th,
.template-guide td {
    padding: 0.75rem;
    text-align: left;
    border-bottom: 1px solid var(--border);
}

.template-guide th {
    font-weight: 600;
    background-color: var(--secondary);
}

.template-guide code {
    background-color: var(--secondary);
    padding: 0.2rem 0.4rem;
    border-radius: var(--radius-sm);
    font-size: 0.85em;
}

.offline-notification,
.update-notification {
    position: fixed;
    bottom: 130px;
    right: 20px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1rem;
    box-shadow: var(--shadow-lg);
    z-index: 10000;
    display: flex;
    align-items: center;
    gap: 1rem;
    max-width: 350px;
    animation: slide-in 0.3s ease;
}

.offline-notification svg {
    flex-shrink: 0;
    color: #f59e0b;
}

.update-notification {
    flex-direction: column;
    align-items: stretch;
}

.update-notification-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.75rem;
}

.update-notification-actions .btn-icon {
    background: transparent;
    border: 1px solid var(--border);
    color: var(--muted-foreground);
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    cursor: pointer;
    transition: all var(--transition);
    flex-shrink: 0;
}

.update-notification-actions .btn-icon:hover {
    background: var(--secondary);
    color: var(--foreground);
    border-color: var(--foreground);
}

.close-shortcuts {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    font-size: 1.5rem;
    cursor: pointer;
    width: 32px;
    height: 32px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    transition: all var(--transition);
}

.close-shortcuts:hover {
    background: var(--secondary);
    color: var(--foreground);
}

.shortcuts-content {
    padding: 1rem;
}

.shortcut-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.75rem 0;
    border-bottom: 1px solid var(--border);
}

.shortcut-item:last-child {
    border-bottom: none;
}

#playlist-detail-description,
#mix-detail-description {
    color: var(--foreground);
    font-size: 0.9rem;
}

#playlist-detail-tracklist {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

#playlist-detail-tracklist .track-list-header {
    display: grid;
    grid-template-columns: 40px 1fr 80px 48px;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-sm);
    color: var(--muted-foreground);
    font-size: 0.9rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: var(--spacing-xs);
}

#playlist-detail-tracklist .track-list-header .duration-header {
    justify-self: flex-end;
}

/* Responsive Design */

@supports (padding-top: env(safe-area-inset-top)) {
    .now-playing-bar {
        padding-bottom: max(var(--spacing-sm), env(safe-area-inset-bottom));
    }

    .main-content,
    .sidebar {
        padding-top: max(var(--spacing-md), env(safe-area-inset-top));
    }
}

/* Side Panels (Lyrics & Queue) */
.side-panel {
    position: fixed;
    right: 0;
    top: 0;
    bottom: 0;
    width: var(--side-panel-width, 600px);

    /* Use CSS variable with fallback */
    max-width: 80vw;
    min-width: 300px;
    background: var(--card);
    border-left: 1px solid var(--border);
    z-index: 2050;
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition:
        transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
        box-shadow 0.3s ease;
    box-shadow: none;
}

.side-panel.resizing {
    transition: none !important;

    /* Disable transitions during live drag */
}

/* Drag-to-resize handle */
.panel-resizer {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 6px;
    cursor: ew-resize;
    z-index: 2060;
    background: transparent;
    transition: background-color 0.2s ease;
}

.panel-resizer:hover,
.panel-resizer.active {
    background-color: var(--primary);
    opacity: 0.5;
}

.side-panel.active {
    transform: translateX(0);
    box-shadow: var(--shadow-xl);
}

.side-panel[data-view='lyrics'],
.side-panel[data-view='queue'] {
    background: color-mix(in srgb, var(--card) 60%, transparent);
    backdrop-filter: blur(10px);
    border-left: 1px solid rgb(255, 255, 255, 0.1);
}

.panel-header {
    padding: 1rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.panel-header h3 {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 600;
}

.panel-controls {
    display: flex;
    gap: 0.5rem;
}

/* Lyrics timing adjustment controls */
.lyrics-timing-controls {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-right: auto;
    padding-right: 0.5rem;
    border-right: 1px solid var(--border);
}

.lyrics-timing-display {
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--foreground);
    min-width: 3.5rem;
    text-align: center;
    user-select: none;
    cursor: default;
}

.lyrics-timing-controls .btn-icon {
    padding: 0.4rem;
    width: 28px;
    height: 28px;
}

.lyrics-timing-controls .btn-icon:hover {
    background: var(--secondary);
    color: var(--primary);
}

.panel-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
    padding-bottom: calc(var(--player-bar-height-desktop) + 2rem);
    scroll-behavior: smooth;
}

.btn-icon {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    cursor: pointer;
    padding: 0.5rem;
    border-radius: var(--radius);
    transition: all var(--transition);
    display: flex;
    align-items: center;
    justify-content: center;
}

.btn-icon:hover {
    background: var(--secondary);
    color: var(--foreground);
}

/* Synced lyrics styling with Apple Music animations */
.synced-line {
    padding: 0.5rem 0;
    font-size: 1.125rem;
    line-height: 1.8;
    color: var(--muted-foreground);
    opacity: 0.5;
    transform: scale(0.95);
    filter: blur(1.5px);
    transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.synced-line.active {
    color: var(--highlight);
    font-weight: 600;
    font-size: 1.25rem;
    opacity: 1;
    transform: scale(1);
    filter: blur(0);
    text-shadow: 0 0 20px rgb(var(--highlight-rgb), 0.3);
}

.synced-line.upcoming {
    opacity: 0.7;
    transform: scale(0.98);
    filter: blur(0.8px);
}

.synced-line.past {
    opacity: 0.3;
    transform: scale(0.93);
    filter: blur(2px);
}

.lyrics-loading,
.lyrics-error {
    text-align: center;
    padding: 2rem;
    color: var(--muted-foreground);
}

/* Compact Cards (Artist and Album) */
.card.compact {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 0.75rem;
    padding: 0.5rem;
    min-height: 60px;
}

.card.compact .card-image-wrapper {
    width: 48px;
    height: 48px;
    margin-bottom: 0;
    flex-shrink: 0;
}

.card.artist.compact .card-image-wrapper {
    width: 40px;
    height: 40px;
}

.card.compact .card-info {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.card.compact .card-title {
    margin: 0;
    font-size: 0.9rem;
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.card.compact .card-subtitle {
    margin: 0;
    font-size: 0.8rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    color: var(--muted-foreground);
}

/* Compact Card Play Button */
.card.compact .card-play-btn {
    right: 0.5rem;
    top: 25%;
    width: 36px !important;
    height: 36px !important;
    background-color: var(--primary) !important;
    color: var(--primary-foreground) !important;
    box-shadow: var(--shadow-md);
    transition: opacity 0.2s ease;
}

/* Hide play button initially on desktop (hover capable), show on hover */

/* Adjust like button for compact size */
.card.compact .card-like-btn {
    width: 24px !important;
    height: 24px !important;
    top: 0;
    right: 0;
}

.card.compact:hover .card-like-btn {
    opacity: 1;
}

.card.compact.user-playlist .edit-playlist-btn,
.card.compact.user-playlist .delete-playlist-btn {
    display: none !important;

    /* Hide edit/delete on compact view to prevent covering image */
}

/* Mobile adjustments */

/* Clickable album cover indicator */
.now-playing-bar .cover {
    cursor: pointer;
    transition:
        transform var(--transition-fast),
        box-shadow var(--transition-fast);
    position: relative;
    border-radius: 0.5rem;
    box-shadow: 0 6px 14px rgb(0, 0, 0, 0.3);
    isolation: isolate;
}

.now-playing-bar .cover:hover {
    transform: translateY(-2px) scale(1.03);
    box-shadow: 0 9px 20px rgb(0, 0, 0, 0.36);
}

/* Rotating album cover */
.now-playing-bar .cover.rotating {
    border-radius: 50%;
    animation: rotate-disc 3s linear infinite;
    box-shadow:
        0 0 0 2px rgb(255, 255, 255, 0.08),
        0 0 24px rgb(0, 0, 0, 0.4),
        inset 0 0 28px rgb(0, 0, 0, 0.25);
}

.now-playing-bar .cover.rotating::before,
.now-playing-bar .cover.rotating::after {
    content: '';
    position: absolute;
    inset: 0;
    border-radius: var(--radius-full);
    pointer-events: none;
}

.now-playing-bar .cover.rotating::before {
    background: repeating-radial-gradient(circle at center,
            rgb(255, 255, 255, 0.06) 0,
            rgb(255, 255, 255, 0.06) 1px,
            transparent 2px,
            transparent 3.5px);
    mix-blend-mode: soft-light;
    opacity: 0.45;
}

.now-playing-bar .cover.rotating::after {
    background:
        radial-gradient(circle at 24% 22%, rgb(255, 255, 255, 0.28) 0, transparent 34%),
        radial-gradient(circle at 50% 50%, transparent 0 47%, rgb(0, 0, 0, 0.28) 76%, rgb(0, 0, 0, 0.46) 100%);
}

.now-playing-bar .cover.rotating.paused {
    animation-play-state: paused;
}

@keyframes rotate-disc {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}

/* Friends Page Styles */

/* Friends Hero */
.friends-hero {
    padding: 2.5rem 0 1.5rem;
}

.friends-hero-title {
    font-size: 2rem;
    font-weight: 800;
    letter-spacing: -0.025em;
    margin-bottom: 0.35rem;
}

.friends-hero-subtitle {
    color: var(--muted-foreground);
    font-size: 1rem;
}

.friends-section-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 1rem;
}

.friends-empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--muted-foreground);
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* Friends Grid */
.friends-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 0.75rem;
}

/* Friend Card - Horizontal layout */
.friend-card {
    background: var(--card);
    border-radius: 12px;
    padding: 1rem 1.25rem;
    cursor: pointer;
    transition:
        background 0.2s ease,
        border-color 0.2s ease;
    border: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 0.875rem;
}

.friend-card:hover {
    background: color-mix(in srgb, var(--card) 80%, var(--primary) 8%);
    border-color: color-mix(in srgb, var(--border) 60%, var(--primary) 20%);
}

.friend-card .friend-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
    border: 2px solid color-mix(in srgb, var(--border) 70%, var(--primary) 15%);
}

.friend-card .friend-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.friend-card .friend-card-body {
    flex: 1;
    min-width: 0;
}

.friend-card .friend-name {
    font-weight: 600;
    font-size: 0.95rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    line-height: 1.3;
}

.friend-card .friend-username {
    color: var(--muted-foreground);
    font-size: 0.8rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.friend-card .friend-status {
    margin-top: 0.3rem;
    font-size: 0.78rem;
    color: var(--primary);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    display: flex;
    align-items: center;
    gap: 0.35rem;
}

.friend-card .friend-status::before {
    content: '';
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--primary);
    flex-shrink: 0;
}

.friend-card .friend-card-actions {
    flex-shrink: 0;
}

.friend-card .friend-card-actions .btn-secondary {
    padding: 0.4rem 0.75rem;
    font-size: 0.8rem;
}

@media (max-width: 480px) {
    .friends-grid {
        grid-template-columns: 1fr;
    }
}

/* Friend Request Styles */
.friend-request-item {
    display: flex;
    align-items: center;
    gap: 1rem;
    padding: 1rem;
    background: var(--card);
    border-radius: 8px;
    border: 1px solid var(--border);
}

.friend-request-item .friend-request-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    overflow: hidden;
    flex-shrink: 0;
}

.friend-request-item .friend-request-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.friend-request-item .friend-request-info {
    flex: 1;
}

.friend-request-item .friend-request-name {
    font-weight: 600;
}

.friend-request-item .friend-request-username {
    color: var(--muted-foreground);
    font-size: 0.875rem;
}

.friend-request-item .friend-request-actions {
    display: flex;
    gap: 0.5rem;
}

.friend-request-item.pending {
    opacity: 0.85;
}

.friend-requests-subtitle {
    margin: 1rem 0 0.5rem;
    color: var(--muted-foreground);
    font-size: 0.85rem;
    font-weight: 600;
    letter-spacing: 0.04em;
    text-transform: uppercase;
}

.friends-discover-panel {
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    background: color-mix(in srgb, var(--card) 84%, transparent);
    padding: 1rem;
}

.friends-suggestions-status {
    margin-top: 0.65rem;
    color: var(--muted-foreground);
    font-size: 0.85rem;
}

.friends-suggestions-list {
    margin-top: 0.85rem;
    display: flex;
    flex-direction: column;
    gap: 0.65rem;
}

.friend-suggestion-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border-radius: var(--radius-md);
    border: 1px solid var(--border);
    background: color-mix(in srgb, var(--card) 92%, transparent);
}

.friend-suggestion-item.self {
    border-style: dashed;
    background: color-mix(in srgb, var(--secondary) 32%, transparent);
}

.friend-suggestion-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    object-fit: cover;
    border: 1px solid var(--border);
    flex-shrink: 0;
}

.friend-suggestion-meta {
    min-width: 0;
    flex: 1;
}

.friend-suggestion-name {
    font-weight: 600;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.friend-suggestion-username {
    color: var(--muted-foreground);
    font-size: 0.84rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.friend-suggestion-actions {
    display: flex;
    gap: 0.45rem;
    flex-shrink: 0;
}

.friend-suggestion-actions .btn-primary,
.friend-suggestion-actions .btn-secondary {
    min-width: 0;
    padding: 0.4rem 0.7rem;
    justify-content: center;
}

@media (max-width: 720px) {
    .friend-suggestion-item {
        flex-wrap: wrap;
    }

    .friend-suggestion-actions {
        width: 100%;
        justify-content: flex-end;
    }
}

/* Collaborative Playlist Card */
.collab-playlist-card {
    cursor: pointer;
    transition:
        transform 0.2s,
        box-shadow 0.2s;
}

.collab-playlist-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgb(0, 0, 0, 0.2);
}

/* Window Controls Overlay */

.now-playing-bar .artist .artist-link {
    cursor: pointer;
    transition: color var(--transition);
}

.now-playing-bar .artist .artist-link:hover {
    color: var(--highlight);
    text-decoration: underline;
}

.automix-indicator {
    display: none;
    align-items: center;
    gap: 4px;
    font-size: 11px;
    color: var(--primary);
    opacity: 0;
    transition: opacity 0.3s ease;
    margin-top: 2px;
}

.automix-indicator.active {
    display: flex;
    opacity: 1;
}

.automix-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--primary);
    animation: automix-pulse 1.5s ease-in-out infinite;
}

@keyframes automix-pulse {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.3;
    }
}

.track-item .artist .artist-link {
    cursor: pointer;
    transition: color var(--transition);
}

.track-item .artist .artist-link:hover {
    color: var(--highlight);
    text-decoration: underline;
}

/* Updated Volume Controls Layout */

.player-actions-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.volume-slider-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

/* Ensure buttons in rows behave correctly */
.player-actions-row button,
.volume-slider-row button {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Show a grey box for images with no source, hiding the broken icon */
img:not([src]),
img[src=''] {
    content: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7');
    background-color: var(--muted);
}

/* Card Play Button */
.card-play-btn {
    position: absolute;
    bottom: 2%;
    right: 2%;
    background: var(--highlight) !important;
    border-radius: 50% !important;
    width: 42px !important;
    height: 42px !important;
    padding: 0 !important;
    display: flex !important;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transform: translateY(10px);
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1) !important;
    z-index: 20;
    color: var(--background) !important;
    border: none !important;
    box-shadow: var(--shadow-md);
}

.card:hover .card-play-btn {
    opacity: 1;
    transform: translateY(0);
}

.card-play-btn:hover {
    transform: scale(1.1) translateY(0) !important;
    box-shadow: var(--shadow-lg);
    filter: brightness(1.1);
}

/* Firebase Settings Styling */
.firebase-settings-wrapper {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    width: 100%;
    max-width: 400px;
}

.custom-firebase-config {
    display: none;
    flex-direction: column;
    gap: 0.5rem;
    margin-top: 0.5rem;
    width: 100%;
}

.custom-firebase-config.visible {
    display: flex;
}

.config-help-text {
    font-size: 0.8rem;
    opacity: 0.7;
    margin-bottom: 0.25rem;
}

.firebase-controls-container {
    display: flex;
    gap: 0.5rem;
    width: 100%;
}

#toggle-firebase-config-btn {
    width: fit-content;
}

.account-content {
    padding: 1rem 0;
}

.fullscreen-main-view {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 6rem 2rem 2rem;
    transition:
        flex 0.3s ease,
        padding-right 0.3s ease,
        margin-right 0.3s ease;
}

.fullscreen-lyrics-toggle {
    position: absolute;
    top: 1rem;
    right: 4.5rem;
    background: rgb(0, 0, 0, 0.5);
    border: none;
    color: white;
    padding: 0.75rem;
    border-radius: var(--radius-full);
    cursor: pointer;
    z-index: 1001;
    display: flex;
    align-items: center;
    justify-content: center;
    transition:
        all 0.2s ease,
        right 0.3s ease;
}

.fullscreen-lyrics-toggle:hover {
    background: rgb(0, 0, 0, 0.7);
    transform: scale(1.1);
}

.fullscreen-lyrics-toggle.active {
    background: var(--primary);
}

/* Modals */
.modal {
    position: fixed;
    inset: 0;
    z-index: 10000;
    display: none;
    align-items: center;
    justify-content: center;
}

.modal.active {
    display: flex;
    backdrop-filter: blur(2px);
    background: rgb(0, 0, 0, 0.6);
    transition: opacity var(--transition-normal);
}

.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgb(0, 0, 0, 0.7);
    backdrop-filter: blur(4px);
    z-index: -1;
}

.modal-content {
    background: var(--card);
    padding: 2rem;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    max-width: 400px;
    width: 90%;
    box-shadow: var(--shadow-xl);
    animation: scale-in 0.2s ease;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-content.wide {
    max-width: 600px;
}

.modal-content.extra-wide {
    max-width: 1000px;
}

.modal-content.medium {
    max-width: 500px;
}

.modal-list {
    margin: 1rem 0;
    max-height: 200px;
    overflow-y: auto;
}

.modal-option {
    padding: 0.75rem;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
    transition: background 0.2s ease;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-option:hover {
    background: var(--secondary);
}

.modal-option.already-contains {
    opacity: 0.6;
    cursor: default;
}

.modal-option.already-contains:hover {
    background: transparent;
}

.modal-option .checkmark {
    color: var(--highlight);
    flex-shrink: 0;
}

.modal-option:last-child {
    border-bottom: none;
}

.modal-actions {
    display: flex;
    gap: 0.5rem;
    justify-content: flex-end;
    margin-top: 1.5rem;
}

.timer-options {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.timer-option {
    text-align: center;
}

#playlist-modal {
    animation: fade-in 0.1s ease-in;
}

/* fuck this chud ass shit bro */
.csv-import-progress {
    position: fixed;
    bottom: 120px;
    right: 3%;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 1.5rem;
    box-shadow: var(--shadow-xl);
    z-index: 10001;
    max-width: 400px;
    min-width: 350px;
    animation: slide-in 0.3s ease;
}

.csv-import-progress .progress-header {
    margin-bottom: 1rem;
}

.csv-import-progress .progress-header h4 {
    margin: 0 0 0.5rem;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--foreground);
}

.csv-import-progress .progress-warning {
    font-size: 0.85rem;
    color: var(--muted-foreground);
    line-height: 1.4;
}

.csv-import-progress .progress-content {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.csv-import-progress .current-track {
    font-size: 0.9rem;
    color: var(--foreground);
    font-weight: 500;
    min-height: 1.2rem;
}

.csv-import-progress .progress-bar {
    width: 100%;
    height: 8px;
    background: var(--secondary);
    border-radius: var(--radius-sm);
    overflow: hidden;
    position: relative;
}

.csv-import-progress .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--highlight));
    border-radius: var(--radius-sm);
    width: 0%;
    transition: width 0.3s ease;
    position: relative;
}

.csv-import-progress .progress-fill::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    background: linear-gradient(90deg, transparent 0%, rgb(255, 255, 255, 0.3) 50%, transparent 100%);
    animation: shimmer 2s infinite;
}

@keyframes shimmer {
    0% {
        transform: translateX(-100%);
    }

    100% {
        transform: translateX(100%);
    }
}

.csv-import-progress .progress-text {
    font-size: 0.85rem;
    color: var(--muted-foreground);
    text-align: center;
}

.csv-import-progress .progress-text span {
    font-weight: 600;
    color: var(--foreground);
}

.missing-tracks-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 2rem 2rem 1.5rem;
    border-bottom: 1px solid var(--border);
}

.missing-tracks-header h3 {
    margin: 0;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--foreground);
    letter-spacing: -0.025em;
}

.close-missing-tracks {
    background: transparent;
    border: none;
    color: var(--muted-foreground);
    font-size: 1.5rem;
    cursor: pointer;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    transition: all var(--transition);
}

.close-missing-tracks:hover {
    background: var(--secondary);
    color: var(--foreground);
}

.missing-tracks-content {
    padding: 2rem;
}

.missing-tracks-content p {
    margin-bottom: 2rem;
    line-height: 1.7;
    color: var(--foreground);
    font-size: 1rem;
    font-weight: 400;
}

.missing-tracks-list h4 {
    margin-bottom: 1rem;
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--foreground);
    letter-spacing: -0.01em;
}

.missing-tracks-list ul {
    list-style: none;
    padding: 0;
    max-height: 400px;
    overflow-y: auto;
    border: 1px solid var(--border);
    border-radius: var(--radius);
    background: var(--secondary);
}

.missing-tracks-list li {
    padding: 0.75rem 1.25rem;
    border-bottom: 1px solid var(--border);
    color: var(--foreground);
    font-size: 0.95rem;
    font-weight: 400;
    line-height: 1.4;
}

.missing-tracks-list li:last-child {
    border-bottom: none;
}

.missing-tracks-list li:nth-child(even) {
    background: rgb(255, 255, 255, 0.02);
}

.missing-tracks-actions {
    padding: 1.5rem 2rem 2rem;
    border-top: 1px solid var(--border);
    display: flex;
    justify-content: flex-end;
}

.missing-tracks-actions .btn-secondary {
    min-width: 100px;
    padding: 0.75rem 1.5rem;
    font-size: 0.95rem;
    font-weight: 500;
}

/* Default responsive classes */
.mobile-only {
    display: none !important;
}

/* Mobile-specific overrides */
@media (max-width: 768px) {
    .mobile-only {
        display: flex !important;
    }

    .desktop-only {
        display: none !important;
    }

    /* position the cast button on mobile to the bottom right cuz damn shit already cluttered */
    #cast-btn {
        position: absolute !important;
        bottom: 10px !important;
        right: 10px !important;
        z-index: 10 !important;
        background: transparent !important;
        border: none !important;
        border-radius: 0 !important;
        width: 24px !important;
        height: 24px !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        box-shadow: none !important;
        padding: 0 !important;
    }

    #cast-btn:hover {
        background: transparent !important;
        transform: none !important;
    }

    #cast-btn svg {
        width: 20px !important;
        height: 20px !important;
    }

    .now-playing-bar .player-controls {
        position: relative !important;
        padding-bottom: 50px !important;
    }

    .player-controls.waveform-loaded {
        gap: 0;
    }
}

/* --- Responsive & Media Queries --- */

@media (min-width: 1440px) {
    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    }
}

@media (min-width: 1920px) {
    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }
}

@media (min-width: 769px) and (max-width: 1024px) {
    .now-playing-bar {
        grid-template-columns: minmax(150px, 1fr) 1fr auto;
        gap: var(--spacing-md);
        padding: var(--spacing-md);
    }

    .volume-controls {
        display: flex;
    }

    .desktop-only {
        display: flex;
    }
}

@media (max-width: 1024px) {
    .app-container {
        grid-template-columns: 160px 1fr;
    }

    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        gap: var(--spacing-md);
    }

    .detail-header-info .title {
        font-size: 3rem;
    }

    .detail-header-info .title.long-title {
        font-size: 2rem;
    }

    .detail-header-info .title.very-long-title {
        font-size: 1.35rem;
    }

    .main-content {
        padding: var(--spacing-lg);
    }

    .now-playing-bar {
        width: calc(96% - 160px) !important;
        left: calc(160px + 2%);
    }
}

@media (max-width: 768px) {
    .player-controls .progress-container {
        order: -1;
        max-width: none;
        font-size: 0.75rem;
        gap: 0.5rem;
    }

    #fullscreen-cover-overlay {
        padding-bottom: 0;
    }

    #fullscreen-cover-image {
        max-height: 45vh;

        /* Reduce height on mobile to fit text */
        margin-bottom: 1.5rem;
    }

    .fullscreen-main-view {
        padding-top: 4rem;
    }

    #fullscreen-track-title {
        font-size: 1.5rem;
    }

    #fullscreen-track-artist {
        font-size: 1rem;
    }

    .app-container {
        grid-template:
            'header' auto
            'main' 1fr
            'player' auto
            'sidebar' auto / 1fr;
        height: 100vh;
        height: 100dvh;
    }

    .main-content {
        padding: var(--spacing-sm);
        grid-area: main;
    }

    .main-header {
        grid-area: header;
        top: max(0.35rem, env(safe-area-inset-top));
        margin-bottom: var(--spacing-sm);
        padding: 0.4rem;
        gap: 0.45rem;
        flex-wrap: wrap;
        border-radius: 0.88rem;
    }

    /* Default sidebar state - hidden off-screen, will slide in when toggled */
    .sidebar {
        position: fixed;
        top: 0;
        left: 0;
        height: 100vh;
        height: 100dvh;
        width: 280px;
        border-radius: 0 var(--radius-xl) var(--radius-xl) 0;
        border: none;
        padding: 1rem;
        padding-top: calc(1rem + env(safe-area-inset-top));
        padding-bottom: calc(1rem + env(safe-area-inset-bottom));
        background: var(--background);
        transform: translateX(-100%);
        z-index: 2200;
        display: flex;
        flex-direction: column;
        transition: transform var(--transition-normal);
        box-shadow: var(--shadow-2xl);
    }

    .sidebar.is-open {
        transform: translateX(0);
    }

    /* Player bar is at the bottom - no additional nav bar needed */

    .sidebar-content {
        display: flex;
        flex-direction: column;
        width: 100%;
        height: 100%;
        padding: 0;
    }

    .sidebar-logo,
    .sidebar-bottom-container {
        display: flex !important;
    }

    /* Keep hamburger menu visible in search-nav-controls on mobile */
    .search-nav-controls .hamburger-menu {
        display: flex !important;
    }

    /* Default sidebar nav - full vertical layout for slide-out */
    .sidebar-nav.main {
        flex-direction: column;
        width: 100%;
        justify-content: flex-start;
        padding: 0;
        margin: 0;
        gap: 0.25rem;
    }

    .sidebar-nav.main .nav-item {
        flex: 0;
        flex-direction: row;
        justify-content: flex-start;
        align-items: center;
        padding: 0.75rem 1rem;
        gap: 0.75rem;
        border-radius: var(--radius-md);
    }

    .sidebar-nav.main .nav-item.active {
        background: var(--secondary);
        color: var(--primary);
    }

    .sidebar-nav.main .nav-item span {
        font-size: 0.9rem;
        margin: 0;
    }

    /* Hamburger menu is styled by .search-nav-controls .hamburger-menu */

    /* Sidebar is already a slide-out panel by default on mobile */

    /* Show sidebar overlay when sidebar is open on mobile */
    #sidebar-overlay.is-visible {
        display: block;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 1999;
    }

    .search-bar {
        max-width: none;
        order: 3;
        flex: 1 0 100%;
    }

    /* Fix search suggestions on mobile - ensure they're visible */
    .search-suggestions-list {
        position: fixed;
        left: 0.5rem !important;
        right: 0.5rem !important;
        width: auto !important;
        max-width: calc(100vw - 1rem) !important;
        max-height: 50vh !important;
        z-index: 10000;
    }

    /* Fix search input on mobile */
    #search-form {
        width: 100%;
        flex-wrap: wrap;
    }

    .search-nav-controls {
        order: 1;
    }

    .search-input-wrapper {
        order: 2;
        flex: 1 0 100%;
        margin-top: 0.5rem;
    }

    #search-form input {
        width: 100%;
    }

    .content-section {
        margin-bottom: var(--spacing-xl);
        max-width: 100%;
        overflow-x: hidden;
    }

    .section-title {
        font-size: 1.5rem;
        margin-bottom: var(--spacing-md);
    }

    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(136px, 1fr));
        gap: var(--spacing-sm);
    }

    .recommended-artists-grid,
    #home-recommended-artists.card-grid {
        grid-template-columns: repeat(auto-fill, minmax(132px, 1fr));
    }

    .home-recommended-artists-section {
        padding: 0.9rem;
        border-radius: 0.88rem;
    }

    .section-subtitle {
        font-size: 0.82rem;
        margin-top: 0.35rem;
    }

    /* Fix library page layout on mobile */
    #page-library .search-tabs {
        flex-wrap: wrap;
    }

    /* Fix search page tabs on mobile - make them compact and wrap */
    #page-search .search-tabs {
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }

    #page-search .search-tab {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: 0.85rem;
        flex: 1;
        min-width: auto;
        white-space: nowrap;
    }

    .library-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }

    .library-actions {
        width: 100%;
    }

    .library-actions .btn-primary,
    .library-actions .btn-secondary {
        flex: 1;
        justify-content: center;
    }

    .detail-header {
        flex-direction: row;
        gap: var(--spacing-md);
        padding-bottom: var(--spacing-sm);
        margin-bottom: var(--spacing-lg);
    }

    .detail-header-image {
        width: 120px;
        height: 120px;
    }

    .detail-header-collage {
        width: 120px;
        height: 120px;
    }

    .detail-header-info {
        flex: 1;
        min-width: 0;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .detail-header-info .title {
        font-size: 1.5rem;
        line-height: 1.2;
    }

    .detail-header-info .title.long-title {
        font-size: 1.35rem;
    }

    .detail-header-info .title.very-long-title {
        font-size: 1.25rem;
    }

    /* Mobile Playlist Title - Algorithmic sizing based on viewport */
    #playlist-detail-title {
        font-size: clamp(1.25rem, 6vw, 2rem) !important;
    }

    #playlist-detail-title.long-title {
        font-size: clamp(1.1rem, 5vw, 1.5rem) !important;
    }

    #playlist-detail-title.very-long-title {
        font-size: clamp(1rem, 4vw, 1.25rem) !important;
    }

    /* Show mobile playlist menu on small screens */
    .playlist-mobile-menu {
        display: block;
    }

    /* Hide regular action buttons on mobile, show in menu instead */
    #page-playlist .detail-header-actions {
        display: none;
    }

    .detail-header-info .meta {
        font-size: 0.85rem;
        gap: 0.35rem;
        margin-top: 0.25em;
    }

    .detail-header-actions {
        margin-top: 0.5em;
    }

    .album-hero-actions {
        gap: 0.35rem;
    }

    .album-hero-actions .btn-group-item {
        padding: 0.5rem 0.75rem;
        min-width: 40px;
        min-height: 36px;
    }

    .album-hero-actions .btn-group-item svg {
        width: 16px;
        height: 16px;
    }

    .now-playing-bar {
        grid-template:
            'track controls' auto
            'progress progress' auto / 1fr auto;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm) var(--spacing-md);
        height: var(--player-bar-height-mobile);
        bottom: max(15px, env(safe-area-inset-bottom, 0px)) !important;
    }

    /* Add padding to main content to account for player bar */
    .main-content {
        padding-bottom: calc(var(--player-bar-height-mobile) + 30px);
    }

    .now-playing-bar .track-info {
        grid-area: track;
        min-width: 0;
    }

    .track-info {
        gap: var(--spacing-sm);
    }

    .track-info .cover {
        width: 48px;
        height: 48px;
    }

    .track-info .details {
        min-width: 0;
        flex: 1;
    }

    .track-info .details .title {
        font-size: 0.9rem;
    }

    .track-info .details .artist {
        font-size: 0.75rem;
    }

    .now-playing-bar .volume-controls {
        grid-area: controls;
        display: flex;
        gap: 0.25rem;
        justify-content: flex-end;
    }

    .now-playing-bar .player-controls {
        grid-area: progress;
        width: 100%;
    }

    .player-controls .buttons {
        justify-content: center;
        gap: var(--spacing-lg);
        padding: 0 15%;
    }

    .player-controls .buttons button {
        width: 28px;
        height: 28px;
    }

    .player-controls .buttons .play-pause-btn {
        width: 32px;
        height: 32px;
    }

    .desktop-only {
        display: none !important;
    }

    .volume-controls button:not(.desktop-only) {
        display: flex;
    }

    #download-notifications {
        bottom: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
    }

    .track-menu-btn {
        opacity: 1;
    }

    .about-links {
        flex-direction: column;
    }

    .github-link {
        width: 100%;
        justify-content: center;
    }

    .setting-item {
        flex-direction: column;
        align-items: flex-start;
        gap: var(--spacing-md);
    }

    .setting-item:has(.toggle-switch) {
        flex-direction: row;
        align-items: center;
        width: 100%;
    }

    .setting-item:has(.toggle-switch) .info {
        width: auto;
        flex: 1;
        min-width: 0;
    }

    .setting-item:has(.toggle-switch) .label {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .setting-item:has(.toggle-switch) .description {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
        line-clamp: 2;
        overflow: hidden;
    }

    .setting-item:has(.toggle-switch) .toggle-switch {
        margin-left: auto;
    }

    .setting-item .info {
        width: 100%;
    }

    .template-input {
        max-width: none;
        font-size: 0.85rem;
    }

    .track-item {
        grid-template-columns: 36px 1fr auto auto;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm);
    }

    .track-item-info {
        gap: var(--spacing-sm);
        min-width: 0;
        overflow: hidden;
    }

    .track-item-cover {
        width: 36px;
        height: 36px;
    }

    .track-item-details {
        min-width: 0;
        overflow: hidden;
    }

    .track-item-duration {
        text-align: right;
        white-space: nowrap;
    }

    .track-menu-btn svg {
        width: 18px;
        height: 18px;
    }

    .track-action-btn {
        padding: 0.25rem;
    }

    .queue-track-item {
        grid-template-columns: 24px 1fr 40px 32px 32px;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm);
    }

    .queue-track-item .drag-handle {
        width: 24px;
    }

    .queue-track-item .drag-handle svg {
        width: 14px;
        height: 14px;
    }

    .queue-track-item .track-item-cover {
        width: 36px;
        height: 36px;
    }

    .queue-track-item .queue-like-btn,
    .queue-track-item .queue-remove-btn {
        padding: 0.5rem;
        width: 32px;
        height: 32px;
    }

    .sidebar-nav .nav-item a {
        padding: 0.78rem 0.72rem;
    }

    .offline-notification,
    .update-notification {
        left: 10px;
        right: 10px;
        max-width: none;
        bottom: 10px;
    }

    .side-panel {
        width: 100vw;
        max-width: 100vw;
        bottom: 0;
    }

    .panel-content {
        padding-bottom: calc(var(--player-bar-height-mobile) + 2rem);
    }

    .synced-line {
        font-size: 1rem;
    }

    .synced-line.active {
        font-size: 1.125rem;
    }

    .karaoke-title {
        font-size: 1.5rem;
    }

    .karaoke-artist {
        font-size: 1rem;
    }

    .karaoke-line {
        font-size: 1.25rem;
    }

    .karaoke-line.active {
        font-size: 1.75rem;
    }

    /*  Lift Animation System for "World's Most Beautiful Lyrics"  */

    /* Parent lines: 3D perspective context */
    .karaoke-line-enhanced {
        perspective: 600px;
        transform-style: preserve-3d;
        transition:
            transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1),
            opacity 0.4s ease,
            filter 0.4s ease;
        opacity: 0.38;
        filter: blur(0.5px);
        cursor: pointer;
    }

    /* Active line lifts up and becomes opaque */
    .karaoke-line-enhanced[data-active='true'],
    .karaoke-line-enhanced.active {
        opacity: 1;
        filter: none;
        transform: scale(1.03) translateY(-2px);
    }

    /* Surrounding lines are slightly blurred/dimmed */
    .karaoke-line-enhanced[data-prev='true'] {
        opacity: 0.55;
        filter: blur(0.2px);
    }

    /* Word-level animations  staggered reveal */
    .karaoke-word-enhanced {
        display: inline-block;
        transition:
            transform 0.35s cubic-bezier(0.34, 1.56, 0.64, 1),
            opacity 0.35s ease,
            color 0.35s ease;
        transition-delay: calc(var(--word-index, 0) * 35ms);
        transform-origin: bottom center;
    }

    /* Highlight word when line becomes active */
    .karaoke-line-enhanced.active .karaoke-word-enhanced,
    .karaoke-line-enhanced[data-active='true'] .karaoke-word-enhanced {
        animation: lyric-word-lift 0.45s cubic-bezier(0.34, 1.56, 0.64, 1) both;
        animation-delay: calc(var(--word-index, 0) * 40ms);
    }

    @keyframes lyric-word-lift {
        0% {
            transform: translateY(6px) rotateX(12deg);
            opacity: 0.4;
        }

        100% {
            transform: translateY(0) rotateX(0deg);
            opacity: 1;
        }
    }

    .fullscreen-cover-content {
        flex-direction: column;
    }

    .csv-import-progress {
        bottom: 145px;
        right: 10px;
        left: 10px;
        max-width: none;
        min-width: 0;
    }

    .missing-tracks-modal {
        width: 95%;
        max-height: 90vh;
        margin: 1rem;
    }

    .missing-tracks-header,
    .missing-tracks-content,
    .missing-tracks-actions {
        padding-left: 1.5rem;
        padding-right: 1.5rem;
    }

    .missing-tracks-header {
        padding-top: 1.5rem;
        padding-bottom: 1rem;
    }

    .missing-tracks-content {
        padding-top: 1.5rem;
        padding-bottom: 1.5rem;
    }

    .missing-tracks-actions {
        padding-top: 1rem;
        padding-bottom: 1.5rem;
    }

    .missing-tracks-list ul {
        max-height: 250px;
    }

    .missing-tracks-header h3 {
        font-size: 1.25rem;
    }

    .missing-tracks-content p {
        font-size: 0.95rem;
    }

    .missing-tracks-list li {
        padding: 0.625rem 1rem;
        font-size: 0.9rem;
    }

    .mobile-only {
        display: flex !important;
    }
}

@media (max-width: 480px) {
    .card-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: var(--spacing-sm);
    }

    .section-title {
        font-size: 1.25rem;
    }

    /* Fix library page horizontal scrolling */
    #page-library .search-tabs {
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }

    #page-library .search-tab {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: 0.85rem;
        flex: 1;
        min-width: auto;
        white-space: nowrap;
    }

    /* Fix search page tabs on small screens */
    #page-search .search-tabs {
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }

    #page-search .search-tab {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: 0.8rem;
        flex: 1;
        min-width: auto;
        white-space: nowrap;
    }

    #page-library .library-header {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-sm);
        align-items: center;
    }

    #page-library .library-header h2 {
        width: 100%;
        margin-bottom: var(--spacing-sm);
    }

    #page-library .library-actions {
        width: 100%;
    }

    #page-library .library-actions .btn-primary,
    #page-library .library-actions .btn-secondary {
        flex: 1;
        justify-content: center;
        margin: 0 !important;
    }

    .detail-header-info .title {
        font-size: 1.25rem;
    }

    .detail-header-info .title.long-title {
        font-size: 1.1rem;
    }

    .detail-header-info .title.very-long-title {
        font-size: 0.9rem;
    }

    .search-tab {
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: 0.9rem;
    }

    .player-controls .buttons {
        gap: 0.25rem;
    }

    .player-controls .buttons button {
        width: 24px;
        height: 24px;
    }

    .player-controls .buttons button svg {
        width: 16px;
        height: 16px;
    }

    .player-controls .buttons .play-pause-btn {
        width: 28px;
        height: 28px;
    }

    .player-controls .buttons .play-pause-btn svg {
        width: 18px;
        height: 18px;
    }

    .volume-controls button {
        padding: 0.25rem;
        min-width: 28px;
        min-height: 28px;
    }

    .volume-controls button svg {
        width: 16px;
        height: 16px;
    }

    .track-item {
        grid-template-columns: 32px 1fr 40px auto;
        gap: 0.375rem;
        padding: var(--spacing-xs);
    }

    .track-number {
        width: 32px;
    }

    .track-item-cover {
        width: 32px;
        height: 32px;
    }

    .track-item-details .title {
        font-size: 0.85rem;
    }

    .track-item-details .artist {
        font-size: 0.75rem;
    }

    .track-item-duration {
        font-size: 0.75rem;
    }

    .track-menu-btn {
        padding: 0.25rem;
    }

    .track-menu-btn svg {
        width: 16px;
        height: 16px;
    }

    .queue-track-item {
        grid-template-columns: 20px 1fr 36px 32px 32px;
        gap: 0.375rem;
        padding: 0.5rem;
    }

    .queue-track-item .drag-handle {
        width: 20px;
    }

    .queue-track-item .track-item-cover {
        width: 32px;
        height: 32px;
    }

    .queue-track-item .queue-like-btn,
    .queue-track-item .queue-remove-btn {
        width: 32px;
        height: 32px;
    }

    [data-track-actions-mode='inline'] .track-actions-inline .track-action-btn:not([data-action='play-next']) {
        display: none;
    }

    .player-actions-row {
        gap: 0.25rem;
    }
}

@media (max-width: 360px) {
    .player-controls .buttons {
        justify-content: space-between;
        width: 100%;
    }

    #shuffle-btn,
    #repeat-btn {
        display: none;
    }
}

/* stylelint-disable-next-line media-feature-name-value-no-unknown */
@media (display-mode: window-controls-overlay) {
    .app-container {
        margin-top: env(titlebar-area-height, 0);
    }

    .main-header {
        -webkit-app-region: drag;
    }

    .main-header * {
        -webkit-app-region: no-drag;
    }

    .sidebar {
        padding-top: max(1.5rem, env(titlebar-area-height, 0));
    }
}

/* PWA Standalone Mode - Ensure navbar shows on mobile PWA */
@media (display-mode: standalone) and (max-width: 768px) {
    .sidebar {
        display: flex !important;
        visibility: visible !important;
    }

    .sidebar-nav.main {
        display: flex !important;
    }

    /* Ensure search bar is properly visible on mobile PWA */
    .search-bar {
        display: flex !important;
        visibility: visible !important;
    }

    #search-form {
        display: grid !important;
    }

    .search-suggestions-list {
        position: fixed;
        left: 0.5rem !important;
        right: 0.5rem !important;
        width: auto !important;
        max-width: calc(100vw - 1rem) !important;
    }
}

@media (hover: hover) {
    .card.compact .card-play-btn {
        opacity: 0;
    }

    .card.compact:hover .card-play-btn {
        opacity: 1;
    }
}

@media (hover: none) {
    .track-menu-btn {
        opacity: 1;
    }

    .track-actions-inline {
        opacity: 1;
    }

    .queue-track-item .queue-remove-btn {
        opacity: 1;
    }

    /* Hide like button on compact cards on mobile */
    .card.compact .card-like-btn {
        display: none !important;
    }
}

@media (hover: none) and (pointer: coarse) {
    .main-content {
        padding: var(--spacing-sm);
        grid-area: main;
    }

    .progress-bar:not(.waveform-loaded),
    .volume-bar {
        height: 8px;
    }

    .progress-bar .progress-fill::after,
    .volume-bar .volume-fill::after {
        content: '';
        position: absolute;
        right: -8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        background-color: var(--highlight);
        border-radius: var(--radius-full);
        box-shadow: 0 2px 6px rgb(0, 0, 0, 0.3);
    }

    button {
        min-height: 36px;
        min-width: 36px;
    }

    .track-item {
        grid-template-columns: 32px 1fr 32px auto;
    }

    .player-controls .buttons button {
        min-height: 36px;
        min-width: 36px;
    }

    .card:hover {
        transform: none !important;
    }

    .card-like-btn {
        opacity: 1 !important;
        top: -0.25em !important;
        right: -0.25em !important;
        transform: none !important;
    }

    .card-play-btn {
        opacity: 1 !important;
        bottom: -0.25em !important;
        right: -0.25em !important;
        transform: none !important;
    }
}

body:has(#fullscreen-cover-overlay:not([style*='display: none'])) .now-playing-bar {
    width: 96% !important;
    left: 2% !important;
}

@media (max-width: 768px) {
    .now-playing-bar {
        width: 96% !important;
        left: 2%;
    }
}

/* Custom Tooltip */
#custom-tooltip {
    position: fixed;
    background: var(--card);
    color: var(--card-foreground);
    padding: 0.5rem 0.75rem;
    border-radius: var(--radius);
    border: 1px solid var(--border);
    box-shadow: var(--shadow-lg);
    font-size: 0.85rem;
    pointer-events: none;
    z-index: 10000;
    opacity: 0;
    transition: opacity 0.1s ease;
    white-space: nowrap;
    max-width: 400px;
    overflow: hidden;
    text-overflow: ellipsis;
    will-change: transform, opacity;
}

/* Genius i love genius brah!! */
.genius-annotation-modal {
    position: fixed;
    inset: 0;
    z-index: 10002;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgb(0, 0, 0, 0.6);
    backdrop-filter: blur(2px);
    animation: fade-in 0.2s ease;
}

.genius-annotation-modal .genius-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #ffff64;
}

.genius-annotation-modal .genius-line {
    font-style: italic;
    color: #ffff64;
    font-weight: 600;
    margin-right: 1rem;
}

.genius-annotation-modal .close-genius {
    background: none;
    border: none;
    color: var(--foreground);
    font-size: 1.5rem;
    cursor: pointer;
    line-height: 1;
}

.genius-modal-content {
    background: var(--card);
    padding: 1.5rem;
    border-radius: var(--radius);
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: var(--shadow-xl);
    border: 1px solid var(--border);
}

.genius-annotation-modal .genius-body {
    overflow-y: auto;
}

.annotation-item {
    margin-bottom: 1.5rem;
}

.annotation-fragment {
    font-size: 0.8rem;
    color: var(--muted-foreground);
    margin-bottom: 0.5rem;
}

.annotation-text {
    line-height: 1.6;
}

.active-genius svg path:first-child {
    fill: #ffff64;
}

.genius-annotated {
    background-color: rgb(255, 255, 100, 0.1);
    cursor: pointer;
    border-radius: var(--radius-sm);
    transition: background-color 0.2s;
}

.genius-annotated:hover {
    background-color: rgb(255, 255, 100, 0.2);
}

.genius-multi-start {
    border-bottom-left-radius: 0;
    border-bottom-right-radius: 0;
}

.genius-multi-mid {
    border-radius: 0;
}

.genius-multi-end {
    border-top-left-radius: 0;
    border-top-right-radius: 0;
}

@media (min-width: 769px) {
    body.sidebar-collapsed .app-container {
        grid-template-columns: 86px 1fr;
    }

    body.sidebar-collapsed .sidebar-logo span {
        display: none;
    }

    body.sidebar-collapsed .sidebar-nav span {
        display: none;
    }

    body.sidebar-collapsed .sidebar-logo {
        justify-content: center;
        flex-direction: column;
        gap: 10px;
    }

    body.sidebar-collapsed .sidebar-nav .nav-item a {
        justify-content: center;
        padding: 0.75rem 0;
    }

    body.sidebar-collapsed .nav-btn-account {
        justify-content: center;
        gap: 0;
        padding: 0.55rem 0;
    }

    body.sidebar-collapsed .nav-account-meta,
    body.sidebar-collapsed .nav-account-chevron {
        display: none;
    }

    body.sidebar-collapsed .sidebar-account-dropdown {
        left: calc(100% + 0.5rem);
        right: auto;
        bottom: 0;
    }

    body.sidebar-collapsed .pinned-items-header {
        display: none;
    }

    body.sidebar-collapsed #pinned-items-list .nav-item a .pinned-item-name {
        display: none;
    }

    body.sidebar-collapsed #pinned-items-list .nav-item a {
        justify-content: center;
    }

    body.sidebar-collapsed .now-playing-bar {
        width: calc(96% - 86px) !important;
        left: calc(86px + 2%);
    }

    body.sidebar-collapsed #sidebar-toggle {
        margin-left: 0 !important;
    }
}

#page-track .detail-header {
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 4rem 2rem;
    gap: 2rem;
}

#page-track .detail-header-image {
    width: 350px;
    height: 350px;
    box-shadow: 0 30px 60px rgb(0, 0, 0, 0.5);
}

#page-track .detail-header-info {
    align-items: center;
    width: 100%;
}

#page-track .detail-header-info .title {
    justify-content: center;
    text-align: center;
    font-size: 3.5rem;
    margin-bottom: 0.5rem;
}

#page-track .detail-header-info .meta {
    justify-content: center;
    font-size: 1.1rem;
    opacity: 0.8;
}

#page-track .detail-header-actions {
    justify-content: center;
    margin-top: 2rem;
}

#page-track .section-title {
    text-align: center;
}

@media (max-width: 768px) {
    #page-track .detail-header {
        padding: 2rem 1rem;
    }

    #page-track .detail-header-image {
        width: 200px;
        height: 200px;
    }

    #page-track .detail-header-info .title {
        font-size: 1.75rem;
    }
}

.tracker-modal .track-item.loading {
    opacity: 0.7;
    pointer-events: none;
}

.tracker-modal .track-item.loading .track-number {
    color: var(--highlight);
}

@media (max-width: 768px) {
    .tracker-modal .modal-content {
        height: 90vh !important;
        max-height: 90vh !important;
        padding: 1rem !important;
    }

    .tracker-modal .detail-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 0.5rem;
        margin-bottom: 0.5rem !important;
    }

    .tracker-modal .detail-header-image {
        width: 80px !important;
        height: 80px !important;
    }

    .tracker-modal .detail-header-info .title {
        font-size: 1.25rem !important;
        margin-bottom: 0.25rem;
    }

    .tracker-modal .detail-header-info .meta {
        max-height: 60px;
        overflow-y: auto;
        display: block;
        font-size: 0.85rem;
    }

    .tracker-modal .detail-header-actions .btn-secondary {
        width: auto !important;
        height: auto !important;
        padding: 0.5rem 1.5rem !important;
        border-radius: 2rem !important;
    }

    #tracker-filters {
        padding: 0 0 0.5rem !important;
        justify-content: center;
    }
}

@media (max-width: 768px) {
    .tracker-modal .detail-header {
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 0.75rem;
    }

    .tracker-modal .detail-header-image {
        width: 100px !important;
        height: 100px !important;
    }

    .tracker-modal .detail-header-info .title {
        font-size: 1.5rem !important;
    }

    .tracker-modal .detail-header-info .meta {
        max-height: 80px;
        overflow-y: auto;
        display: block;
    }
}

/* Fullscreen layout shift when side panel is active */
body:has(#side-panel.active) .fullscreen-main-view {
    transition:
        flex 0.3s ease,
        padding-right 0.3s ease,
        margin-right 0.3s ease;
    padding-right: 600px;
}

body:has(#side-panel.active) .fullscreen-lyrics-toggle {
    right: calc(600px + 4.5rem);
}

body:has(#side-panel.active) #close-fullscreen-cover-btn {
    right: calc(600px + 1rem);
}

@media (max-width: 1200px) {
    body:has(#side-panel.active) .fullscreen-main-view {
        padding-right: 50vw;
    }

    body:has(#side-panel.active) .fullscreen-lyrics-toggle {
        right: calc(50vw + 4.5rem);
    }

    body:has(#side-panel.active) #close-fullscreen-cover-btn {
        right: calc(50vw + 1rem);
    }
}

@media (max-width: 768px) {
    body:has(#side-panel.active) .fullscreen-main-view {
        padding-right: 0;
    }

    /* Hide fullscreen specific buttons on mobile when panel is open */
    body:has(#side-panel.active) .fullscreen-lyrics-toggle,
    body:has(#side-panel.active) #close-fullscreen-cover-btn {
        display: none;
    }
}

@media (max-width: 480px) {
    .player-controls .buttons {
        gap: 1.25rem;
    }
}

@media (max-width: 480px) {
    .player-controls .buttons button svg {
        width: 25px;
        height: 25px;
    }
}

/* =========================================
   Global Design System Standardization
   ========================================= */

/* Scrollbars */
::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: var(--border);
    border-radius: var(--radius-full);
    border: 2px solid var(--background);
}

::-webkit-scrollbar-thumb:hover {
    background: var(--input);
}

/* Selection */
::selection {
    background: var(--primary);
    color: var(--primary-foreground);
}

/* Inputs & Form Elements */
input,
select,
textarea {
    transition:
        border-color var(--transition-fast),
        box-shadow var(--transition-fast),
        background-color var(--transition-fast);
}

input:focus,
select:focus,
textarea:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

.modal.active .modal-content {
    animation: pop-in var(--transition-normal) var(--ease-out-back);
    box-shadow: var(--shadow-2xl);
    border: 1px solid var(--border);
}

/* Micro-animations for Interactive Elements */
.nav-item a {
    position: relative;
    overflow: hidden;
}

.nav-item a:active {
    transform: scale(0.97);
}

/* =========================================
   16-Band Equalizer
   ========================================= */

.equalizer-container {
    margin-top: var(--spacing-md);
    padding: var(--spacing-lg);
    background: linear-gradient(145deg, var(--card), rgb(var(--highlight-rgb), 0.03));
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    box-shadow: inset 0 1px 1px rgb(255, 255, 255, 0.05);
}

.equalizer-header {
    margin-bottom: var(--spacing-lg);
}

.equalizer-preset-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
}

.equalizer-preset-row label {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

.equalizer-preset-row select {
    flex: 1;
    min-width: 150px;
    max-width: 250px;
    padding: 0.5rem 1rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    cursor: pointer;
    transition:
        border-color var(--transition-fast),
        box-shadow var(--transition-fast);
}

.equalizer-preset-row select:hover {
    border-color: var(--primary);
}

.equalizer-preset-row select:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

.eq-band-count-input {
    width: 60px;
    padding: 0.5rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    text-align: center;
    cursor: pointer;
    transition:
        border-color var(--transition-fast),
        box-shadow var(--transition-fast);
}

.eq-band-count-input:hover {
    border-color: var(--primary);
}

.eq-band-count-input:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

/* Hide number input arrows */
.eq-band-count-input::-webkit-outer-spin-button,
.eq-band-count-input::-webkit-inner-spin-button {
    appearance: none;
    margin: 0;
}

.eq-band-count-input[type='number'] {
    appearance: textfield;
}

#equalizer-reset-btn {
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius);
    background: var(--input);
    border: 1px solid var(--border);
    color: var(--muted-foreground);
    transition: all var(--transition-fast);
}

#equalizer-reset-btn:hover {
    background: var(--card);
    border-color: var(--primary);
    color: var(--foreground);
}

#equalizer-reset-btn svg {
    transition: transform 0.3s ease;
}

#equalizer-reset-btn:hover svg {
    transform: rotate(-45deg);
}

/* Custom Preset Controls */
.custom-preset-controls {
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--border);
}

.custom-preset-input-row {
    display: flex;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

#custom-preset-name {
    flex: 1;
    padding: 0.5rem 0.75rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    transition: border-color var(--transition-fast);
}

#custom-preset-name:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

#save-custom-preset-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 0.5rem 1rem;
    white-space: nowrap;
}

#save-custom-preset-btn svg {
    flex-shrink: 0;
}

.delete-preset-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: 0.5rem 1rem;
    font-size: 0.85rem;
    color: var(--destructive);
    border-color: var(--destructive);
    opacity: 0.8;
    transition: opacity var(--transition-fast);
}

.card-like-btn,
.card-menu-btn {
    opacity: 0;
    transition: opacity var(--transition-normal);
}

/* Home section heads */
.section-head {
    display: flex;
    align-items: flex-end;
    justify-content: space-between;
    gap: 0.75rem;
    margin-bottom: 1rem;
}

.section-head-compact {
    margin-bottom: 1rem;
}

.section-head-discovery {
    margin-bottom: 1.15rem;
}

.section-eyebrow {
    margin: 0 0 0.35rem;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.12em;
    color: var(--muted-foreground);
}

.section-subtitle {
    margin: 0.55rem 0 0;
    font-size: 0.9rem;
    color: color-mix(in srgb, var(--muted-foreground) 86%, transparent);
}

.home-recommended-artists-section {
    position: relative;
    padding: 1.25rem;
    border-radius: 1rem;
    border: 1px solid color-mix(in srgb, var(--border) 78%, transparent);
    background:
        radial-gradient(120% 120% at 100% 0%, color-mix(in srgb, var(--primary) 14%, transparent) 0%, transparent 55%),
        linear-gradient(155deg,
            color-mix(in srgb, var(--card) 86%, transparent) 0%,
            color-mix(in srgb, var(--background) 94%, transparent) 100%);
    box-shadow: 0 8px 24px rgb(0, 0, 0, 0.16);
}

.recommended-artists-grid,
#home-recommended-artists.card-grid {
    grid-template-columns: repeat(auto-fill, minmax(165px, 1fr));
    gap: 0.95rem;
}

/* Recommended artist cards */
.card.artist-circular {
    position: relative;
    background: linear-gradient(165deg,
            color-mix(in srgb, var(--card) 86%, transparent) 0%,
            color-mix(in srgb, var(--background) 94%, transparent) 100%);
    border: 1px solid color-mix(in srgb, var(--border) 84%, transparent);
    border-radius: 1rem;
    padding: 0.7rem;
    text-align: center;
    box-shadow: 0 8px 18px rgb(0, 0, 0, 0.16);
    overflow: hidden;
}

.card.artist-circular:hover {
    transform: translateY(-4px);
    border-color: color-mix(in srgb, var(--primary) 34%, var(--border));
    box-shadow: 0 14px 30px rgb(0, 0, 0, 0.24);
}

.card.artist-circular .card-image-wrapper {
    position: relative;
    border-radius: 0.88rem !important;
    aspect-ratio: 1 / 1;
    margin-bottom: 0.72rem !important;
    background: color-mix(in srgb, var(--secondary) 72%, transparent);
    overflow: hidden;
}

.card.artist-circular .card-image-wrapper::after {
    content: '';
    position: absolute;
    inset: 0;
    background:
        radial-gradient(circle at 22% 24%, rgb(255, 255, 255, 0.2) 0, transparent 38%),
        linear-gradient(to top, rgb(0, 0, 0, 0.32), transparent 45%);
    pointer-events: none;
}

.card.artist-circular .card-image {
    border-radius: 0.82rem !important;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transform: scale(1.02);
}

.card.artist-circular .card-info {
    padding: 0.15rem 0.2rem 0.2rem;
}

.card.artist-circular .card-title {
    font-size: 0.9rem;
    font-weight: 650;
    margin: 0.1rem 0 0;
    line-height: 1.3;
}

.delete-preset-btn:hover {
    opacity: 1;
    background: var(--destructive);
    color: var(--destructive-foreground);
}

.delete-preset-btn svg {
    flex-shrink: 0;
}

/* EQ Range Controls */
.eq-range-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-sm);
    padding-top: var(--spacing-sm);
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
}

.eq-range-controls label {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

.eq-range-controls span {
    font-size: 0.9rem;
    color: var(--muted-foreground);
}

.eq-range-input {
    width: 60px;
    padding: 0.4rem 0.5rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    text-align: center;
    transition: border-color var(--transition-fast);
}

.eq-range-input:hover {
    border-color: var(--primary);
}

.eq-range-input:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

/* Hide number input arrows */
.eq-range-input::-webkit-outer-spin-button,
.eq-range-input::-webkit-inner-spin-button {
    appearance: none;
    margin: 0;
}

.eq-range-input[type='number'] {
    appearance: textfield;
}

#apply-eq-range-btn {
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
}

#reset-eq-range-btn {
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
    margin-left: var(--spacing-xs);
}

/* EQ Frequency Range Controls */
.eq-freq-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-sm);
    padding-top: var(--spacing-sm);
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
}

.eq-freq-controls label {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

.eq-freq-controls span {
    font-size: 0.9rem;
    color: var(--muted-foreground);
}

.eq-freq-input {
    width: 70px;
    padding: 0.4rem 0.5rem;
    background: var(--input);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    color: var(--foreground);
    font-size: 0.9rem;
    text-align: center;
    transition: border-color var(--transition-fast);
}

.eq-freq-input:hover {
    border-color: var(--primary);
}

.eq-freq-input:focus {
    outline: none;
    border-color: var(--ring);
    box-shadow: 0 0 0 3px rgb(var(--highlight-rgb), 0.2);
}

/* Hide number input arrows */
.eq-freq-input::-webkit-outer-spin-button,
.eq-freq-input::-webkit-inner-spin-button {
    appearance: none;
    margin: 0;
}

.eq-freq-input[type='number'] {
    appearance: textfield;
}

#apply-eq-freq-btn {
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
}

#reset-eq-freq-btn {
    padding: 0.4rem 0.75rem;
    font-size: 0.85rem;
    margin-left: var(--spacing-xs);
}

/* EQ Preamp Controls */
.eq-preamp-controls {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-sm);
    padding-top: var(--spacing-sm);
    border-top: 1px solid var(--border);
    flex-wrap: wrap;
}

.eq-preamp-controls label {
    font-size: 0.9rem;
    color: var(--muted-foreground);
    font-weight: 500;
}

#eq-preamp-slider {
    flex: 1;
    min-width: 120px;
    max-width: 200px;
    height: 4px;
    appearance: none;
    background: var(--border);
    border-radius: 2px;
    outline: none;
    cursor: pointer;
}

#eq-preamp-slider::-webkit-slider-thumb {
    appearance: none;
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    transition: transform var(--transition-fast);
}

#eq-preamp-slider::-webkit-slider-thumb:hover {
    transform: scale(1.2);
}

#eq-preamp-slider::-moz-range-thumb {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: none;
    transition: transform var(--transition-fast);
}

#eq-preamp-slider::-moz-range-thumb:hover {
    transform: scale(1.2);
}

/* EQ Import/Export Buttons (now inline) */
#eq-export-btn,
#eq-import-btn {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    white-space: nowrap;
    gap: var(--spacing-xs);
}

/* Equalizer preset dropdown styling */
.equalizer-preset-row select optgroup {
    font-weight: 600;
    color: var(--foreground);
    padding: var(--spacing-xs) 0;
}

.equalizer-preset-row select optgroup option {
    font-weight: 400;
    padding-left: var(--spacing-sm);
}

.equalizer-bands-wrapper {
    position: relative;
    padding: var(--spacing-md) 0;
}

.equalizer-bands {
    display: flex;
    justify-content: space-between;
    gap: 4px;
    position: relative;
}

/* Zero line indicator - positioned at center of slider tracks */
.equalizer-bands::before {
    content: '';
    position: absolute;
    left: 0;
    right: 0;
    top: 60px;
    height: 1px;
    background: var(--border);
    opacity: 0.5;
    pointer-events: none;
    z-index: 0;
}

/* EQ Response Curve Canvas */
.eq-response-canvas {
    position: absolute;
    top: var(--spacing-md);
    left: 4px;
    width: calc(100% - 8px);
    height: 120px;
    pointer-events: none;
    z-index: 2;
    display: block;
}

.eq-band {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    flex: 1;
    min-width: 0;
    position: relative;
    z-index: 1;
    cursor: ns-resize;
    user-select: none;
}

/* Vertical slider styling */
.eq-slider {
    appearance: none;
    writing-mode: vertical-lr;
    direction: rtl;
    width: 8px;
    height: 120px;
    background: transparent;
    cursor: pointer;
    user-select: none;
    position: relative;
}

/* Track */
.eq-slider::-webkit-slider-runnable-track {
    width: 6px;
    height: 100%;
    background: linear-gradient(to top, var(--muted), var(--input));
    border-radius: var(--radius-full);
    border: 1px solid var(--border);
}

.eq-slider::-moz-range-track {
    width: 6px;
    height: 100%;
    background: linear-gradient(to top, var(--muted), var(--input));
    border-radius: var(--radius-full);
    border: 1px solid var(--border);
}

/* Thumb */
.eq-slider::-webkit-slider-thumb {
    appearance: none;
    width: 18px;
    height: 18px;
    background: linear-gradient(145deg, var(--primary), var(--highlight));
    border-radius: var(--radius-full);
    cursor: grab;
    margin-left: -6px;
    box-shadow:
        0 2px 8px rgb(0, 0, 0, 0.3),
        inset 0 1px 2px rgb(255, 255, 255, 0.3);
    transition:
        transform 0.15s ease,
        box-shadow 0.15s ease;
    border: 2px solid var(--background);
}

.eq-slider::-moz-range-thumb {
    width: 18px;
    height: 18px;
    background: linear-gradient(145deg, var(--primary), var(--highlight));
    border-radius: var(--radius-full);
    cursor: grab;
    box-shadow:
        0 2px 8px rgb(0, 0, 0, 0.3),
        inset 0 1px 2px rgb(255, 255, 255, 0.3);
    transition:
        transform 0.15s ease,
        box-shadow 0.15s ease;
    border: 2px solid var(--background);
}

.eq-slider::-webkit-slider-thumb:hover {
    transform: scale(1.15);
    box-shadow:
        0 4px 12px rgb(var(--highlight-rgb), 0.4),
        inset 0 1px 2px rgb(255, 255, 255, 0.3);
}

.eq-slider::-moz-range-thumb:hover {
    transform: scale(1.15);
    box-shadow:
        0 4px 12px rgb(var(--highlight-rgb), 0.4),
        inset 0 1px 2px rgb(255, 255, 255, 0.3);
}

.eq-slider::-webkit-slider-thumb:active {
    cursor: grabbing;
    transform: scale(1.1);
}

.eq-slider::-moz-range-thumb:active {
    cursor: grabbing;
    transform: scale(1.1);
}

.eq-slider:focus {
    outline: none;
}

.eq-slider:focus::-webkit-slider-thumb {
    box-shadow:
        0 0 0 4px rgb(var(--highlight-rgb), 0.3),
        0 2px 8px rgb(0, 0, 0, 0.3);
}

.eq-slider:focus::-moz-range-thumb {
    box-shadow:
        0 0 0 4px rgb(var(--highlight-rgb), 0.3),
        0 2px 8px rgb(0, 0, 0, 0.3);
}

.eq-value {
    font-size: 0.7rem;
    font-weight: 600;
    color: var(--foreground);
    min-width: 28px;
    text-align: center;
    padding: 2px 4px;
    background: var(--input);
    border-radius: var(--radius-sm);
    transition:
        color 0.2s ease,
        background 0.2s ease;
}

.eq-value.positive {
    color: var(--highlight);
    background: rgb(var(--highlight-rgb), 0.15);
}

.eq-value.negative {
    color: #ef4444;
    background: rgb(239, 68, 68, 0.15);
}

.eq-freq {
    font-size: 0.65rem;
    color: var(--muted-foreground);
    text-align: center;
    white-space: nowrap;
    font-weight: 500;
}

.equalizer-scale {
    display: flex;
    justify-content: space-between;
    padding-top: var(--spacing-sm);
    border-top: 1px solid var(--border);
    margin-top: var(--spacing-sm);
}

.equalizer-scale span {
    font-size: 0.7rem;
    color: var(--muted-foreground);
    opacity: 0.7;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .equalizer-container {
        padding: var(--spacing-md);
    }

    .equalizer-bands {
        gap: 2px;
        overflow-x: auto;
        padding-bottom: var(--spacing-sm);
        -webkit-overflow-scrolling: touch;
    }

    .eq-band {
        min-width: 36px;
    }

    .eq-slider {
        height: 100px;
    }

    .eq-slider::-webkit-slider-thumb {
        width: 16px;
        height: 16px;
        margin-left: -5px;
    }

    .eq-slider::-moz-range-thumb {
        width: 16px;
        height: 16px;
    }

    .eq-freq {
        font-size: 0.55rem;
    }

    .eq-value {
        font-size: 0.6rem;
        min-width: 24px;
    }
}

@media (max-width: 480px) {
    .equalizer-preset-row {
        flex-direction: column;
        align-items: stretch;
    }

    .equalizer-preset-row select {
        max-width: none;
    }

    .equalizer-preset-row label {
        margin-bottom: -0.5rem;
    }

    .eq-slider {
        height: 80px;
    }

    .eq-band {
        min-width: 30px;
    }
}

/* Track List Search */
.track-list-search-container {
    margin: 1rem 0;
}

.track-list-search-input {
    font-size: 0.95rem;
}

#custom-tooltip.visible {
    opacity: 1;
}

/* ==========================================================================
   PROFILE PAGE - Modern Glassmorphism 2.0
   ========================================================================== */

.profile-header-container {
    position: relative;
    margin-bottom: 3rem;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow: visible;
    padding-bottom: 2rem;
}

.profile-banner-wrapper {
    width: 100%;
    height: 320px;
    position: relative;
    overflow: hidden;
    border-radius: 0 0 var(--radius-2xl) var(--radius-2xl);
    mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
}

.profile-banner {
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, var(--secondary) 0%, var(--background) 100%);
    background-size: cover;
    background-position: center;
    transition: transform var(--duration-slow) var(--ease-out);
}

.profile-banner-overlay {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, transparent 0%, rgb(0, 0, 0, 0.4) 100%);
}

.profile-card {
    width: calc(100% - 4rem);
    max-width: 900px;
    margin-top: -80px;
    margin-left: auto;
    margin-right: auto;
    position: relative;
    z-index: 10;
    background: color-mix(in srgb, var(--card) 80%, transparent);
    backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid color-mix(in srgb, var(--border) 40%, transparent);
    border-radius: var(--radius-2xl);
    padding: 0 2.5rem 2.5rem;
    box-shadow:
        0 25px 50px -12px rgb(0, 0, 0, 0.5),
        inset 0 1px 1px rgb(255, 255, 255, 0.05);
    animation: profile-card-slide-up 0.8s var(--ease-out-back) both;
    overflow: visible;
}

@keyframes profile-card-slide-up {
    from {
        opacity: 0;
        transform: translateY(40px) scale(0.98);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.profile-card-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 1.5rem;
}

.profile-avatar-wrapper {
    position: relative;
    margin-top: -60px;
    margin-bottom: 1rem;
    z-index: 20;
}

.profile-avatar {
    width: 160px;
    height: 160px;
    border-radius: 50%;
    border: 4px solid var(--background);
    background-color: var(--secondary);
    object-fit: cover;
    box-shadow: var(--shadow-2xl);
    transition: transform var(--duration-normal) var(--ease-spring);
}

.profile-avatar:hover {
    transform: scale(1.05) rotate(2deg);
}

.profile-avatar-ring {
    position: absolute;
    inset: -8px;
    border-radius: 50%;
    border: 2px solid var(--primary);
    opacity: 0.2;
    animation: profile-pulse 4s infinite;
}

@keyframes profile-pulse {
    0% {
        transform: scale(1);
        opacity: 0.2;
    }

    50% {
        transform: scale(1.05);
        opacity: 0.1;
    }

    100% {
        transform: scale(1);
        opacity: 0.2;
    }
}

/* Virtual Presence Indicator */
.presence-indicator {
    position: absolute;
    bottom: 5px;
    right: 5px;
    background: #10b981;

    /* Presence Green */
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: 0.65rem;
    font-weight: 800;
    letter-spacing: 0.05em;
    box-shadow: 0 0 15px rgb(16, 185, 129, 0.4);
    z-index: 15;
    border: 2px solid var(--background);
    animation: presence-fade-in 0.3s ease;
}

@keyframes presence-fade-in {
    from {
        opacity: 0;
        transform: scale(0.8) translateY(5px);
    }

    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.presence-dot {
    width: 6px;
    height: 6px;
    background: white;
    border-radius: 50%;
    animation: presence-glow 1.5s infinite;
}

/* ==========================================================================
   LIBRARY PAGE REDESIGN
   Modern layout with improved visual hierarchy
   ========================================================================== */

#page-library {
    padding-top: 1rem;
}

#page-library .content-section:first-child {
    margin-bottom: 2.5rem;
}

.library-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding: 0 0.5rem;
}

.library-header h2 {
    font-size: var(--text-2xl);
    font-weight: 700;
    letter-spacing: -0.02em;
    background: linear-gradient(135deg, var(--foreground) 0%, var(--muted-foreground) 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.library-actions {
    display: flex;
    gap: 0.75rem;
}

.library-actions .btn-primary,
.library-actions .btn-secondary {
    padding: 0.625rem 1.25rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: var(--radius-lg);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    transition: all var(--duration-fast) var(--ease-out);
}

.library-actions .btn-secondary {
    background: var(--secondary);
    color: var(--foreground);
    border: 1px solid var(--border);
}

.library-actions .btn-secondary:hover {
    background: var(--accent);
    border-color: var(--accent);
    color: var(--accent-foreground);
}

/* Favorites Section Tabs */
#page-library .search-tabs {
    background: var(--secondary);
    padding: 0.375rem;
    border-radius: var(--radius-xl);
    display: inline-flex;
    gap: 0.25rem;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border);
}

#page-library .search-tab {
    padding: 0.625rem 1.25rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--muted-foreground);
    background: transparent;
    border: none;
    border-radius: var(--radius-lg);
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-out);
    white-space: nowrap;
}

#page-library .search-tab:hover {
    color: var(--foreground);
    background: var(--background);
}

#page-library .search-tab.active {
    color: var(--foreground);
    background: var(--background);
    box-shadow: 0 1px 3px rgb(0, 0, 0, 0.1);
}

/* Library Content Area */
#page-library .search-tab-content {
    animation: fade-in 0.3s ease;
}

@keyframes fade-in {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Section Titles */
#page-library .section-title {
    font-size: var(--text-xl);
    font-weight: 700;
    margin-bottom: 1rem;
    letter-spacing: -0.01em;
}

/* Empty States */
#page-library .empty-state {
    text-align: center;
    padding: 3rem 2rem;
    color: var(--muted-foreground);
}

#page-library .empty-state-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

@keyframes presence-glow {
    0% {
        box-shadow: 0 0 0 0 rgb(255, 255, 255, 0.8);
    }

    70% {
        box-shadow: 0 0 0 6px rgb(255, 255, 255, 0);
    }

    100% {
        box-shadow: 0 0 0 0 rgb(255, 255, 255, 0);
    }
}

.presence-text {
    line-height: 1;
}

/* Fix Placeholder clipping */
.placeholder-msg {
    color: var(--muted-foreground);
    text-align: center;
    width: 100% !important;
    min-width: 100% !important;
    padding: 4rem 2rem;
    font-size: 1.1rem;
    opacity: 0.6;
    grid-column: 1 / -1;

    /* Ensure it stays centered in a grid */
    flex: 1 0 100% !important;

    /* Force full width in flex containers (carousel mode) */
    display: flex;
    justify-content: center;
    align-items: center;
}

.profile-main-meta {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
}

.profile-display-name {
    font-size: clamp(2rem, 5vw, 3.5rem);
    font-weight: 800;
    letter-spacing: -0.02em;
    background: linear-gradient(to bottom, var(--foreground), color-mix(in srgb, var(--foreground) 70%, transparent));
    background-clip: text;
    -webkit-text-fill-color: transparent;
    margin: 0;
    line-height: 1;
}

.profile-username {
    font-size: clamp(1rem, 2vw, 1.25rem);
    color: var(--muted-foreground);
    font-weight: 500;
    opacity: 0.8;
}

.profile-status {
    background: color-mix(in srgb, var(--primary) 10%, transparent);
    color: var(--primary);
    padding: 0.4rem 1rem;
    border-radius: var(--radius-full);
    font-size: var(--text-sm);
    font-weight: 600;
    border: 1px solid color-mix(in srgb, var(--primary) 20%, transparent);
    margin-top: 0.5rem;
}

.profile-bio {
    max-width: 600px;
    line-height: 1.6;
    font-size: clamp(0.9rem, 1.5vw, 1.1rem);
    color: var(--secondary-foreground);
    opacity: 0.9;
}

.profile-meta-footer {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2rem;
    margin-top: 1rem;
    padding-top: 2rem;
    border-top: 1px solid color-mix(in srgb, var(--border) 20%, transparent);
}

.profile-links {
    display: flex;
    gap: 1.5rem;
    justify-content: center;
}

.profile-links:empty {
    display: none;
}

.profile-link {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    color: var(--muted-foreground);
    font-size: var(--text-sm);
    font-weight: 500;
    transition: color var(--duration-fast) var(--ease-out);
}

.profile-link:hover {
    color: var(--foreground);
}

.profile-link svg {
    opacity: 0.6;
}

/* Sections */
.profile-sections-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    max-width: 900px;
    margin: 0 auto;
    padding: 0 2rem 5rem;
    overflow-x: hidden;
}

.profile-section {
    width: 100%;
    margin-bottom: 5rem;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
}

.profile-section .card-grid {
    width: 100% !important;
}

.section-header-flex {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 3rem;
    text-align: center;
}

.lastfm-badge {
    background: #d51007;

    /* Last.fm Red */
    color: white;
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 0.7rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* Glass Button */
.btn-glass {
    background: color-mix(in srgb, var(--foreground) 5%, transparent);
    backdrop-filter: blur(6px);
    border: 1px solid color-mix(in srgb, var(--border) 40%, transparent);
    color: var(--foreground);
    padding: 0.6rem 1.2rem;
    border-radius: var(--radius-lg);
    font-size: var(--text-sm);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--duration-fast) var(--ease-out);
}

.btn-glass:hover {
    background: color-mix(in srgb, var(--foreground) 10%, transparent);
    border-color: color-mix(in srgb, var(--border) 60%, transparent);
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    #page-profile {
        overflow-x: hidden;
    }

    .profile-banner-wrapper {
        height: 200px;
    }

    .profile-card {
        width: calc(100% - 1rem);
        padding: 0 1.25rem 1.25rem;
        margin-top: -40px;
        border-radius: var(--radius-xl);
    }

    .profile-avatar-wrapper {
        margin-top: -50px;
    }

    .profile-avatar {
        width: 100px;
        height: 100px;
    }

    .profile-avatar-ring {
        inset: -6px;
    }

    .profile-display-name {
        font-size: 1.5rem;
    }

    .profile-username {
        font-size: 0.9rem;
    }

    .profile-bio {
        font-size: 0.9rem;
    }

    .profile-meta-footer {
        flex-direction: column;
        gap: 1rem;
        padding-top: 1rem;
        margin-top: 0.75rem;
    }

    .profile-links {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .profile-actions {
        width: 100%;
        display: flex;
        gap: 0.5rem;
    }

    .profile-actions .btn-glass {
        flex: 1;
        text-align: center;
        justify-content: center;
        padding: 0.75rem;
    }

    .profile-sections-container {
        padding: 0 1rem 4rem;
    }

    .profile-section {
        margin-bottom: 3rem;
    }

    .section-header-flex {
        margin-bottom: 1.5rem;
    }

    .profile-section .card-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 0.75rem !important;
    }

    .favorite-album-item {
        margin-bottom: 2rem !important;
    }

    .favorite-album-item .card {
        width: 160px !important;
    }
}

@media (max-width: 480px) {
    #page-profile {
        overflow-x: hidden;
    }

    .profile-banner-wrapper {
        height: 160px;
    }

    .profile-card {
        width: 100%;
        padding: 0 1rem 1rem;
        margin-top: -35px;
        border-radius: var(--radius-lg);
        border-left: none;
        border-right: none;
    }

    .profile-avatar-wrapper {
        margin-top: -40px;
    }

    .profile-avatar {
        width: 80px;
        height: 80px;
    }

    .profile-display-name {
        font-size: 1.25rem;
    }

    .profile-status {
        font-size: 0.75rem;
        padding: 0.3rem 0.75rem;
    }

    .profile-section .card-grid {
        grid-template-columns: repeat(2, 1fr) !important;
    }

    .favorite-album-item .card {
        width: 140px !important;
    }
}

.status-picker-container {
    position: relative;
}

.search-results-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    max-height: 200px;
    overflow-y: auto;
    z-index: 100;
    display: none;
    box-shadow: var(--shadow-lg);
}

.search-result-item {
    padding: 0.5rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    border-bottom: 1px solid var(--border);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background: var(--secondary);
}

.search-result-item img {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-sm);
    object-fit: cover;
}

.search-result-info {
    flex: 1;
    min-width: 0;
}

.search-result-title {
    font-size: 0.9rem;
    font-weight: 500;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.search-result-subtitle {
    font-size: 0.8rem;
    color: var(--muted-foreground);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* User Search Card */
.user-search-card {
    background: var(--card);
    padding: 1.5rem;
    border-radius: var(--radius-xl);
    text-align: center;
    transition: all var(--duration-normal) var(--ease-out);
    border: 1px solid color-mix(in srgb, var(--border) 20%, transparent);
}

.user-search-card:hover {
    transform: translateY(-8px);
    background: var(--secondary);
    border-color: var(--primary);
    box-shadow: var(--shadow-xl);
}

.user-search-avatar {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    margin-bottom: 1rem;
    object-fit: cover;
    border: 2px solid var(--border);
    transition: border-color var(--duration-normal) var(--ease-out);
}

.user-search-card:hover .user-search-avatar {
    border-color: var(--primary);
}

.user-search-name {
    font-weight: 700;
    font-size: 1rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.user-search-username {
    font-size: 0.85rem;
    color: var(--muted-foreground);
}

.dropdown-menu {
    display: none;
    position: absolute;
    top: 100%;
    left: 0;
    background: color-mix(in srgb, var(--card) 85%, transparent);
    backdrop-filter: blur(10px);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 0.5rem;
    z-index: 2000;
    min-width: 200px;
    margin-top: 0.5rem;
    box-shadow: var(--shadow-lg);
    flex-direction: column;
    gap: 0.25rem;
}

.dropdown-menu.active {
    display: flex;
    animation: scale-in 0.1s ease-out;
}

.dropdown-menu button {
    width: 100%;
    text-align: left;
    justify-content: flex-start;
}

.sidebar-account-dropdown {
    top: auto;
    left: 0;
    right: 0;
    bottom: calc(100% + 0.5rem);
    min-width: 0;
    padding: 0.35rem;
    gap: 0.35rem;
}

.sidebar-account-dropdown .account-dropdown-section {
    display: flex;
    flex-direction: column;
    gap: 0.35rem;
    padding: 0.2rem;
}

.sidebar-account-dropdown .account-dropdown-section+.account-dropdown-section {
    border-top: 1px solid color-mix(in srgb, var(--border) 86%, transparent);
    padding-top: 0.5rem;
}

.sidebar-account-dropdown .btn-secondary,
.sidebar-account-dropdown .btn-primary {
    width: 100%;
    justify-content: flex-start;
    min-height: 2.25rem;
    border-radius: 0.62rem;
    text-align: left;
    line-height: 1.3;
    white-space: normal;
    padding-left: 0.75rem;
    padding-right: 0.75rem;
}